{"version":3,"sources":["interfaces/enum.ts","store/hooks.ts","store/features/file/fileSlice.ts","store/features/proof/auxi.ts","store/features/theme/auxi.ts","store/features/proof/proofSlice.ts","store/features/theme/themeSlice.ts","store/features/externalCmd/externalCmd.ts","examples/proofs-examples.ts","components/VisualizerNavbar/VisualizerNavbar.tsx","components/VisualizerDialog/VisualizerDialog.tsx","components/VisualizerStage/Canvas/VisualizerNode.tsx","components/VisualizerStage/Canvas/VisualizerLine.tsx","components/VisualizerStage/Canvas/VisualizerMenu.tsx","components/VisualizerStage/Canvas/VisualizerCanvas.tsx","components/VisualizerTree/VisualizerTree.tsx","components/VisualizerStage/VisualizerDirectoryStyle/VisualizerDirectoryStyle.tsx","components/VisualizerLetDrawer/let.ts","components/VisualizerLetDrawer/LetRender.tsx","components/VisualizerStage/VisualizerStage.tsx","components/VisualizerLetDrawer/VisualizerLetDrawer.tsx","components/VisualizerTheoryLemma/VisualizerTheoryLemma.tsx","components/VisualizersDrawer/VisualizersDrawer.tsx","components/VisualizerTutorial/TutorialPopover.tsx","components/VisualizerTutorial/VisualizerTutorial.tsx","components/App/App.tsx","store/store.ts","ReactUtils/reportWebVitals.ts","index.tsx"],"names":["drawerHelpersKind","renderLetKind","ClusterKind","useAppDispatch","useDispatch","useAppSelector","useSelector","fileSlice","createSlice","name","initialState","value","filesCount","reducers","set","state","action","payload","actions","selectFileName","file","selectDot","split","pop","JSON","parse","dot","selectFileCount","removeEscapedCharacters","s","newS","i","length","descendants","proof","nodeId","children","concat","reduce","acc","childId","sliceNodesCluster","clusterMap","slicedClusters","currentNode","id","parentsClusters","parents","p","clusterType","keys","Object","target","Number","push","clusterID","forEach","c","child","extractTheoryLemmas","clusters","haveCluster","conclusion","filter","type","TL","map","hiddenNodes","n","rule","colorConverter","colorName","color","proofSlice","view","style","letMap","theoryLemmaMap","visualInfo","clustersInfos","process","proofJSON","isJSON","indexOf","nodes","args","NaN","dependencies","NONE","comment","slice","lastIndexOf","replace","line","search","label","idx","thisType","numbers","substring","str","num","SAT","CNF","PP","IN","parseInt","trim","attributes","commentJSON","subProofQty","x","parent","isNaN","processDot","clustersColors","clustersMap","Array","fill","cluster","node","y","selected","size","hideNodes","toHideNodes","every","hiddenNodesArray","clusteredNodes","hiddenNode","hiddenID","some","_p","pastCluster","stringify","clusterParents","parentCluster","splice","findNodesClusters","piNodeId","foldAllDescendants","index","self","unhideNodes","pi","hiddens","setVisualInfo","selectNodes","len","unselectNodes","changeStyle","applyView","visualInfoSize","proofSize","applyColor","selectProof","piNodeChildren","haveHiddenParent","piNodeParents","piNodeDependencies","depMap","dep","String","piId","depsId","groupPiNodeDependencies","piNode","proofNode","parentId","highHierarchyNodes","ac","childID","selectOriginalProof","selectView","selectStyle","selectLetMap","selectTheoryLemmas","selectVisualInfo","selectHiddenNodes","selectNodeClusters","themeSlice","toggle","selectTheme","theme","externalCmd","findData","nodeToFind","findOption","renderData","count","fileChanged","findNode","option","reRender","addRenderCount","blockRender","allowRenderNewFile","blockRenderNewFile","selectFindData","selectRenderData","examples","ex1","smt","ex2","mapDispatchToProps","connect","ownProps","setDialogIsOpen","setDrawerIsOpen","addErrorToast","setInTutorial","inTutorial","fileName","darkTheme","windowSize","useState","width","height","setWindowSize","useEffect","handleResize","window","innerWidth","innerHeight","addEventListener","removeEventListener","useWindowSize","command","setCommand","lastCommands","setLastCommands","commandId","setCommandId","matchableCmd","setMatchableCmd","matchableCmdIsOpen","setMatchableCmdIsOpen","dispatch","commandsMap","cmds","cmdArg","string","matches","matchAll","idList","insideBracket","insideMatches","rangeLim","numS","from","_","listStr","match","word","argMatch","argIsConclusion","regexString","regex","RegExp","test","err","allNodesIds","hiddenIds","findIndex","obj","find","commands","useRef","current","runCommands","menus","icon","text","onClick","e","preventDefault","download","downloadJSON","fName","link","document","createElement","href","encodeURIComponent","click","replaceAll","getElementsByClassName","toDataURL","help","className","ex","criticalWidth","Group","align","Alignment","LEFT","Heading","Divider","content","undefined","placement","RIGHT","autoFocus","enforceFocus","list","cmd","renderMatchableCmd","isOpen","disabled","placeholder","onChange","findMatchableCmd","onKeyDown","key","unshift","newId","rightElement","autoComplete","marginLeft","stopPropagation","currentTarget","blur","checked","readUploadedFileAsText","inputFile","temporaryFileReader","FileReader","Promise","resolve","reject","onerror","abort","DOMException","onload","result","readAsText","VisualizerDialog","dialogIsOpen","changeFileName","changeFile","useReducer","newFlag","focusFlag","flagCount","setFocusFlag","Classes","DIALOG_BODY","childNodes","focus","DIALOG_FOOTER_ACTIONS","closeDialog","dialogBody","hasSelection","onInputChange","a","files","File","fileContents","message","succesButton","ext","intent","Intent","SUCCESS","onClose","usePortal","title","DIALOG_FOOTER","textColorFromBg","bgColor","sixDigitColor","charAt","join","Node","props","nHided","nDescendants","setNodeOnFocus","toggleNodeSelection","updateNodePosition","openDrawer","onDragEnd","createTree","tag","stroke","strokeWidth","this","fontSize","padding","depSize","infos","idSize","setIdSize","descendantSize","setDescendantSize","font","calc","context","getContext","measureText","getTextWidth","toString","draggable","onDragMove","attrs","evt","button","shiftKey","menuNode","getElementById","top","clientY","left","clientX","display","points","depLineSize","radius","depText","Line","Menu","unfold","foldSelectedNodes","changeNodeColor","currentColor","options","setColor","foldSelected","vertical","handleWheel","stage","getStage","oldScale","scaleX","pointerPosition","getPointerPosition","mousePointTo","newScale","deltaY","stageScale","stageX","stageY","Canvas","nodeOnFocus","setState","nodesSelected","showingNodes","LineProps","to","saveNodePosition","copyNodePosition","showingEdges","edgeKey","edge","componentDidUpdate","bind","canvasSize","newShowingNodes","newNodeProps","updateEdgesAndFuncs","prevProps","found","o","Boolean","includes","onWheel","scaleY","onContextMenu","current_state","proofChanged","visualInfoChanged","nodeFindData","nodeWidth","nodeHeight","g","dagre","graphlib","Graph","setGraph","rankdir","ranker","setDefaultEdgeLabel","setNode","setEdge","layout","xOffset","yOffset","v","console","log","Component","newVisualInfo","visualInfos","VisualizerTree","positionMap","setNodeInfo","forceUpdate","setNodes","setSelected","forEachNode","callback","backgroundColor","contents","onNodeClick","nodeData","_nodePath","toBeShow","originallySelected","isSelected","onNodeCollapse","isExpanded","onNodeExpand","hasCaret","castProofNodeToTreeNode","ELEVATION_0","VisualizerDirectoryStyle","proofTree","ruleHelper","indent","translate","nodeInfo","ALL","ruleHelperIsOpen","argsHelperIsOpen","concHelperIsOpen","dispatchHelper","setMap","_map","offsetHeight","float","clear","borderRight","overflow","RULE","maxHeight","ARGS","CONC","dependency","Let","letText","letsList","indices","lines","biggerID","externalLets","expandValue","shouldUpdate","keyList","let","letName","k","indentLevel","expandPartialy","externalRef","letIdx","indentedText","printLines","lastLine","newIdx","shrinkValue","fitsTheWindow","repeat","mode","someDoesntFit","newLines","thisLevel","thisLine","lastSpace","lastUsedSpace","lastOpenParenthesis","biggestSize","newBiggerID","thisSize","groupUp","original","numKey","LetRender","toRender","shouldExpand","shouldRevert","dispatchExpansion","widthRef","resizeMode","setResizeMode","newMap","letMapS","setLetMapS","letsRef","initializeLet","lets","currentLet","indice","newWidth","clientWidth","expandAll","EXPAND","revertLet","REVERT","margin","whiteSpace","arr","start","thisLet","expandLet","overflowWrap","renderLet","secondaryLabel","parentsId","rootNode","tree","VisualizerStage","fileID","setProofTree","revertAll","dispatchLetExpansion","drawerIsOpen","setTree","canEscapeKeyClose","canOutsideClickClose","hasBackdrop","position","Position","BOTTOM","DRAWER_BODY","VisualizerLetDrawer","shouldResize","setLetMap","VisualizerTheoryLemma","theoryLemmas","setTheoryLemmas","tl","currentTL","minWidth","VisualizersDrawer","nodeClusters","tabID","setTabID","resizeFlag","setResizeFlag","handleClusterClick","theoryLemma","newTabId","newResizeFlag","selectedTabId","panel","TutorialPopover","setIsOpen","nextTutorial","W","page","setPage","changePage","handleEsc","tW","borderBottomColor","divsIds","tutorials","VisualizerTutorial","setStage","setPosition","sizeRef","w","h","toBeWrapped","getClientRects","newY","newX","newTW","pointerEvents","App","toaster","setDrawerOpenState","refHandlers","ref","show","DANGER","TOP","store","configureStore","reducer","fileReducer","proofReducer","themeReducer","externalCmdReducer","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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AaC,GAC3DgC,EAAW,eAAKD,IAoFIkB,CAAUlS,EAAKiS,EAAS1f,IAHhC,SAMK0f,KAITD,EAAQzf,EAAM0f,EAAQ1jB,OAGlBD,IAAM+G,EAAK9G,OAAS,GACpBwjB,EAAIliB,KAAKwhB,EAAW3e,UAAUsf,EAAOX,EAAW9iB,YAKpDmB,OAAOD,KAAK2e,GAAS7f,OAEjB,uBAAMiQ,UAAU,eAAetN,MAAO,CAAEihB,aAAc,cAAtD,SACKJ,IAKL,uBAAMvT,UAAU,eAAetN,MAAO,CAAEihB,aAAc,cAAtD,SACKd,IAKjB,OAAO,+BAQFe,MCxMb,SAASxF,GAAWhc,GAChB,OAAQA,EAAK/C,MAAM,KAAK,IACpB,IAAK,SACD,MAAO,8DACX,IAAK,SACD,OACI+C,EACA,uYAER,IAAK,QACD,OACIA,EACA,gnBAER,IAAK,OACD,OACIA,EACA,sZAER,IAAK,UACD,OACIA,EACA,0PAER,IAAK,WACD,OACIA,EACA,6MAER,IAAK,oBACD,OACIA,EACA,moBAER,IAAK,sBACD,OACIA,EACA,6iCAER,IAAK,qBACD,OACIA,EACA,gcAER,IAAK,0BACD,OACIA,EACA,qsBAER,IAAK,4BACD,OACIA,EACA,4LAER,IAAK,eACD,OACIA,EACA,wVAER,IAAK,iBACD,OACIA,EACA,6mBAER,IAAK,aACD,OACIA,EACA,qRAER,IAAK,mBACD,OACIA,EACA,uKAER,IAAK,oBACD,OACIA,EACA,oNAER,IAAK,0BACD,OACIA,EACA,oKAER,IAAK,oBACD,OACIA,EACA,+MAER,IAAK,gBACD,OACIA,EACA,oNAER,IAAK,gBACD,OACIA,EACA,gOAER,IAAK,aACD,OACIA,EACA,mOAER,IAAK,iBACD,OACIA,EACA,0VAER,IAAK,gBACD,OACIA,EACA,uNAER,IAAK,iBACD,OACIA,EACA,kOAER,IAAK,aACD,OACIA,EACA,kpCAER,IAAK,mBACD,OACIA,EACA,ueAER,IAAK,YACD,OACIA,EACA,iNAER,IAAK,aACD,OACIA,EACA,oNAER,IAAK,mBACD,OACIA,EACA,4oBAER,IAAK,yBACD,OAC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","file":"static/js/main.abd9845e.chunk.js","sourcesContent":["export enum drawerHelpersKind {\r\n    RULE,\r\n    ARGS,\r\n    CONC,\r\n    ALL,\r\n}\r\n\r\nexport enum renderLetKind {\r\n    EXPAND,\r\n    REVERT,\r\n}\r\n\r\nexport enum ClusterKind {\r\n    NONE,\r\n    SAT,\r\n    CNF,\r\n    TL,\r\n    PP,\r\n    IN,\r\n}\r\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\r\nimport type { RootState, AppDispatch } from './store';\r\n\r\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { RootState } from '../../store';\r\nimport { FileState } from '../../../interfaces/interfaces';\r\n\r\nconst initialState: FileState = {\r\n    name: 'ex.smt2',\r\n    value: 'digraph proof {\\n\\trankdir=\"BT\";\\n\\tnode [shape=record];\\n\\t0 [label=\"{SCOPE((not a), a)|(not (and (not a) a))}\", class = \" basic \", comment = \"{\\'subProofQty\\':1}\" ];\\n\\t1 [label=\"{CHAIN_RESOLUTION(true, a)|false}\", class = \" propositional \", comment = \"{\\'subProofQty\\':2}\" ];\\n\\t2 [label=\"{ASSUME(a)|a}\", comment = \"{\\'subProofQty\\':0}\"];\\n\\t3 [label=\"{ASSUME((not a))|(not a)}\", comment = \"{\\'subProofQty\\':0}\"];\\n\\t1->0;\\n\\t2->1;\\n\\t3->1;\\n}',\r\n    filesCount: 0,\r\n};\r\n\r\nexport const fileSlice = createSlice({\r\n    name: 'file',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        set: (state, action: PayloadAction<{ name: string; value: string }>) => {\r\n            state.name = action.payload.name;\r\n            if (state.value !== action.payload.value) {\r\n                state.value = action.payload.value;\r\n                state.filesCount++;\r\n            }\r\n        },\r\n    },\r\n});\r\n\r\nexport const { set } = fileSlice.actions;\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice file. For example: `useSelector((state: RootState) => state.counter.value)`\r\nexport const selectFileName = (state: RootState): string => state.file.name;\r\n\r\nexport const selectFileExtension = (state: RootState): string => {\r\n    const ext = state.file.name.split('.').pop();\r\n    return ext ? ext : '';\r\n};\r\n\r\nexport const selectDot = (state: RootState): string =>\r\n    state.file.name.split('.').pop() === 'json' ? JSON.parse(state.file.value).dot : state.file.value;\r\n\r\nexport const selectFile = (state: RootState): string => state.file.value;\r\n\r\nexport const selectFileCount = (state: RootState): number => state.file.filesCount;\r\n\r\nexport default fileSlice.reducer;\r\n","import { ClusterKind } from '../../../interfaces/enum';\r\nimport { NodeInterface, ProofState } from '../../../interfaces/interfaces';\r\n\r\ninterface ClusterColorMap {\r\n    [type: number]: string;\r\n}\r\n\r\nfunction removeEscapedCharacters(s: string): string {\r\n    let newS = '';\r\n    for (let i = 0; i < s.length; i += 1) {\r\n        if (\r\n            !(\r\n                s[i] === '\\\\' &&\r\n                (s[i + 1] === '\"' ||\r\n                    s[i + 1] === '>' ||\r\n                    s[i + 1] === '<' ||\r\n                    s[i + 1] === '{' ||\r\n                    s[i + 1] === '}' ||\r\n                    s[i + 1] === '|')\r\n            )\r\n        ) {\r\n            newS += s[i];\r\n        }\r\n    }\r\n\r\n    return newS;\r\n}\r\n\r\nexport function processDot(dot: string): [NodeInterface[], ProofState['letMap'], ClusterColorMap] {\r\n    const nodes: NodeInterface[] = [\r\n        {\r\n            id: 0,\r\n            conclusion: '',\r\n            rule: '',\r\n            args: '',\r\n            children: [],\r\n            parents: [NaN],\r\n            descendants: 0,\r\n            dependencies: [],\r\n            clusterType: ClusterKind.NONE,\r\n        },\r\n    ];\r\n    let comment: string | null = dot.slice(dot.indexOf('comment='));\r\n    comment = comment\r\n        ? removeEscapedCharacters(\r\n              removeEscapedCharacters(comment.slice(comment.indexOf('=') + 2, comment.indexOf(';') - 1)),\r\n          )\r\n        : null;\r\n\r\n    const clustersInfos: ClusterColorMap = {};\r\n    const lines = dot\r\n        .slice(dot.indexOf('{') + 1, dot.lastIndexOf('}') - 2)\r\n        .replace(/(\\n|\\t)/gm, '')\r\n        .split(';');\r\n    lines.forEach((line) => {\r\n        if (line.search('subgraph') !== -1) {\r\n            // Get the label of this node subgraph\r\n            let label = '';\r\n            let idx = line.indexOf('label=\"') + 7;\r\n            while (line[idx] !== '\"') {\r\n                label += line[idx];\r\n                idx++;\r\n            }\r\n\r\n            // Get the label of this node subgraph\r\n            let color = '';\r\n            idx = line.indexOf('bgcolor=\"') + 9;\r\n            while (line[idx] !== '\"') {\r\n                color += line[idx];\r\n                idx++;\r\n            }\r\n\r\n            // Get the nodes ID's\r\n            const numbers = line\r\n                .substring(idx + 1, line.length - 1)\r\n                .split(/\\s/)\r\n                .filter((str) => str.length)\r\n                .map((num) => Number(num));\r\n\r\n            let thisType: ClusterKind;\r\n            switch (label) {\r\n                case 'SAT':\r\n                    thisType = ClusterKind.SAT;\r\n                    break;\r\n                case 'CNF':\r\n                    thisType = ClusterKind.CNF;\r\n                    break;\r\n                case 'TL':\r\n                    thisType = ClusterKind.TL;\r\n                    break;\r\n                case 'PP':\r\n                    thisType = ClusterKind.PP;\r\n                    break;\r\n                case 'IN':\r\n                    thisType = ClusterKind.IN;\r\n                    break;\r\n                default:\r\n                    thisType = ClusterKind.NONE;\r\n            }\r\n\r\n            // Assign the type for each node\r\n            numbers.forEach((num) => {\r\n                nodes[num].clusterType = thisType;\r\n            });\r\n            clustersInfos[thisType] = color;\r\n        } else if (line.search('label') !== -1) {\r\n            const id = parseInt(line.slice(0, line.indexOf('[')).trim());\r\n            const attributes = line.slice(line.indexOf('[') + 1, line.lastIndexOf(']')).trim();\r\n\r\n            let label = attributes.slice(attributes.search(/(?<!\\\\)\"/) + 2);\r\n            label = label.slice(0, label.search(/(?<!\\\\)\"/) - 1);\r\n            let [conclusion, rule, args] = ['', '', ''];\r\n            [conclusion, rule] = label.split(/(?<!\\\\)\\|/);\r\n            [rule, args] = rule.indexOf(' :args ') != -1 ? rule.split(' :args ') : [rule, ''];\r\n\r\n            const comment: string = removeEscapedCharacters(line.slice(line.indexOf('comment'), line.lastIndexOf('\"')));\r\n            const commentJSON = JSON.parse(comment.slice(comment.indexOf('\"') + 1).replace(/'/g, '\"'));\r\n\r\n            if (!nodes[id]) {\r\n                nodes[id] = {\r\n                    id: id,\r\n                    conclusion: '',\r\n                    rule: '',\r\n                    args: '',\r\n                    children: [],\r\n                    parents: [NaN],\r\n                    descendants: 0,\r\n                    dependencies: [],\r\n                    clusterType: ClusterKind.NONE,\r\n                };\r\n            }\r\n            nodes[id].conclusion = removeEscapedCharacters(conclusion);\r\n            nodes[id].rule = removeEscapedCharacters(rule);\r\n            nodes[id].args = removeEscapedCharacters(args);\r\n            nodes[id].descendants = commentJSON.subProofQty;\r\n        } else if (line.search('->') !== -1) {\r\n            const [child, parent] = line.split('->').map((x) => parseInt(x.trim()));\r\n            nodes[parent].children.push(child);\r\n            // If there isn't a child node\r\n            if (!nodes[child]) {\r\n                nodes[child] = {\r\n                    id: child,\r\n                    conclusion: '',\r\n                    rule: '',\r\n                    args: '',\r\n                    children: [],\r\n                    parents: [],\r\n                    descendants: 0,\r\n                    dependencies: [],\r\n                    clusterType: ClusterKind.NONE,\r\n                };\r\n            }\r\n            // If there is and is an invalid parent\r\n            else if (isNaN(nodes[child].parents[0])) {\r\n                nodes[child].parents = [];\r\n            }\r\n            nodes[child].parents.push(parent);\r\n        }\r\n    });\r\n\r\n    return comment ? [nodes, JSON.parse(comment)['letMap'], clustersInfos] : [nodes, {}, clustersInfos];\r\n}\r\n\r\nexport const piNodeParents = (\r\n    proof: NodeInterface[],\r\n    hiddenNodesArray: number[],\r\n    dependencies: { [parentId: number]: number[] } = {},\r\n): number[] => {\r\n    const parents = hiddenNodesArray\r\n        // Concat all the parents\r\n        .reduce((acc: number[], hiddenNode) => {\r\n            let haveHiddenParent = false;\r\n\r\n            proof[hiddenNode].parents.forEach((parent) => {\r\n                // If this parent is a hidden node\r\n                if (hiddenNodesArray.indexOf(parent) !== -1) {\r\n                    haveHiddenParent = true;\r\n                } else {\r\n                    dependencies[parent]\r\n                        ? dependencies[parent].push(hiddenNode)\r\n                        : (dependencies[parent] = [hiddenNode]);\r\n                }\r\n            });\r\n\r\n            if (haveHiddenParent) return acc;\r\n            return acc.concat(proof[hiddenNode].parents);\r\n        }, [])\r\n        // Filter the duplicated elements\r\n        .filter((parent, i, self) => self.indexOf(parent) === i)\r\n        // Only the parents that aren't in he hidden nodes array remains\r\n        .filter((parent) => hiddenNodesArray.indexOf(parent) === -1);\r\n\r\n    // Removes the pi node parents from the dependencies\r\n    Object.keys(dependencies).forEach((parent) => {\r\n        const n = Number(parent);\r\n        if (parents.indexOf(n) !== -1) delete dependencies[n];\r\n    });\r\n\r\n    return parents;\r\n};\r\n\r\nexport const descendants = (proof: NodeInterface[], nodeId: number): number[] => {\r\n    return proof[nodeId].children.concat(\r\n        proof[nodeId].children.reduce((acc: number[], childId) => acc.concat(descendants(proof, childId)), []),\r\n    );\r\n};\r\n\r\nexport const piNodeChildren = (proof: NodeInterface[], hiddenNodesArray: number[]): number[] => {\r\n    const children = hiddenNodesArray\r\n        // Get all the childrens\r\n        .reduce((acc: number[], hiddenNode) => acc.concat(proof[hiddenNode].children), [])\r\n        // Exclude the childrens that are part of the hidden nodes\r\n        .filter((child) => hiddenNodesArray.indexOf(child) === -1);\r\n    return children;\r\n};\r\n\r\nexport const findNodesClusters = (proof: NodeInterface[], hiddenNodesArray: number[]): number[][] => {\r\n    const hiddenNodes = [...hiddenNodesArray];\r\n    const clusters: number[][] = [];\r\n    let clusteredNodes = 0;\r\n    const parents = hiddenNodes.map((hiddenNode) => proof[hiddenNode].parents);\r\n\r\n    // Cluster the nodes based on similiar parents\r\n    parents.forEach((parent, clusterID) => {\r\n        // If not all of the nodes where clustered and is a non empty cluster\r\n        if (clusteredNodes !== parents.length && parents[clusterID].length) {\r\n            clusters.push([]);\r\n            parents.forEach((p, hiddenID) => {\r\n                // If those nodes have some parent in commom and they weren't verified yet\r\n                if (parents[hiddenID].length && parent.some((_p) => p.indexOf(_p) !== -1)) {\r\n                    clusters[clusters.length - 1].push(hiddenNodes[hiddenID]);\r\n                    // Removes these parents from the array, making shure they will not get verified again (already clustered)\r\n                    parents[hiddenID] = [];\r\n                    // Increases the number o clustered nodes\r\n                    clusteredNodes++;\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    let pastCluster: number[][] = [];\r\n    // Cluster the nodes until there aren't changes being made\r\n    while (JSON.stringify(pastCluster) != JSON.stringify(clusters)) {\r\n        pastCluster = [...clusters];\r\n        clusters.forEach((cluster, clusterID) => {\r\n            const clusterParents = proof[cluster[0]].parents;\r\n\r\n            // For each cluster\r\n            clusters.forEach((parentCluster, id) => {\r\n                // If this parentCluster (cluster) is parent of the current cluster\r\n                if (parentCluster.some((hiddenID) => clusterParents.indexOf(hiddenID) !== -1)) {\r\n                    // Group the nodes couple in one single cluster (the parent cluster)\r\n                    clusters[id] = clusters[id].concat(clusters[clusterID]);\r\n                    clusters.splice(clusterID, 1);\r\n                    clusterID--;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    // Filter the nodes with length 1\r\n    return clusters.filter((cluster) => cluster.length > 1);\r\n};\r\n\r\nexport const groupPiNodeDependencies = (\r\n    proof: NodeInterface[],\r\n    hiddenNodesArray: number[],\r\n): NodeInterface['dependencies'] => {\r\n    const piNodeDependencies: NodeInterface['dependencies'] = [];\r\n    const depMap: { [piID: number]: number } = {};\r\n\r\n    // Copy all the hidden nodes dependencies to the new pi node\r\n    proof.forEach((node) => {\r\n        // Search for all the hidden nodes that have deps\r\n        if (hiddenNodesArray.indexOf(node.id) !== -1 && node.dependencies.length) {\r\n            // For each dependence in this node\r\n            node.dependencies.forEach((dep) => {\r\n                // This pi node dependence wasn't inserted yet\r\n                if (Object.keys(depMap).indexOf(String(dep.piId)) === -1) {\r\n                    piNodeDependencies.push(dep);\r\n                    depMap[dep.piId] = piNodeDependencies.length - 1;\r\n                }\r\n                // Concat the nodes inside the pi node already inserted\r\n                else {\r\n                    piNodeDependencies[depMap[dep.piId]].depsId = piNodeDependencies[depMap[dep.piId]].depsId.concat(\r\n                        dep.depsId,\r\n                    );\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return piNodeDependencies;\r\n};\r\n\r\nexport const sliceNodesCluster = (\r\n    proof: NodeInterface[],\r\n    clusterMap: number[],\r\n    nodeId = 0,\r\n    slicedClusters: number[][] = [],\r\n): number[][] => {\r\n    const currentNode = proof[nodeId];\r\n\r\n    // If the node id is valid and wasn't inserted yet\r\n    if (nodeId && clusterMap[currentNode.id] === -1) {\r\n        // Get all parents with the same type\r\n        const parentsClusters: { [parentID: number]: number } = {};\r\n        for (let i = 0; i < currentNode.parents.length; i++) {\r\n            const p = currentNode.parents[i];\r\n            if (proof[p].clusterType === currentNode.clusterType) {\r\n                parentsClusters[p] = clusterMap[p];\r\n                break;\r\n            }\r\n        }\r\n\r\n        const keys = Object.keys(parentsClusters);\r\n\r\n        // If the current node has the same type as (at least) one of it's parents\r\n        if (keys.length) {\r\n            // Put the current node in the cluster of the first parent with the same type\r\n            const target = parentsClusters[Number(keys[0])];\r\n            slicedClusters[target].push(currentNode.id);\r\n            clusterMap[currentNode.id] = target;\r\n        }\r\n        // Parent with different type\r\n        else {\r\n            const clusterID = slicedClusters.length;\r\n            clusterMap[currentNode.id] = clusterID;\r\n            slicedClusters.push([currentNode.id]);\r\n\r\n            // Add the brothers with the same type in the same cluster\r\n            proof[currentNode.parents[0]].children.forEach((c) => {\r\n                // If the brother node has the same type as the current one\r\n                if (proof[c].clusterType === currentNode.clusterType && c !== currentNode.id) {\r\n                    slicedClusters[clusterID].push(c);\r\n                    clusterMap[c] = clusterID;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    currentNode.children.forEach((child) => {\r\n        sliceNodesCluster(proof, clusterMap, child, slicedClusters);\r\n    });\r\n    return slicedClusters;\r\n};\r\n\r\nexport const extractTheoryLemmas = (\r\n    proof: NodeInterface[],\r\n    clusters: ProofState['clustersInfos'],\r\n    haveCluster: boolean,\r\n): ProofState['theoryLemmaMap'] => {\r\n    // If have clusters registered\r\n    if (haveCluster) {\r\n        return [proof[0].conclusion].concat(\r\n            clusters.filter((c) => c.type === ClusterKind.TL).map((c) => proof[c.hiddenNodes[0]].conclusion),\r\n        );\r\n    } else {\r\n        return proof.filter((n) => n.rule === 'SCOPE').map((n) => n.conclusion);\r\n    }\r\n};\r\n","export const colorConverter = (colorName: string): string => {\r\n    let color = '#fff';\r\n    switch (colorName) {\r\n        case 'red':\r\n            color = '#f72b34';\r\n            break;\r\n        case 'orange':\r\n            color = '#ff8334';\r\n            break;\r\n        case 'yellow':\r\n            color = '#ffc149';\r\n            break;\r\n        case 'green':\r\n            color = '#60aa51';\r\n            break;\r\n        case 'blue':\r\n            color = '#0097e4';\r\n            break;\r\n        case 'purple':\r\n            color = '#a73da5';\r\n            break;\r\n        case 'brown':\r\n            color = '#a95a49';\r\n            break;\r\n        case 'black':\r\n            color = '#464646';\r\n            break;\r\n\r\n        case 'white':\r\n            color = '#f0f0f0';\r\n            break;\r\n    }\r\n    return color;\r\n};\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { RootState } from '../../store';\r\nimport {\r\n    processDot,\r\n    piNodeChildren,\r\n    piNodeParents,\r\n    descendants,\r\n    findNodesClusters,\r\n    groupPiNodeDependencies,\r\n    sliceNodesCluster,\r\n    extractTheoryLemmas,\r\n} from './auxi';\r\nimport { NodeInterface, ProofState } from '../../../interfaces/interfaces';\r\nimport { colorConverter } from '../theme/auxi';\r\nimport { ClusterKind } from '../../../interfaces/enum';\r\n\r\nconst initialState: ProofState = {\r\n    proof: [],\r\n    view: 'full',\r\n    style: 'graph',\r\n    hiddenNodes: [],\r\n    letMap: {},\r\n    theoryLemmaMap: [],\r\n    visualInfo: [],\r\n    clustersInfos: [],\r\n};\r\n\r\nexport const proofSlice = createSlice({\r\n    name: 'proof',\r\n    initialState,\r\n\r\n    reducers: {\r\n        process: (state, action: PayloadAction<string>) => {\r\n            // Reset the state\r\n            state.clustersInfos = [];\r\n\r\n            let proofJSON;\r\n            let dot = action.payload;\r\n            let isJSON = false;\r\n\r\n            // If the payload is a .json file\r\n            if (dot.indexOf('{\"dot\":\"') !== -1) {\r\n                proofJSON = JSON.parse(dot);\r\n                dot = proofJSON.dot;\r\n                isJSON = true;\r\n            }\r\n\r\n            const [proof, letMap, clustersColors] = processDot(dot);\r\n            state.proof = proof;\r\n            state.letMap = letMap;\r\n            state.view = 'full';\r\n\r\n            // If there are clusters\r\n            let clusters: number[][] = [];\r\n            if (Object.keys(clustersColors).length) {\r\n                state.view = 'clustered';\r\n\r\n                // Slice the clusters\r\n                const clustersMap: number[] = Array(state.proof.length).fill(-1);\r\n                clusters = sliceNodesCluster(state.proof, clustersMap);\r\n\r\n                // Maps the cluster infos\r\n                clusters.forEach((cluster) => {\r\n                    const type = state.proof[cluster[0]].clusterType;\r\n                    state.clustersInfos.push({\r\n                        hiddenNodes: cluster,\r\n                        type: type,\r\n                        color: colorConverter(clustersColors[type]),\r\n                    });\r\n                });\r\n\r\n                // Extract the theory lemmas\r\n                state.theoryLemmaMap = extractTheoryLemmas(state.proof, state.clustersInfos, true);\r\n            } else {\r\n                state.theoryLemmaMap = extractTheoryLemmas(state.proof, state.clustersInfos, false);\r\n            }\r\n\r\n            if (isJSON) {\r\n                state.view = proofJSON.view;\r\n                state.hiddenNodes = proofJSON.hiddenNodes;\r\n                state.visualInfo = proofJSON.visualInfo;\r\n            }\r\n            // Is .dot\r\n            else {\r\n                state.hiddenNodes = clusters.filter((c) => c.length > 1);\r\n\r\n                // Init the visual info\r\n                const visualInfo: ProofState['visualInfo'] = {};\r\n                state.proof.forEach((node) => {\r\n                    visualInfo[node.id] = {\r\n                        color: '#fff',\r\n                        x: 0,\r\n                        y: 0,\r\n                        selected: false,\r\n                    };\r\n                });\r\n\r\n                let size = state.proof.length;\r\n                state.clustersInfos.forEach((cluster) => {\r\n                    visualInfo[cluster.hiddenNodes.length !== 1 ? size++ : cluster.hiddenNodes[0]] = {\r\n                        color: cluster.color,\r\n                        x: 0,\r\n                        y: 0,\r\n                        selected: false,\r\n                    };\r\n                });\r\n\r\n                state.visualInfo = visualInfo;\r\n            }\r\n        },\r\n        hideNodes: (state, action: PayloadAction<number[]>) => {\r\n            const toHideNodes = action.payload.filter(\r\n                (id) =>\r\n                    id > 0 &&\r\n                    id < state.proof.length &&\r\n                    state.hiddenNodes.every((hiddenNodesArray) => hiddenNodesArray.indexOf(id) === -1),\r\n            );\r\n\r\n            const clusters = findNodesClusters(state.proof, toHideNodes);\r\n            state.hiddenNodes = state.hiddenNodes\r\n                .concat(clusters)\r\n                .filter((hiddenNodesArray) => hiddenNodesArray.length > 0);\r\n\r\n            // Set the visual info for the new pi nodes\r\n            const piNodeId = Object.keys(state.visualInfo).length;\r\n            for (let i = 0; i < clusters.length; i++) {\r\n                state.visualInfo = {\r\n                    ...state.visualInfo,\r\n                    [piNodeId + i]: {\r\n                        color: '#555',\r\n                        x: 0,\r\n                        y: 0,\r\n                        selected: false,\r\n                    },\r\n                };\r\n            }\r\n\r\n            // Unselect the selected nodes\r\n            toHideNodes.forEach(\r\n                (id) =>\r\n                    (state.visualInfo[id] = {\r\n                        ...state.visualInfo[id],\r\n                        selected: false,\r\n                    }),\r\n            );\r\n        },\r\n        foldAllDescendants: (state, action: PayloadAction<number>) => {\r\n            state.hiddenNodes = state.hiddenNodes\r\n                .concat([\r\n                    [action.payload, ...descendants(state.proof, action.payload)].filter(\r\n                        (id, index, self) =>\r\n                            id > 0 &&\r\n                            id < state.proof.length &&\r\n                            state.hiddenNodes.every((hiddenNodesArray) => hiddenNodesArray.indexOf(id) === -1) &&\r\n                            self.indexOf(id) === index,\r\n                    ),\r\n                ])\r\n                .filter((hiddenNodesArray) => hiddenNodesArray.length > 0);\r\n\r\n            // Set the visual info for the new pi node and the root node\r\n            const piNodeId = Object.keys(state.visualInfo).length;\r\n            state.visualInfo = {\r\n                ...state.visualInfo,\r\n                [action.payload]: {\r\n                    ...state.visualInfo[action.payload],\r\n                    selected: false,\r\n                },\r\n                [piNodeId]: {\r\n                    color: '#555',\r\n                    x: 0,\r\n                    y: 0,\r\n                    selected: false,\r\n                },\r\n            };\r\n        },\r\n        unhideNodes: (state, action: PayloadAction<{ pi: number; hiddens: number[] }>) => {\r\n            const { pi, hiddens } = action.payload;\r\n            state.hiddenNodes = state.hiddenNodes\r\n                .map((hiddenNodesArray) => hiddenNodesArray.filter((id) => hiddens.indexOf(id) === -1))\r\n                .filter((hiddenNodesArray) => hiddenNodesArray.length > 0);\r\n\r\n            // Make sure the ids are realocated\r\n            const size = Object.keys(state.visualInfo).length;\r\n            for (let i = pi; i < size - 1; i++) {\r\n                state.visualInfo[i] = state.visualInfo[i + 1];\r\n            }\r\n            // Delete the last position\r\n            delete state.visualInfo[size - 1];\r\n\r\n            // Unselect the hidden nodes\r\n            hiddens.forEach(\r\n                (id) =>\r\n                    (state.visualInfo[id] = {\r\n                        ...state.visualInfo[id],\r\n                        selected: false,\r\n                    }),\r\n            );\r\n        },\r\n        setVisualInfo: (state, action: PayloadAction<ProofState['visualInfo']>) => {\r\n            state.visualInfo = action.payload;\r\n        },\r\n        selectNodes: (state, action: PayloadAction<number[]>) => {\r\n            const len = Object.keys(state.visualInfo).length;\r\n            action.payload.forEach((id) => {\r\n                if (id >= 0 && id < len) {\r\n                    state.visualInfo[id].selected = true;\r\n                }\r\n            });\r\n        },\r\n        unselectNodes: (state, action: PayloadAction<number[]>) => {\r\n            const len = Object.keys(state.visualInfo).length;\r\n            action.payload.forEach((id) => {\r\n                if (id >= 0 && id < len) {\r\n                    state.visualInfo[id].selected = false;\r\n                }\r\n            });\r\n        },\r\n        changeStyle: (state, action: PayloadAction<ProofState['style']>) => {\r\n            switch (action.payload) {\r\n                case 'graph':\r\n                    state.style = 'graph';\r\n                    break;\r\n                case 'directory':\r\n                    state.style = 'directory';\r\n                    break;\r\n            }\r\n        },\r\n        applyView: (state, action: PayloadAction<ProofState['view']>) => {\r\n            const visualInfoSize = Object.keys(state.visualInfo).length;\r\n            const proofSize = state.proof.length;\r\n            // Delete all the pi nodes\r\n            for (let i = 0; i < visualInfoSize - proofSize; i++) {\r\n                delete state.visualInfo[proofSize + i];\r\n            }\r\n\r\n            switch (action.payload) {\r\n                // View without hidden Nodes\r\n                case 'full':\r\n                    if (state.hiddenNodes.length || state.view === 'colored-full') {\r\n                        state.proof.forEach((node) => {\r\n                            state.visualInfo[node.id] = {\r\n                                color: '#fff',\r\n                                x: 0,\r\n                                y: 0,\r\n                                selected: false,\r\n                            };\r\n                        });\r\n\r\n                        state.hiddenNodes = [];\r\n                    }\r\n                    state.view = 'full';\r\n                    break;\r\n                // Cluster all the nodes in your respective group\r\n                case 'clustered':\r\n                    // If there are clusters infos\r\n                    if (state.clustersInfos.length) {\r\n                        state.view = 'clustered';\r\n\r\n                        state.hiddenNodes = [];\r\n                        let size = Object.keys(state.visualInfo).length;\r\n\r\n                        state.clustersInfos.forEach((cluster) => {\r\n                            if (cluster.hiddenNodes.length !== 1) {\r\n                                state.visualInfo[size++] = {\r\n                                    color: cluster.color,\r\n                                    x: 0,\r\n                                    y: 0,\r\n                                    selected: false,\r\n                                };\r\n\r\n                                state.hiddenNodes.push(cluster.hiddenNodes);\r\n                            }\r\n                            // Cluster with 1 node\r\n                            else {\r\n                                state.visualInfo[cluster.hiddenNodes[0]] = {\r\n                                    color: cluster.color,\r\n                                    x: 0,\r\n                                    y: 0,\r\n                                    selected: false,\r\n                                };\r\n                            }\r\n                        });\r\n                    }\r\n                    break;\r\n                // Apply full view but apply the clustrer color\r\n                case 'colored-full':\r\n                    state.view = 'colored-full';\r\n                    state.hiddenNodes = [];\r\n\r\n                    // If there are clusters infos\r\n                    if (state.clustersInfos.length) {\r\n                        state.clustersInfos.forEach((cluster) => {\r\n                            cluster.hiddenNodes.forEach((node) => {\r\n                                state.visualInfo[node] = {\r\n                                    color: cluster.color,\r\n                                    x: 0,\r\n                                    y: 0,\r\n                                    selected: false,\r\n                                };\r\n                            });\r\n                        });\r\n                    }\r\n                    break;\r\n            }\r\n        },\r\n        applyColor: (state, action: PayloadAction<string>) => {\r\n            Object.keys(state.visualInfo).forEach((id) => {\r\n                if (state.visualInfo[Number(id)].selected) {\r\n                    state.visualInfo[Number(id)].color = action.payload;\r\n                    state.visualInfo[Number(id)].selected = false;\r\n                }\r\n            });\r\n        },\r\n    },\r\n});\r\n\r\nexport const {\r\n    process,\r\n    hideNodes,\r\n    foldAllDescendants,\r\n    unhideNodes,\r\n    setVisualInfo,\r\n    selectNodes,\r\n    unselectNodes,\r\n    changeStyle,\r\n    applyView,\r\n    applyColor,\r\n} = proofSlice.actions;\r\n\r\nexport const selectProof = (state: RootState): NodeInterface[] => {\r\n    let proof = state.proof.proof;\r\n    const hiddenNodes = state.proof.hiddenNodes;\r\n\r\n    hiddenNodes.forEach((hiddenNodesArray) => {\r\n        const dependencies: { [parentId: number]: number[] } = {};\r\n        const children = piNodeChildren(proof, hiddenNodesArray);\r\n        const parents = piNodeParents(proof, hiddenNodesArray, dependencies);\r\n        const piNodeDependencies = groupPiNodeDependencies(proof, hiddenNodesArray);\r\n\r\n        const piNodeId = proof.length;\r\n        proof = proof.concat({\r\n            id: piNodeId,\r\n            conclusion: '',\r\n            rule: '',\r\n            args: '',\r\n            children: children,\r\n            parents: parents,\r\n            hiddenNodes: hiddenNodesArray.map((hiddenNode) => proof[hiddenNode]),\r\n            descendants: 1,\r\n            dependencies: piNodeDependencies,\r\n            clusterType: ClusterKind.NONE,\r\n        });\r\n\r\n        const piNode = proof[piNodeId];\r\n\r\n        children.forEach(\r\n            (childId) =>\r\n                (proof[childId] = {\r\n                    ...proof[childId],\r\n                    parents: proof[childId].parents\r\n                        .concat([piNodeId])\r\n                        .filter((proofNode) => hiddenNodesArray.indexOf(proofNode) === -1),\r\n                }),\r\n        );\r\n        parents.forEach(\r\n            (parentId) =>\r\n                (proof[parentId] = {\r\n                    ...proof[parentId],\r\n                    children: proof[parentId].children\r\n                        .concat([piNodeId])\r\n                        .filter((proofNode) => hiddenNodesArray.indexOf(proofNode) === -1),\r\n                }),\r\n        );\r\n\r\n        // Set the dependencies array of each parent that has deps and remove\r\n        //  the children that are dependencies\r\n        Object.keys(dependencies).forEach((parent) => {\r\n            const parentId = Number(parent);\r\n            proof[parentId] = {\r\n                ...proof[parentId],\r\n                children: proof[parentId].children.filter((c) => dependencies[parentId].indexOf(c) === -1),\r\n                dependencies: [...proof[parentId].dependencies, { piId: piNodeId, depsId: dependencies[parentId] }],\r\n            };\r\n        });\r\n\r\n        // Get the high hierarchy nodes in this pi node\r\n        const highHierarchyNodes = hiddenNodesArray?.filter((node) =>\r\n            proof[node].parents.every((parentId) => piNode.parents.indexOf(parentId) !== -1),\r\n        );\r\n\r\n        // Get the conclusion array\r\n        const conclusion = highHierarchyNodes.map((node) => ' ' + proof[node].conclusion);\r\n        piNode.conclusion = conclusion.length > 1 ? `[${conclusion} ]` : `${conclusion}`;\r\n\r\n        // Get the rule array\r\n        const rule = highHierarchyNodes.map((node) => ' ' + proof[node].rule);\r\n        piNode.rule = rule.length > 1 ? `[${rule} ]` : `${rule} `;\r\n\r\n        // Set the descendants number\r\n        piNode.descendants = piNode.children.reduce(\r\n            (ac: number, childID) => ((ac += proof[childID].descendants), ac),\r\n            1,\r\n        );\r\n    });\r\n\r\n    proof = proof.filter((proofNode) =>\r\n        hiddenNodes.every((hiddenNodesArray) => hiddenNodesArray.indexOf(proofNode.id) === -1),\r\n    );\r\n\r\n    return proof;\r\n};\r\n\r\nexport const selectOriginalProof = (state: RootState): NodeInterface[] => {\r\n    return state.proof.proof;\r\n};\r\n\r\nexport const selectView = (state: RootState): ProofState['view'] => {\r\n    return state.proof.view;\r\n};\r\n\r\nexport const selectStyle = (state: RootState): 'graph' | 'directory' => {\r\n    return state.proof.style;\r\n};\r\n\r\nexport const selectLetMap = (state: RootState): { [Key: string]: string } => {\r\n    return state.proof.letMap;\r\n};\r\n\r\nexport const selectTheoryLemmas = (state: RootState): ProofState['theoryLemmaMap'] => {\r\n    return state.proof.theoryLemmaMap;\r\n};\r\n\r\nexport const selectVisualInfo = (state: RootState): ProofState['visualInfo'] => {\r\n    if (state.proof.proof.length) return state.proof.visualInfo;\r\n    // If there is no proof node\r\n    return { 0: { color: '#555', x: 0, y: 0, selected: false } };\r\n};\r\n\r\nexport const selectHiddenNodes = (state: RootState): number[][] => {\r\n    return state.proof.hiddenNodes;\r\n};\r\n\r\nexport const selectNodeClusters = (state: RootState): ProofState['clustersInfos'] => {\r\n    return state.proof.clustersInfos;\r\n};\r\n\r\nexport default proofSlice.reducer;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\nimport { RootState } from '../../store';\r\nimport { ThemeState } from '../../../interfaces/interfaces';\r\n\r\nconst initialState: ThemeState = {\r\n    value: true,\r\n};\r\n\r\nexport const themeSlice = createSlice({\r\n    name: 'theme',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        toggle: (state) => {\r\n            state.value = !state.value;\r\n        },\r\n    },\r\n});\r\n\r\nexport const { toggle } = themeSlice.actions;\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice theme. For example: `useSelector((state: RootState) => state.counter.value)`\r\nexport const selectTheme = (state: RootState): boolean => state.theme.value;\r\n\r\nexport default themeSlice.reducer;\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { RootState } from '../../store';\r\nimport { ExternalCmdState } from '../../../interfaces/interfaces';\r\n\r\nconst initialState: ExternalCmdState = {\r\n    findData: {\r\n        nodeToFind: -1,\r\n        findOption: false,\r\n    },\r\n    renderData: {\r\n        count: 0,\r\n        fileChanged: false,\r\n    },\r\n};\r\n\r\nexport const externalCmd = createSlice({\r\n    name: 'externalCmd',\r\n    initialState,\r\n    reducers: {\r\n        findNode: (state, action: PayloadAction<{ nodeId: number; option: boolean }>) => {\r\n            state.findData = { nodeToFind: action.payload.nodeId, findOption: action.payload.option };\r\n        },\r\n        reRender: (state) => {\r\n            state.renderData.count = 0;\r\n        },\r\n        addRenderCount: (state) => {\r\n            state.renderData.count++;\r\n        },\r\n        blockRender: (state) => {\r\n            state.renderData.count = 2;\r\n        },\r\n        allowRenderNewFile: (state) => {\r\n            state.renderData.fileChanged = true;\r\n        },\r\n        blockRenderNewFile: (state) => {\r\n            state.renderData.fileChanged = false;\r\n        },\r\n    },\r\n});\r\n\r\nexport const { findNode, reRender, addRenderCount, blockRender, allowRenderNewFile, blockRenderNewFile } =\r\n    externalCmd.actions;\r\n\r\nexport const selectFindData = (state: RootState): { nodeToFind: number; findOption: boolean } =>\r\n    state.externalCmd.findData;\r\n\r\nexport const selectRenderData = (state: RootState): { count: number; fileChanged: boolean } =>\r\n    state.externalCmd.renderData;\r\n\r\nexport default externalCmd.reducer;\r\n","const examples: { [ex: string]: { dot: string; smt: string } } = {\r\n    ex1: {\r\n        dot: 'unsat\\r\\ndigraph proof {\\r\\n\\trankdir=\"BT\";\\r\\n\\tnode [shape=record];\\r\\n\\tcomment=\"{\\\\\"letMap\\\\\" : {\\\\\"let1\\\\\" : \\\\\"(f b)\\\\\", \\\\\"let2\\\\\" : \\\\\"(= (f a) let1)\\\\\", \\\\\"let3\\\\\" : \\\\\"(not let2)\\\\\", \\\\\"let4\\\\\" : \\\\\"(or p let3)\\\\\", \\\\\"let5\\\\\" : \\\\\"(not p)\\\\\", \\\\\"let6\\\\\" : \\\\\"(= a b)\\\\\", \\\\\"let7\\\\\" : \\\\\"(= let1 let1)\\\\\", \\\\\"let8\\\\\" : \\\\\"(not let7)\\\\\", \\\\\"let9\\\\\" : \\\\\"(not true)\\\\\", \\\\\"let10\\\\\" : \\\\\"(= p false)\\\\\"}}\";\\r\\n\\t0 [ label = \"{(not (and let6 let5 let4))|SCOPE :args [ let6, let5, let4 ]}\", comment = \"{\\\\\"subProofQty\\\\\":21}\" ];\\r\\n\\t1 [ label = \"{false|EQ_RESOLVE}\", comment = \"{\\\\\"subProofQty\\\\\":20}\" ];\\r\\n\\t2 [ label = \"{let3|CHAIN_RESOLUTION :args [ true, p ]}\", comment = \"{\\\\\"subProofQty\\\\\":3}\" ];\\r\\n\\t3 [ label = \"{let4|ASSUME}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t3 -> 2;\\r\\n\\t4 [ label = \"{let5|ASSUME}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t4 -> 2;\\r\\n\\t2 -> 1;\\r\\n\\t5 [ label = \"{(= let3 false)|TRANS}\", comment = \"{\\\\\"subProofQty\\\\\":16}\" ];\\r\\n\\t6 [ label = \"{(= let3 let8)|CONG :args [ not ]}\", comment = \"{\\\\\"subProofQty\\\\\":11}\" ];\\r\\n\\t7 [ label = \"{(= let2 let7)|CONG :args [ = ]}\", comment = \"{\\\\\"subProofQty\\\\\":10}\" ];\\r\\n\\t8 [ label = \"{let2|CONG :args [ f ]}\", comment = \"{\\\\\"subProofQty\\\\\":8}\" ];\\r\\n\\t9 [ label = \"{let6|AND_ELIM :args [ 1 ]}\", comment = \"{\\\\\"subProofQty\\\\\":7}\" ];\\r\\n\\t10 [ label = \"{(and let10 let6)|AND_INTRO}\", comment = \"{\\\\\"subProofQty\\\\\":6}\" ];\\r\\n\\t11 [ label = \"{let10|EQ_RESOLVE}\", comment = \"{\\\\\"subProofQty\\\\\":4}\" ];\\r\\n\\t4 -> 11;\\r\\n\\t12 [ label = \"{(= let5 let10)|SYMM}\", comment = \"{\\\\\"subProofQty\\\\\":2}\" ];\\r\\n\\t13 [ label = \"{(= let10 let5)|THEORY_REWRITE :args [ BOOL ]}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t13 -> 12;\\r\\n\\t12 -> 11;\\r\\n\\t11 -> 10;\\r\\n\\t14 [ label = \"{let6|ASSUME}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t14 -> 10;\\r\\n\\t10 -> 9;\\r\\n\\t9 -> 8;\\r\\n\\t8 -> 7;\\r\\n\\t15 [ label = \"{let7|REFL}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t15 -> 7;\\r\\n\\t7 -> 6;\\r\\n\\t6 -> 5;\\r\\n\\t16 [ label = \"{(= let8 false)|TRANS}\", comment = \"{\\\\\"subProofQty\\\\\":4}\" ];\\r\\n\\t17 [ label = \"{(= let8 let9)|CONG :args [ not ]}\", comment = \"{\\\\\"subProofQty\\\\\":2}\" ];\\r\\n\\t18 [ label = \"{(= let7 true)|THEORY_REWRITE :args [ UF ]}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t18 -> 17;\\r\\n\\t17 -> 16;\\r\\n\\t19 [ label = \"{(= let9 false)|THEORY_REWRITE :args [ BOOL ]}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t19 -> 16;\\r\\n\\t16 -> 5;\\r\\n\\t5 -> 1;\\r\\n\\t1 -> 0;\\r\\n\\r\\n}\\r\\n',\r\n        smt: `(set-logic QF_UF)\\n(set-info :category \"crafted\")\\n(set-info :status unsat)\\n(declare-sort U 0)\\n(declare-fun a () U)\\n(declare-fun b () U)\\n(declare-fun f (U) U)\\n(declare-fun p () Bool)\\n(assert (= a b))\\n(assert (not p))\\n(assert (or p (not (= (f a) (f b)))))\\n(check-sat)\\n(exit)`,\r\n    },\r\n    ex2: {\r\n        dot: 'unsat\\r\\ndigraph proof {\\r\\n\\trankdir=\"BT\";\\r\\n\\tnode [shape=record];\\r\\n\\tcomment=\"{\\\\\"letMap\\\\\" : {\\\\\"let1\\\\\" : \\\\\"(= (f a) (f b))\\\\\", \\\\\"let2\\\\\" : \\\\\"(not let1)\\\\\", \\\\\"let3\\\\\" : \\\\\"(or (not p3) let2)\\\\\", \\\\\"let4\\\\\" : \\\\\"(and p2 p3)\\\\\", \\\\\"let5\\\\\" : \\\\\"(or (not p1) let4)\\\\\", \\\\\"let6\\\\\" : \\\\\"(and p1 true)\\\\\", \\\\\"let7\\\\\" : \\\\\"(= a b)\\\\\", \\\\\"let8\\\\\" : \\\\\"(not let4)\\\\\", \\\\\"let9\\\\\" : \\\\\"(not let7)\\\\\"}}\";\\r\\n\\t0 [ label = \"{(not (and let7 let6 let5 let3))|SCOPE :args [ let7, let6, let5, let3 ]}\", comment = \"{\\\\\"subProofQty\\\\\":20}\" ];\\r\\n\\t1 [ label = \"{false|CHAIN_RESOLUTION :args [ true, let1, false, let7 ]}\", comment = \"{\\\\\"subProofQty\\\\\":19}\" ];\\r\\n\\t2 [ label = \"{(or let1 let9)|REORDERING}\", comment = \"{\\\\\"subProofQty\\\\\":7}\" ];\\r\\n\\t3 [ label = \"{(or let9 let1)|IMPLIES_ELIM}\", comment = \"{\\\\\"subProofQty\\\\\":6}\" ];\\r\\n\\t4 [ label = \"{(=\\\\> let7 let1)|SCOPE :args [ let7 ]}\", comment = \"{\\\\\"subProofQty\\\\\":5}\" ];\\r\\n\\t5 [ label = \"{let1|CONG :args [ f ]}\", comment = \"{\\\\\"subProofQty\\\\\":4}\" ];\\r\\n\\t6 [ label = \"{let7|SYMM}\", comment = \"{\\\\\"subProofQty\\\\\":3}\" ];\\r\\n\\t7 [ label = \"{(= b a)|SYMM}\", comment = \"{\\\\\"subProofQty\\\\\":2}\" ];\\r\\n\\t8 [ label = \"{let7|ASSUME}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t8 -> 7;\\r\\n\\t7 -> 6;\\r\\n\\t6 -> 5;\\r\\n\\t5 -> 4;\\r\\n\\t4 -> 3;\\r\\n\\t3 -> 2;\\r\\n\\t2 -> 1;\\r\\n\\t9 [ label = \"{let2|CHAIN_RESOLUTION :args [ false, p3 ]}\", comment = \"{\\\\\"subProofQty\\\\\":10}\" ];\\r\\n\\t10 [ label = \"{let3|ASSUME}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t10 -> 9;\\r\\n\\t11 [ label = \"{p3|CHAIN_RESOLUTION :args [ false, let4 ]}\", comment = \"{\\\\\"subProofQty\\\\\":8}\" ];\\r\\n\\t12 [ label = \"{(or p3 let8)|REORDERING}\", comment = \"{\\\\\"subProofQty\\\\\":2}\" ];\\r\\n\\t13 [ label = \"{(or let8 p3)|CNF_AND_POS :args [ let4, 1 ]}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t13 -> 12;\\r\\n\\t12 -> 11;\\r\\n\\t14 [ label = \"{let4|CHAIN_RESOLUTION :args [ false, p1 ]}\", comment = \"{\\\\\"subProofQty\\\\\":5}\" ];\\r\\n\\t15 [ label = \"{let5|ASSUME}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t15 -> 14;\\r\\n\\t16 [ label = \"{p1|EQ_RESOLVE}\", comment = \"{\\\\\"subProofQty\\\\\":3}\" ];\\r\\n\\t17 [ label = \"{let6|ASSUME}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t17 -> 16;\\r\\n\\t18 [ label = \"{(= let6 p1)|THEORY_REWRITE :args [ BOOL ]}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t18 -> 16;\\r\\n\\t16 -> 14;\\r\\n\\t14 -> 11;\\r\\n\\t11 -> 9;\\r\\n\\t9 -> 1;\\r\\n\\t19 [ label = \"{let7|ASSUME}\", comment = \"{\\\\\"subProofQty\\\\\":1}\" ];\\r\\n\\t19 -> 1;\\r\\n\\t1 -> 0;\\r\\n\\r\\n\\tsubgraph cluster_SAT {\\r\\n\\t\\tlabel=\"SAT\"\\r\\n\\t\\tbgcolor=\"purple\"\\r\\n\\t\\t1 2 9 11 12 14 \\r\\n\\t};\\r\\n\\tsubgraph cluster_CNF {\\r\\n\\t\\tlabel=\"CNF\"\\r\\n\\t\\tbgcolor=\"yellow\"\\r\\n\\t\\t3 13 \\r\\n\\t};\\r\\n\\tsubgraph cluster_TL {\\r\\n\\t\\tlabel=\"TL\"\\r\\n\\t\\tbgcolor=\"green\"\\r\\n\\t\\t4 5 6 7 8 \\r\\n\\t};\\r\\n\\tsubgraph cluster_PP {\\r\\n\\t\\tlabel=\"PP\"\\r\\n\\t\\tbgcolor=\"brown\"\\r\\n\\t\\t16 18 \\r\\n\\t};\\r\\n\\tsubgraph cluster_IN {\\r\\n\\t\\tlabel=\"IN\"\\r\\n\\t\\tbgcolor=\"blue\"\\r\\n\\t\\t10 15 17 19 \\r\\n\\t};\\r\\n}\\r\\n',\r\n        smt: `(set-logic QF_UF)\\n\\n(declare-sort U 0)\\n\\n(declare-const p1 Bool)\\n(declare-const p2 Bool)\\n(declare-const p3 Bool)\\n\\n(declare-const a U)\\n(declare-const b U)\\n(declare-fun f (U) U)\\n\\n(assert (= a b))\\n(assert (and p1 true))\\n(assert (or (not p1) (and p2 p3)))\\n(assert (or (not p3) (not (= (f a) (f b)))))\\n\\n(check-sat)`,\r\n    },\r\n};\r\n\r\nexport default examples;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { useAppSelector, useAppDispatch } from '../../store/hooks';\r\nimport { selectDot, selectFileName, set } from '../../store/features/file/fileSlice';\r\nimport {\r\n    applyView,\r\n    changeStyle,\r\n    selectNodes,\r\n    applyColor,\r\n    hideNodes,\r\n    foldAllDescendants,\r\n    unhideNodes,\r\n    selectVisualInfo,\r\n    selectProof,\r\n    selectHiddenNodes,\r\n    selectView,\r\n    unselectNodes,\r\n    process,\r\n} from '../../store/features/proof/proofSlice';\r\nimport { ReduxState, NavbarPropsAndRedux, NavbarProps } from '../../interfaces/interfaces';\r\n\r\nimport { Alignment, Button, Icon, InputGroup, Navbar, Switch, Menu, MenuItem } from '@blueprintjs/core';\r\nimport { Popover2 } from '@blueprintjs/popover2';\r\nimport { selectTheme, toggle } from '../../store/features/theme/themeSlice';\r\nimport '../../scss/VisualizerNavbar.scss';\r\nimport { allowRenderNewFile, findNode, reRender } from '../../store/features/externalCmd/externalCmd';\r\nimport examples from '../../examples/proofs-examples';\r\n\r\nfunction useWindowSize() {\r\n    // Initialize state with undefined width/height so server and client renders match\r\n    // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\r\n    const [windowSize, setWindowSize] = useState({\r\n        width: 0,\r\n        height: 0,\r\n    });\r\n    useEffect(() => {\r\n        // Handler to call on window resize\r\n        function handleResize() {\r\n            // Set window width/height to state\r\n            setWindowSize({\r\n                width: window.innerWidth,\r\n                height: window.innerHeight,\r\n            });\r\n        }\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []); // Empty array ensures that effect is only run on mount\r\n    return windowSize;\r\n}\r\n\r\nconst VisualizerNavbar: React.FC<NavbarPropsAndRedux> = ({\r\n    setDialogIsOpen,\r\n    setDrawerIsOpen,\r\n    addErrorToast,\r\n    setInTutorial,\r\n    inTutorial,\r\n    visualInfo,\r\n    proof,\r\n    dot,\r\n    view,\r\n    hiddenNodes,\r\n    hideNodes,\r\n}: NavbarPropsAndRedux) => {\r\n    const fileName = useAppSelector(selectFileName);\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const windowSize = useWindowSize();\r\n    const [command, setCommand] = useState('');\r\n    const [lastCommands, setLastCommands] = useState(['']);\r\n    const [commandId, setCommandId] = useState(0);\r\n    const [matchableCmd, setMatchableCmd] = useState<string[]>([]);\r\n    const [matchableCmdIsOpen, setMatchableCmdIsOpen] = useState(false);\r\n\r\n    const dispatch = useAppDispatch();\r\n\r\n    const commandsMap: { [cmd: string]: (cmds: string[]) => void } = {\r\n        ['/view']: (cmds: string[]) => {\r\n            switch (cmds[1]) {\r\n                case 'full':\r\n                    dispatch(applyView('full'));\r\n                    dispatch(reRender());\r\n                    break;\r\n                case 'clustered':\r\n                    dispatch(applyView('clustered'));\r\n                    dispatch(reRender());\r\n                    break;\r\n                case 'colored-full':\r\n                    dispatch(applyView('colored-full'));\r\n                    dispatch(reRender());\r\n                    break;\r\n            }\r\n        },\r\n        ['/select']: (cmds: string[]) => {\r\n            if (cmds[1]) {\r\n                let cmdArg = '';\r\n                cmds.forEach((string, id) => id !== 0 && (cmdArg += string + ' '));\r\n                // Matches all the brackets\r\n                const matches = [...cmdArg.matchAll(/\\[([^\\[\\]]+)\\]/g)];\r\n                let idList: number[] = [];\r\n\r\n                // There is a case with brackets\r\n                if (matches[0]) {\r\n                    const insideBracket = matches[0][1].trim();\r\n                    let insideMatches = [...insideBracket.matchAll(/\\s*\\d+\\s*-\\s*\\d+\\s*/g)];\r\n\r\n                    // Number range notation\r\n                    if (insideMatches[0]) {\r\n                        // Get the range limits\r\n                        const rangeLim = insideMatches[0][0].split(/\\s*-\\s*/).map((numS) => Number(numS));\r\n                        idList = Array.from({ length: rangeLim[1] - rangeLim[0] + 1 }, (_, i) => rangeLim[0] + i);\r\n                    }\r\n                    // List notation\r\n                    else {\r\n                        insideMatches = [...insideBracket.matchAll(/(\\s*\\d+\\s*,*)+/g)];\r\n                        // Number list notation\r\n                        if (insideMatches[0]) {\r\n                            // Group all the matches\r\n                            let listStr = '';\r\n                            insideMatches.forEach((match) => (listStr += match[0]));\r\n                            // Convert to number\r\n                            idList = listStr\r\n                                .split(/,\\s*/)\r\n                                .filter((word) => word.length > 0 && !isNaN(Number(word)))\r\n                                .map((id) => Number(id));\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Is a regex select?\r\n                    const matches = [...cmdArg.matchAll(/\\/[^\\/]*\\//g)];\r\n                    const argMatch = [...cmdArg.matchAll(/--(c|r)/g)];\r\n                    // If there is a regex\r\n                    if (matches[0]) {\r\n                        let argIsConclusion = true;\r\n                        // Try to find the option\r\n                        if (argMatch[0]) {\r\n                            switch (argMatch[0][1]) {\r\n                                case 'r':\r\n                                    argIsConclusion = false;\r\n                                    break;\r\n                                case 'c':\r\n                                    argIsConclusion = true;\r\n                                    break;\r\n                            }\r\n                        }\r\n\r\n                        const regexString = matches[0][0].substring(1, matches[0][0].length - 1);\r\n                        try {\r\n                            // Search all the nodes with the specific regex matching in the conclusion\r\n                            const regex = new RegExp(regexString);\r\n                            idList = proof\r\n                                .filter((node) => regex.test(argIsConclusion ? node.conclusion : node.rule))\r\n                                .map((node) => node.id);\r\n                        } catch (err) {\r\n                            // If the inserted regex expression is invalid (probably missing \\)\r\n                            addErrorToast('Regex error: probably and wrong regex expression');\r\n                        }\r\n                    }\r\n                }\r\n\r\n                dispatch(selectNodes(idList));\r\n            }\r\n        },\r\n        ['/unselect']: (cmds: string[]) => {\r\n            const allNodesIds = proof.map((node) => node.id);\r\n            dispatch(unselectNodes(allNodesIds));\r\n        },\r\n        ['/color']: (cmds: string[]) => {\r\n            if (cmds[1]) {\r\n                // Hex color\r\n                if (RegExp(/^#([0-9a-f]{3}){1,2}$/i).test(cmds[1])) {\r\n                    dispatch(applyColor(cmds[1]));\r\n                    return;\r\n                }\r\n                // Default colors\r\n                switch (cmds[1]) {\r\n                    case 'red':\r\n                        dispatch(applyColor('#f72b34'));\r\n                        break;\r\n                    case 'orange':\r\n                        dispatch(applyColor('#ff8334'));\r\n                        break;\r\n                    case 'yellow':\r\n                        dispatch(applyColor('#ffc149'));\r\n                        break;\r\n                    case 'green':\r\n                        dispatch(applyColor('#60aa51'));\r\n                        break;\r\n                    case 'blue':\r\n                        dispatch(applyColor('#0097e4'));\r\n                        break;\r\n                    case 'purple':\r\n                        dispatch(applyColor('#a73da5'));\r\n                        break;\r\n                    case 'brown':\r\n                        dispatch(applyColor('#a95a49'));\r\n                        break;\r\n                    case 'gray':\r\n                        dispatch(applyColor('#464646'));\r\n                        break;\r\n                    case 'white':\r\n                        dispatch(applyColor('#f0f0f0'));\r\n                        break;\r\n                }\r\n            }\r\n        },\r\n        ['/hide']: (cmds: string[]) => {\r\n            // Hide all the selected nodes\r\n            const hiddenIds = Object.keys(visualInfo)\r\n                .map((id) => Number(id))\r\n                .filter((id) => visualInfo[id].selected);\r\n            // Make sure there are nodes selected\r\n            if (hiddenIds.length > 1) {\r\n                // Re-render the canvas and update the store\r\n                dispatch(reRender());\r\n                dispatch(hideNodes(hiddenIds));\r\n            }\r\n        },\r\n        ['/fold']: (cmds: string[]) => {\r\n            // If the option is a number\r\n            if (cmds[1] && !isNaN(Number(cmds[1]))) {\r\n                const nodeId = Number(cmds[1]);\r\n                // Is a valid node\r\n                if (proof.findIndex((node) => node.id === nodeId) !== -1) {\r\n                    // Re-render the canvas and update the store\r\n                    dispatch(reRender());\r\n                    dispatch(foldAllDescendants(nodeId));\r\n                }\r\n            }\r\n        },\r\n        ['/unfold']: (cmds: string[]) => {\r\n            let hiddenIds: number[];\r\n            // If there is a number argument\r\n            if (cmds[1] && !isNaN(Number(cmds[1]))) {\r\n                const id = Number(cmds[1]);\r\n                // Get the pi node (to be unfold)\r\n                const obj = proof.find((node) => node.id === id);\r\n                // If it's a pi node\r\n                if (obj && obj.hiddenNodes?.length) {\r\n                    // Get the hidden nodes and their ids\r\n                    const hiddenNodes = obj.hiddenNodes ? obj.hiddenNodes : [];\r\n                    hiddenIds = hiddenNodes ? hiddenNodes.map((node) => node.id) : [];\r\n                    // Re-render the canvas and update the store\r\n                    dispatch(reRender());\r\n                    dispatch(unhideNodes({ pi: id, hiddens: hiddenIds }));\r\n                }\r\n            }\r\n        },\r\n        ['/find']: (cmds: string[]) => {\r\n            // If there is an argument and is a number\r\n            if (cmds[1] && !isNaN(Number(cmds[1]))) {\r\n                // Find the node\r\n                dispatch(\r\n                    findNode({\r\n                        nodeId: Number(cmds[1]),\r\n                        option: cmds[2] === '--s' ? true : false,\r\n                    }),\r\n                );\r\n            }\r\n        },\r\n    };\r\n    const commands = useRef(Object.keys(commandsMap)).current;\r\n\r\n    const openDialog = (content: string): void => {\r\n        setDialogIsOpen(true);\r\n    };\r\n\r\n    const findMatchableCmd = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.value.length) {\r\n            setMatchableCmd(commands.filter((cmd) => cmd.indexOf(e.target.value) !== -1));\r\n            setMatchableCmdIsOpen(true);\r\n        }\r\n        // If it's an empty string\r\n        else {\r\n            setMatchableCmd([]);\r\n            setMatchableCmdIsOpen(false);\r\n        }\r\n    };\r\n\r\n    const renderMatchableCmd = () => {\r\n        if (matchableCmd.length) {\r\n            const list: JSX.Element[] = [];\r\n            matchableCmd.forEach((cmd) => list.push(<MenuItem text={cmd} />));\r\n            return <Menu className=\"matchable-menu\">{list}</Menu>;\r\n        }\r\n        return <></>;\r\n    };\r\n\r\n    const handleInputKeyDown = (e: React.KeyboardEvent<HTMLElement>) => {\r\n        // Creates an commands historic, registering the past 4 commands\r\n        switch (e.key) {\r\n            case 'Enter':\r\n                // If the command is not a white space\r\n                if (command.trim() !== '') {\r\n                    runCommands(command);\r\n                    if (lastCommands.length === 5) {\r\n                        lastCommands.pop();\r\n                    }\r\n                    lastCommands.unshift('');\r\n                    setLastCommands(lastCommands);\r\n                    setCommand('');\r\n                }\r\n                setMatchableCmd([]);\r\n                break;\r\n            case 'ArrowUp':\r\n                if (commandId < lastCommands.length - 1) {\r\n                    const newId = commandId + 1;\r\n                    setCommandId(newId);\r\n                    setCommand(lastCommands[newId]);\r\n                    setMatchableCmd([]);\r\n                    setMatchableCmdIsOpen(false);\r\n                }\r\n                break;\r\n            case 'ArrowDown':\r\n                if (commandId > 0) {\r\n                    const newId = commandId - 1;\r\n                    setCommandId(newId);\r\n                    setCommand(lastCommands[newId]);\r\n                    setMatchableCmd([]);\r\n                    setMatchableCmdIsOpen(false);\r\n                }\r\n                break;\r\n        }\r\n    };\r\n\r\n    const runCommands = (command: string): void => {\r\n        const cmds = command.trim().split(/ +/);\r\n        // If the command exist\r\n        if (cmds[0] && commandsMap[cmds[0]]) {\r\n            commandsMap[cmds[0]](cmds);\r\n        }\r\n    };\r\n\r\n    const exportJSON = () => {\r\n        const downloadJSON = {\r\n            dot: dot,\r\n            visualInfo: visualInfo,\r\n            hiddenNodes: hiddenNodes,\r\n            view: view,\r\n        };\r\n        const fName = fileName.split('.');\r\n        fName.splice(fName.length - 1, 1);\r\n\r\n        const link = document.createElement('a');\r\n        link.download = fName + '.json';\r\n        link.href = `data:attachment/text,${encodeURIComponent(JSON.stringify(downloadJSON))}`;\r\n        link.click();\r\n    };\r\n\r\n    const menus = {\r\n        style: (\r\n            <Menu>\r\n                <MenuItem\r\n                    icon=\"diagram-tree\"\r\n                    text=\"Graph\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        dispatch(changeStyle('graph'));\r\n                    }}\r\n                />\r\n                <MenuItem\r\n                    icon=\"folder-open\"\r\n                    text=\"Directory\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        dispatch(changeStyle('directory'));\r\n                    }}\r\n                />\r\n            </Menu>\r\n        ),\r\n        download: (\r\n            <Menu>\r\n                <MenuItem icon=\"layout\" text=\"JSON\" onClick={exportJSON} />\r\n                <MenuItem\r\n                    icon=\"graph\"\r\n                    text=\"DOT\"\r\n                    href={`data:attachment/text,${encodeURIComponent(dot ? dot : '')}`}\r\n                    download={fileName ? `${fileName.replaceAll(' ', '_')}.dot` : ''}\r\n                />\r\n                <MenuItem\r\n                    icon=\"square\"\r\n                    text=\"PNG\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        const link = document.createElement('a');\r\n                        link.download = fileName ? `${fileName.replaceAll(' ', '_')}.png` : '';\r\n                        link.href = (\r\n                            document.getElementsByClassName('konvajs-content')[0].children[0] as HTMLCanvasElement\r\n                        ).toDataURL('image/png');\r\n                        link.click();\r\n                    }}\r\n                />\r\n            </Menu>\r\n        ),\r\n        help: (\r\n            <Menu>\r\n                <MenuItem text=\"/view\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that changes the view mode.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /view {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Option:</u> full, clustered and colored-full.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/select\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that select a group of nodes.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /select {'<option>'} {'<argument>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Options:</u>\r\n                            <div className=\"option\">\r\n                                1 - A list of node {`id's`} wrapped by brackets and separated by commas (and spaces if\r\n                                wanted) (eg.: [1, 15, 6,3]).\r\n                            </div>\r\n                            <div className=\"option\">\r\n                                2 - A range of node {`id's`} wrapped by brackets and separated by hyphen (and spaces if\r\n                                wanted) (eg.: [ 4 -15]). This range will include the last element.\r\n                            </div>\r\n                            <div className=\"option\">\r\n                                3 - A regex expression used to select all the nodes which the conclusion owns a match\r\n                                (eg.: /\\.*false\\.*/ {'->'} selects all the nodes with false anywhere in the conclusion).\r\n                                <br />\r\n                                <br />\r\n                                If wanted to search a match in the rule just insert the --r argument. The --c argument\r\n                                exists but the /select will by default search in the conclusion.\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/unselect\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that unselect all the nodes.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /unselect.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/color\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that changes the color of the current selected\r\n                            nodes.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /color {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Options:</u>\r\n                            <div className=\"option\">1 - A valid hex color notation (eg.: #A7B).</div>\r\n                            <div className=\"option\">\r\n                                2 - A color name between: red, orange, yellow, green, blue, purple, brown, gray, white.\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Prerequisites:</u> a group of nodes being selected.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/hide\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that try to fold (hide) a group of selected nodes.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /hide.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Prerequisites:</u> a group of nodes being selected.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/fold\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that fold all descendants of a specific node.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /fold {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Option:</u> a valid node id.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/unfold\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that unfold a specific pi node.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /unfold {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Option:</u> a valid pi node id.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/find\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that find a node and centralize the canvas at it.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /find {'<node number>'} {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Option:</u> --s: find and select the node.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n            </Menu>\r\n        ),\r\n        examples: (\r\n            <Menu>\r\n                {Object.keys(examples).map((ex, id) => {\r\n                    return (\r\n                        <MenuItem\r\n                            key={id}\r\n                            text={`Example ${id + 1}`}\r\n                            onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                                const dot = examples[ex].dot;\r\n                                e.preventDefault();\r\n\r\n                                dispatch(set({ name: `ex-${id + 1}`, value: dot }));\r\n                                dispatch(allowRenderNewFile());\r\n                                dispatch(reRender());\r\n\r\n                                dispatch(process(dot));\r\n                            }}\r\n                        />\r\n                    );\r\n                })}\r\n            </Menu>\r\n        ),\r\n    };\r\n\r\n    const criticalWidth = 1250;\r\n    return (\r\n        <Navbar>\r\n            <Navbar.Group align={Alignment.LEFT}>\r\n                <Navbar.Heading>\r\n                    <b id=\"proof-visualizer-name\">{windowSize.width >= criticalWidth ? 'Proof Visualizer' : 'PV'}</b>\r\n                </Navbar.Heading>\r\n                <Navbar.Divider />\r\n                <Button\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        openDialog('upload-proof');\r\n                    }}\r\n                    id=\"upload-proof-bt\"\r\n                    className=\"bp3-minimal\"\r\n                    icon=\"upload\"\r\n                    text={windowSize.width >= criticalWidth ? 'Upload Proof' : ''}\r\n                />\r\n                <Popover2 content={fileName ? menus.examples : undefined} placement=\"bottom-end\">\r\n                    <Button\r\n                        id=\"examples-bt\"\r\n                        className=\"bp3-minimal\"\r\n                        icon=\"manual\"\r\n                        text={windowSize.width >= criticalWidth ? 'Examples' : ''}\r\n                    />\r\n                </Popover2>\r\n            </Navbar.Group>\r\n\r\n            <Navbar.Group align={Alignment.RIGHT}>\r\n                {fileName ? (\r\n                    <>\r\n                        <Navbar.Heading id=\"file-name-title\">{fileName}</Navbar.Heading>\r\n                        <Navbar.Divider />\r\n                        <Popover2\r\n                            autoFocus={false}\r\n                            enforceFocus={false}\r\n                            content={renderMatchableCmd()}\r\n                            isOpen={matchableCmdIsOpen}\r\n                            disabled={matchableCmd.length === 0}\r\n                            placement=\"bottom-end\"\r\n                        >\r\n                            <InputGroup\r\n                                id=\"command\"\r\n                                placeholder=\"/command\"\r\n                                value={command}\r\n                                onChange={(e) => {\r\n                                    setCommandId(0);\r\n                                    lastCommands[0] = e.target.value;\r\n                                    setLastCommands(lastCommands);\r\n                                    setCommand(e.target.value);\r\n                                    findMatchableCmd(e);\r\n                                }}\r\n                                onKeyDown={handleInputKeyDown}\r\n                                rightElement={\r\n                                    <Popover2 content={menus.help} placement=\"bottom-end\">\r\n                                        <Button icon=\"help\" className=\"bp3-minimal\" />\r\n                                    </Popover2>\r\n                                }\r\n                                autoComplete=\"off\"\r\n                            />\r\n                        </Popover2>\r\n                        <Button\r\n                            style={{ marginLeft: '5px' }}\r\n                            icon=\"play\"\r\n                            onClick={() => {\r\n                                runCommands(command);\r\n                                lastCommands.pop();\r\n                                lastCommands.unshift(command);\r\n                                lastCommands[0] = '';\r\n                                setLastCommands(lastCommands);\r\n                                setCommand('');\r\n                            }}\r\n                        />\r\n                        <Navbar.Divider />\r\n                        <Popover2\r\n                            content={fileName ? menus.style : undefined}\r\n                            placement=\"bottom-end\"\r\n                            disabled={fileName ? false : true}\r\n                        >\r\n                            <Button\r\n                                id=\"style-bt\"\r\n                                icon=\"presentation\"\r\n                                className=\"bp3-minimal\"\r\n                                text={windowSize.width >= criticalWidth ? 'Style' : ''}\r\n                                disabled={fileName ? false : true}\r\n                            />\r\n                        </Popover2>\r\n                        <Button\r\n                            id=\"visualizers-bt\"\r\n                            className=\"bp3-minimal\"\r\n                            icon=\"applications\"\r\n                            text={windowSize.width >= criticalWidth ? 'Visualizers' : ''}\r\n                            disabled={fileName ? false : true}\r\n                            onClick={() => setDrawerIsOpen(true)}\r\n                        />\r\n                        <Popover2\r\n                            content={fileName ? menus.download : undefined}\r\n                            placement=\"bottom-end\"\r\n                            disabled={fileName ? false : true}\r\n                        >\r\n                            <Button\r\n                                id=\"download-bt\"\r\n                                className=\"bp3-minimal\"\r\n                                icon=\"download\"\r\n                                text={windowSize.width >= criticalWidth ? 'Download' : ''}\r\n                                disabled={fileName ? false : true}\r\n                            />\r\n                        </Popover2>\r\n                        <Button\r\n                            className=\"bp3-minimal\"\r\n                            icon=\"learning\"\r\n                            text={windowSize.width >= criticalWidth ? 'Tutorial' : ''}\r\n                            disabled={fileName ? false : true}\r\n                            onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                e.currentTarget.blur();\r\n                                setInTutorial(!inTutorial);\r\n                            }}\r\n                        />\r\n                        <Navbar.Divider />\r\n                    </>\r\n                ) : null}\r\n\r\n                <span id=\"switch-button-dark-theme\">\r\n                    <Switch checked={useAppSelector(selectTheme)} onChange={() => dispatch(toggle())} />\r\n                    <Icon icon={darkTheme ? 'moon' : 'flash'}></Icon>\r\n                </span>\r\n            </Navbar.Group>\r\n        </Navbar>\r\n    );\r\n};\r\n\r\nfunction mapStateToProps(state: ReduxState, ownProps: NavbarProps) {\r\n    return {\r\n        ...ownProps,\r\n        proof: selectProof(state),\r\n        dot: selectDot(state),\r\n        view: selectView(state),\r\n        visualInfo: selectVisualInfo(state),\r\n        hiddenNodes: selectHiddenNodes(state),\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = { hideNodes };\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(VisualizerNavbar);\r\n","import React, { useState, useReducer, useEffect } from 'react';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport { MaybeElement } from '@blueprintjs/core/lib/esm/common/props';\r\nimport { IconName } from '@blueprintjs/core/lib/esm/components/icon/icon';\r\n\r\nimport { Button, Classes, Dialog, FileInput, Intent } from '@blueprintjs/core';\r\n\r\nimport '../../scss/VisualizerDialog.scss';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { set } from '../../store/features/file/fileSlice';\r\nimport { process } from '../../store/features/proof/proofSlice';\r\nimport { allowRenderNewFile, blockRender, reRender } from '../../store/features/externalCmd/externalCmd';\r\nimport { VisualizerDialogProps } from '../../interfaces/interfaces';\r\n\r\ninterface DialogProps {\r\n    icon: IconName | MaybeElement;\r\n    title: React.ReactNode;\r\n}\r\n\r\nconst readUploadedFileAsText = (inputFile: File) => {\r\n    const temporaryFileReader = new FileReader();\r\n\r\n    return new Promise((resolve, reject) => {\r\n        temporaryFileReader.onerror = () => {\r\n            temporaryFileReader.abort();\r\n            reject(new DOMException('Problem parsing input file.'));\r\n        };\r\n\r\n        temporaryFileReader.onload = () => {\r\n            resolve(temporaryFileReader.result);\r\n        };\r\n        temporaryFileReader.readAsText(inputFile);\r\n    });\r\n};\r\n\r\nconst VisualizerDialog: React.FC<VisualizerDialogProps> = ({\r\n    dialogIsOpen,\r\n    setDialogIsOpen,\r\n    addErrorToast,\r\n}: VisualizerDialogProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const dispatch = useAppDispatch();\r\n\r\n    const [fileName, changeFileName] = useState('Choose file...');\r\n    const [file, changeFile] = useState('');\r\n    const [[focusFlag, flagCount], setFocusFlag] = useReducer(\r\n        (state: number[], newFlag: number): number[] => [newFlag, state[1] + 1],\r\n        [0, 0],\r\n    );\r\n\r\n    useEffect(() => {\r\n        if (dialogIsOpen) setFocusFlag(1);\r\n    }, [dialogIsOpen]);\r\n\r\n    useEffect(() => {\r\n        let el;\r\n        switch (focusFlag) {\r\n            // Focus the file input\r\n            case 1:\r\n                el = document.getElementsByClassName(Classes.DIALOG_BODY + ' dialog-body');\r\n                (el[0].childNodes[0] as HTMLElement).focus();\r\n                break;\r\n            // Focus the upload button\r\n            case 2:\r\n                el = document.getElementsByClassName(Classes.DIALOG_FOOTER_ACTIONS);\r\n                (el[0].childNodes[0] as HTMLElement).focus();\r\n                break;\r\n        }\r\n    }, [flagCount]);\r\n\r\n    const closeDialog = () => {\r\n        setDialogIsOpen(false);\r\n        changeFileName('Choose file...');\r\n        changeFile('');\r\n    };\r\n\r\n    const dialogProps: DialogProps = { icon: 'upload', title: 'Upload Proof' };\r\n    const dialogBody = (\r\n        <FileInput\r\n            text={fileName}\r\n            hasSelection={fileName !== 'Choose file...'}\r\n            onInputChange={async (e) => {\r\n                const target = e.target as HTMLInputElement;\r\n                const file = target.files ? target.files[0] : new File([''], 'filename');\r\n                if (\r\n                    target.files &&\r\n                    target.files[0] &&\r\n                    target.files[0].name.split('.').slice(-1)[0] !== 'dot' &&\r\n                    target.files[0].name.split('.').slice(-1)[0] !== 'json'\r\n                ) {\r\n                    addErrorToast('Sorry! Our app only support DOT and JSON files.');\r\n                    return;\r\n                }\r\n\r\n                try {\r\n                    // Make sure the file was selected and none error\r\n                    //  of \"no file select\" will be prompted\r\n                    if (file) {\r\n                        const fileContents = await readUploadedFileAsText(file);\r\n                        changeFile(fileContents as string);\r\n                        changeFileName(file.name);\r\n\r\n                        // If succeded, set the focus of the page to the upload button\r\n                        setFocusFlag(2);\r\n                    }\r\n                } catch (er: any) {\r\n                    addErrorToast(er.message);\r\n                }\r\n            }}\r\n            fill={true}\r\n        />\r\n    );\r\n    const succesButton = (\r\n        <Button\r\n            onClick={() => {\r\n                dispatch(set({ name: fileName, value: file }));\r\n\r\n                dispatch(allowRenderNewFile());\r\n                const ext = fileName.split('.').pop();\r\n                if (ext === 'json') dispatch(blockRender());\r\n                else if (ext === 'dot') dispatch(reRender());\r\n\r\n                dispatch(process(file));\r\n                closeDialog();\r\n            }}\r\n            intent={Intent.SUCCESS}\r\n            disabled={fileName === 'Choose file...'}\r\n        >\r\n            Upload Proof\r\n        </Button>\r\n    );\r\n\r\n    return (\r\n        <>\r\n            <Dialog\r\n                className={darkTheme ? ' bp3-dark' : ''}\r\n                isOpen={dialogIsOpen}\r\n                onClose={(): void => closeDialog()}\r\n                usePortal={true}\r\n                {...dialogProps}\r\n            >\r\n                <div className={Classes.DIALOG_BODY + ' dialog-body'}>{dialogBody}</div>\r\n                <div className={Classes.DIALOG_FOOTER}>\r\n                    <div className={Classes.DIALOG_FOOTER_ACTIONS}>{succesButton}</div>\r\n                </div>\r\n            </Dialog>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default VisualizerDialog;\r\n","import { KonvaEventObject } from 'konva/types/Node';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Label, Text, Tag, Group, Circle, Arrow } from 'react-konva';\r\nimport { NodeProps } from '../../../interfaces/interfaces';\r\n\r\nfunction getTextWidth(text: string, font: string): number {\r\n    const canvas = document.createElement('canvas');\r\n    const context = canvas.getContext('2d');\r\n    let size = 0;\r\n    if (context) {\r\n        context.font = font;\r\n        size = context.measureText(text).width;\r\n    }\r\n    return size;\r\n}\r\n\r\nfunction textColorFromBg(bgColor: string) {\r\n    const r = parseInt(bgColor.substring(0, 2), 16);\r\n    const g = parseInt(bgColor.substring(2, 4), 16);\r\n    const b = parseInt(bgColor.substring(4, 6), 16);\r\n    return r * 0.299 + g * 0.587 + b * 0.114 > 150 ? '#000000' : '#ffffff';\r\n}\r\n\r\nfunction sixDigitColor(bgColor: string): string {\r\n    if (bgColor.charAt(0) === '#') {\r\n        if (bgColor.length == 4) {\r\n            return bgColor\r\n                .substring(1, 7)\r\n                .split('')\r\n                .map((c) => c + c)\r\n                .join('');\r\n        } else if (bgColor.length == 7) {\r\n            return bgColor.substring(1, 7);\r\n        }\r\n    } else {\r\n        if (bgColor.length == 3) {\r\n            return bgColor\r\n                .split('')\r\n                .map((c) => c + c)\r\n                .join('');\r\n        } else if (bgColor.length == 6) {\r\n            return bgColor;\r\n        }\r\n    }\r\n    return '000000';\r\n}\r\n\r\nconst Node: React.FC<NodeProps> = (props: NodeProps): JSX.Element => {\r\n    const {\r\n        id,\r\n        conclusion,\r\n        rule,\r\n        args,\r\n        x,\r\n        y,\r\n        nHided,\r\n        nDescendants,\r\n        hiddenNodes,\r\n        dependencies,\r\n        selected,\r\n        color,\r\n        setNodeOnFocus,\r\n        toggleNodeSelection,\r\n        updateNodePosition,\r\n        openDrawer,\r\n        onDragEnd,\r\n        createTree,\r\n    } = props;\r\n\r\n    const handleClick = (e: KonvaEventObject<MouseEvent>): void => {\r\n        if (e.evt.button === 0) {\r\n            if (e.evt.shiftKey) {\r\n                toggleNodeSelection(id);\r\n            } else {\r\n                openDrawer(\r\n                    {\r\n                        rule: rule,\r\n                        args: args,\r\n                        conclusion: conclusion,\r\n                        nHided: nHided,\r\n                        nDescendants: nDescendants - (rule === '' ? 0 : 0),\r\n                        hiddenNodes: hiddenNodes,\r\n                        dependencies: dependencies,\r\n                    },\r\n                    createTree(id),\r\n                );\r\n            }\r\n        } else if (e.evt.button === 2) {\r\n            setNodeOnFocus(id);\r\n            const menuNode = document.getElementById('menu');\r\n            if (menuNode) {\r\n                menuNode.style.top = `${e.evt.clientY}px`;\r\n                menuNode.style.left = `${e.evt.clientX}px`;\r\n                menuNode.style.display = 'initial';\r\n                window.addEventListener('click', () => {\r\n                    menuNode.style.display = 'none';\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    const depSize = 25,\r\n        depLineSize = 25;\r\n    const bgColor = color;\r\n\r\n    const style = {\r\n        tag: {\r\n            fill: bgColor,\r\n            stroke: selected ? 'red' : 'black',\r\n            strokeWidth: selected ? 3 : 1,\r\n        },\r\n        get dep() {\r\n            return { ...this.tag };\r\n        },\r\n        text: {\r\n            align: 'center',\r\n            fill: textColorFromBg(sixDigitColor(bgColor)),\r\n            fontSize: 15,\r\n            height: 35,\r\n            padding: 10,\r\n            width: 300,\r\n        },\r\n        get depText() {\r\n            return {\r\n                ...this.text,\r\n                padding: 0,\r\n                width: depSize * 2,\r\n            };\r\n        },\r\n    };\r\n    const infos = {\r\n        nHided: nHided ? `#hidden: ${nHided}` : '',\r\n        nDescendants: ` #descendants: ${nDescendants}`,\r\n        rule: nHided ? '' : rule,\r\n        dependencies: dependencies.length === 1 ? String(dependencies[0].piId) : '',\r\n    };\r\n\r\n    const [idSize, setIdSize] = useState(50);\r\n    const [descendantSize, setDescendantSize] = useState(style.text.width - 50);\r\n\r\n    // Component Did Mount\r\n    useEffect(() => {\r\n        const font = `${style.text.fontSize}px -apple-system, \"BlinkMacSystemFont\", \"Segoe UI\", \"Roboto\", \"Oxygen\", \"Ubuntu\", \"Cantarell\", \"Open Sans\", \"Helvetica Neue\", \"Icons16\", sans-serif`;\r\n        const calc = getTextWidth(id.toString(), font) + style.text.padding * 3;\r\n        setIdSize(calc);\r\n        setDescendantSize(style.text.width - calc);\r\n    }, []);\r\n\r\n    return (\r\n        <Group\r\n            draggable\r\n            id={id.toString()}\r\n            key={id}\r\n            onDragMove={(e) => {\r\n                updateNodePosition(id, e.target.attrs.x, e.target.attrs.y);\r\n            }}\r\n            onDragEnd={onDragEnd}\r\n            x={x}\r\n            y={y}\r\n            onClick={handleClick}\r\n        >\r\n            <Label x={0} y={0}>\r\n                <Tag {...style.tag} />\r\n                <Text {...style.text} text={conclusion} />\r\n            </Label>\r\n            <Label x={0} y={35}>\r\n                <Tag {...style.tag} />\r\n                <Text {...style.text} text={infos.rule} />\r\n            </Label>\r\n            <Label x={0} y={70} {...{ align: 'right' }}>\r\n                <Tag {...style.tag} />\r\n                <Text {...{ ...style.text, width: idSize }} text={id.toString()} />\r\n            </Label>\r\n            <Label x={idSize} y={70}>\r\n                <Tag {...style.tag} />\r\n                <Text {...{ ...style.text, width: descendantSize }} text={infos.nHided + infos.nDescendants} />\r\n            </Label>\r\n            {dependencies.length ? (\r\n                <Label x={300} y={0}>\r\n                    <Arrow strokeWidth={1} stroke=\"black\" fill=\"black\" points={[depLineSize, 53, 0, 53]} />\r\n                    <Circle x={depLineSize + depSize} y={53} radius={depSize} {...style.dep}></Circle>\r\n                    <Label x={depLineSize} y={45}>\r\n                        <Text {...style.depText} text={infos.dependencies} />\r\n                    </Label>\r\n                </Label>\r\n            ) : null}\r\n        </Group>\r\n    );\r\n};\r\n\r\nexport default Node;\r\n","import React from 'react';\r\nimport { Arrow } from 'react-konva';\r\n\r\nimport { LineProps } from '../../../interfaces/interfaces';\r\n\r\nconst Line = ({ key, points }: LineProps): JSX.Element => {\r\n    return <Arrow key={key} strokeWidth={1} stroke=\"black\" fill=\"black\" points={[...points]} />;\r\n};\r\n\r\nexport default Line;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { ControlGroup, Button, InputGroup } from '@blueprintjs/core';\r\nimport { colorConverter } from '../../../store/features/theme/auxi';\r\n\r\nconst Menu = ({\r\n    unfold,\r\n    foldSelectedNodes,\r\n    foldAllDescendants,\r\n    changeNodeColor,\r\n    currentColor,\r\n    options,\r\n}: {\r\n    unfold: () => void;\r\n    foldSelectedNodes: () => void;\r\n    foldAllDescendants: () => void;\r\n    changeNodeColor: (color: string) => void;\r\n    currentColor: string;\r\n    options: { unfold: boolean; foldSelected: boolean; foldAllDescendants: boolean };\r\n}): JSX.Element => {\r\n    const [color, setColor] = useState(currentColor);\r\n\r\n    useEffect(() => {\r\n        setColor(currentColor);\r\n    }, [currentColor]);\r\n\r\n    return (\r\n        <div className=\"bp3-popover2-content\">\r\n            <ul id=\"menu\" className=\"bp3-menu\">\r\n                {options.unfold ? (\r\n                    <li className=\"\">\r\n                        <a className=\"bp3-menu-item\" onClick={() => unfold()}>\r\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-open\">\r\n                                <span> Unfold</span>\r\n                            </div>\r\n                        </a>\r\n                    </li>\r\n                ) : null}\r\n                {options.foldSelected ? (\r\n                    <li className=\"\">\r\n                        <a className=\"bp3-menu-item\" onClick={() => foldSelectedNodes()}>\r\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-off\">\r\n                                <span> Fold selected nodes</span>\r\n                            </div>\r\n                        </a>\r\n                    </li>\r\n                ) : null}\r\n                {options.foldAllDescendants ? (\r\n                    <li className=\"\">\r\n                        <a className=\"bp3-menu-item\" onClick={() => foldAllDescendants()}>\r\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-off\">\r\n                                <span> Fold all descendants</span>\r\n                            </div>\r\n                        </a>\r\n                    </li>\r\n                ) : null}\r\n                <li className=\"\">\r\n                    <a className=\"bp3-menu-item\">\r\n                        <div className=\"bp3-text-overflow-ellipsis bp3-fill\">\r\n                            <span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('red'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('orange'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('yellow'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('green'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('blue'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('purple'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('brown'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('black'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('white'))}> </span>\r\n                            </span>\r\n                        </div>\r\n                    </a>\r\n                </li>\r\n                <li className=\"\">\r\n                    <a className=\"bp3-menu-item\">\r\n                        <div className=\"bp3-text-overflow-ellipsis bp3-fill\">\r\n                            <ControlGroup\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                }}\r\n                                fill={true}\r\n                                vertical={false}\r\n                            >\r\n                                <InputGroup\r\n                                    placeholder={currentColor}\r\n                                    value={color}\r\n                                    onChange={(e) => setColor(e.target.value)}\r\n                                />\r\n                                <Button\r\n                                    icon=\"style\"\r\n                                    onClick={() => {\r\n                                        changeNodeColor(color);\r\n                                        setColor('');\r\n                                    }}\r\n                                    disabled={color.match(/^#([0-9a-f]{3}){1,2}$/i) === null}\r\n                                ></Button>\r\n                            </ControlGroup>\r\n                        </div>\r\n                    </a>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Menu;\r\n","import React, { Component } from 'react';\r\nimport { Stage, Layer } from 'react-konva';\r\nimport Konva from 'konva';\r\nimport dagre from 'dagre';\r\nimport Node from './VisualizerNode';\r\nimport Line from './VisualizerLine';\r\nimport Menu from './VisualizerMenu';\r\n\r\nimport {\r\n    NodeProps,\r\n    LineProps,\r\n    TreeNode,\r\n    CanvasPropsAndRedux,\r\n    NodeInterface,\r\n    ProofState,\r\n    ReduxState,\r\n} from '../../../interfaces/interfaces';\r\n\r\nimport '../../../scss/VisualizerCanvas.scss';\r\n\r\nimport { CanvasProps, CanvasState } from '../../../interfaces/interfaces';\r\nimport { connect } from 'react-redux';\r\nimport { selectProof, selectVisualInfo } from '../../../store/features/proof/proofSlice';\r\nimport {\r\n    hideNodes,\r\n    unhideNodes,\r\n    foldAllDescendants,\r\n    applyView,\r\n    setVisualInfo,\r\n} from '../../../store/features/proof/proofSlice';\r\nimport {\r\n    selectFindData,\r\n    findNode,\r\n    selectRenderData,\r\n    reRender,\r\n    addRenderCount,\r\n    blockRenderNewFile,\r\n} from '../../../store/features/externalCmd/externalCmd';\r\n\r\nconst nodeWidth = 300,\r\n    nodeHeight = 130;\r\n\r\nfunction handleWheel(e: Konva.KonvaEventObject<WheelEvent>): { stageScale: number; stageX: number; stageY: number } {\r\n    e.evt.preventDefault();\r\n\r\n    const scaleBy = 1.08;\r\n    const stage = e.target.getStage();\r\n    if (stage) {\r\n        const oldScale = stage.scaleX();\r\n        const pointerPosition = stage.getPointerPosition();\r\n        let x, y;\r\n\r\n        if (pointerPosition) {\r\n            [x, y] = [pointerPosition.x, pointerPosition.y];\r\n        } else {\r\n            [x, y] = [0, 0];\r\n        }\r\n\r\n        const mousePointTo = {\r\n            x: x / oldScale - stage.x() / oldScale,\r\n            y: y / oldScale - stage.y() / oldScale,\r\n        };\r\n\r\n        const newScale = e.evt.deltaY > 0 ? oldScale * scaleBy : oldScale / scaleBy;\r\n\r\n        return {\r\n            stageScale: newScale,\r\n            stageX: -(mousePointTo.x - x / newScale) * newScale,\r\n            stageY: -(mousePointTo.y - y / newScale) * newScale,\r\n        };\r\n    }\r\n    return {\r\n        stageScale: 1,\r\n        stageX: 0,\r\n        stageY: 0,\r\n    };\r\n}\r\n\r\nclass Canvas extends Component<CanvasPropsAndRedux, CanvasState> {\r\n    constructor(props: CanvasPropsAndRedux) {\r\n        super(props);\r\n        this.componentDidUpdate = this.componentDidUpdate.bind(this);\r\n        this.setNodeOnFocus = this.setNodeOnFocus.bind(this);\r\n\r\n        this.state = {\r\n            canvasSize: {\r\n                width: 520,\r\n                height: 300,\r\n            },\r\n            stage: {\r\n                stageScale: 1,\r\n                stageX: 0,\r\n                stageY: 0,\r\n            },\r\n            showingNodes: {},\r\n            showingEdges: {},\r\n            nodeOnFocus: NaN,\r\n            nodesSelected: [],\r\n            proof: [],\r\n            visualInfo: {},\r\n        };\r\n    }\r\n\r\n    static copyNodePosition = (\r\n        visualInfo: ProofState['visualInfo'],\r\n        showingNodes: CanvasState['showingNodes'],\r\n    ): ProofState['visualInfo'] => {\r\n        // Get the current position of the nodes and create a proofState with them included\r\n        const newVisualInfo: ProofState['visualInfo'] = {};\r\n        Object.keys(visualInfo).forEach((id) => {\r\n            const key = Number(id);\r\n\r\n            if (showingNodes[key]) {\r\n                newVisualInfo[key] = {\r\n                    ...visualInfo[key],\r\n                    x: showingNodes[key].props.x,\r\n                    y: showingNodes[key].props.y,\r\n                };\r\n            } else {\r\n                newVisualInfo[key] = {\r\n                    ...visualInfo[key],\r\n                };\r\n            }\r\n        });\r\n        return newVisualInfo;\r\n    };\r\n\r\n    static newNodeProps = (node: NodeInterface, visualInfos: ProofState['visualInfo']): NodeProps => {\r\n        const visualInfo = visualInfos[node.id];\r\n        return {\r\n            id: node.id,\r\n            conclusion: node.conclusion,\r\n            rule: node.rule,\r\n            args: node.args,\r\n            x: visualInfo.x,\r\n            y: visualInfo.y,\r\n            nHided: node.hiddenNodes ? node.hiddenNodes.length : 0,\r\n            nDescendants: node.descendants - 1,\r\n            hiddenNodes: node.hiddenNodes ? node.hiddenNodes.map((node) => node.id) : [],\r\n            dependencies: node.dependencies ? node.dependencies : [],\r\n            selected: visualInfo.selected,\r\n            color: visualInfo.color,\r\n            setNodeOnFocus: () => undefined,\r\n            toggleNodeSelection: () => undefined,\r\n            updateNodePosition: () => undefined,\r\n            openDrawer: () => undefined,\r\n            onDragEnd: () => undefined,\r\n            createTree: () => {\r\n                return [];\r\n            },\r\n        };\r\n    };\r\n\r\n    static getDerivedStateFromProps(props: CanvasPropsAndRedux, current_state: CanvasState) {\r\n        const proofChanged = JSON.stringify(current_state.proof) !== JSON.stringify(props.proof);\r\n        const visualInfoChanged = JSON.stringify(current_state.visualInfo) !== JSON.stringify(props.visualInfo);\r\n        const { nodeToFind, findOption } = props.nodeFindData;\r\n        const { count, fileChanged } = props.renderData;\r\n        const stage = current_state.stage;\r\n\r\n        // If there is a node to be found\r\n        if (nodeToFind > -1) {\r\n            // Is valid node\r\n            if (nodeToFind <= props.proof[props.proof.length - 1].id) {\r\n                // Change the stage position\r\n                const { x, y } = props.visualInfo[nodeToFind];\r\n                stage.stageX = current_state.canvasSize.width / 2 - (x + nodeWidth / 2) * stage.stageScale;\r\n                stage.stageY = current_state.canvasSize.height / 2 - (y + nodeHeight / 2) * stage.stageScale;\r\n\r\n                // Select the finded node\r\n                if (findOption) {\r\n                    props.setVisualInfo({\r\n                        ...props.visualInfo,\r\n                        [nodeToFind]: { ...props.visualInfo[nodeToFind], selected: true },\r\n                    });\r\n                }\r\n            }\r\n            // Reset the node finder\r\n            props.findNode({ nodeId: -1, option: false });\r\n        }\r\n\r\n        // If the proof or visual info changed or we have a new file being uploaded\r\n        if (proofChanged || visualInfoChanged || fileChanged) {\r\n            // Create the showing nodes array\r\n            const showingNodes: CanvasState['showingNodes'] = {};\r\n            props.proof.forEach((node, id) => {\r\n                showingNodes[node.id] = <Node key={id} {...Canvas.newNodeProps(node, props.visualInfo)} />;\r\n            });\r\n\r\n            // If has nodes and can render\r\n            if (showingNodes[0] && count < 2) {\r\n                props.addRenderCount();\r\n\r\n                const g = new dagre.graphlib.Graph();\r\n                g.setGraph({ rankdir: 'BT', ranker: 'tight-tree' });\r\n                g.setDefaultEdgeLabel(function () {\r\n                    return {};\r\n                });\r\n                props.proof.forEach((node) => {\r\n                    g.setNode(node.id.toString(), {\r\n                        width: nodeWidth + (node.dependencies.length ? 95 : 0),\r\n                        height: nodeHeight,\r\n                    });\r\n                    node.children.forEach((child) => {\r\n                        g.setEdge(child.toString(), node.id.toString());\r\n                    });\r\n                });\r\n                dagre.layout(g);\r\n\r\n                const xOffset = g.node('0').x - (showingNodes[0].props.x ? showingNodes[0].props.x : 0);\r\n                const yOffset = g.node('0').y - (showingNodes[0].props.y ? showingNodes[0].props.y : 0);\r\n                g.nodes().forEach((v) => {\r\n                    try {\r\n                        const { x, y } = g.node(v);\r\n                        const key = parseInt(v);\r\n                        showingNodes[key] = (\r\n                            <Node\r\n                                {...{\r\n                                    ...showingNodes[key].props,\r\n                                    x: x - xOffset,\r\n                                    y: y - yOffset,\r\n                                }}\r\n                            />\r\n                        );\r\n                    } catch (e) {\r\n                        console.log(e);\r\n                    }\r\n                });\r\n\r\n                props.setVisualInfo(Canvas.copyNodePosition(props.visualInfo, showingNodes));\r\n            }\r\n            // Reset the new file indicator if it's true\r\n            if (fileChanged) props.blockRenderNewFile();\r\n\r\n            return {\r\n                showingNodes: showingNodes,\r\n                showingEdges: {},\r\n                proof: props.proof,\r\n                visualInfo: props.visualInfo,\r\n                stage: stage,\r\n            };\r\n        }\r\n        return { stage: stage };\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        const { showingNodes } = this.state;\r\n        const { proof, visualInfo } = this.props;\r\n\r\n        const newShowingNodes: CanvasState['showingNodes'] = {};\r\n        proof.forEach((node, id) => {\r\n            newShowingNodes[node.id] = <Node key={id} {...Canvas.newNodeProps(node, visualInfo)} />;\r\n        });\r\n\r\n        this.setState({ proof: proof, showingNodes: newShowingNodes });\r\n\r\n        if (showingNodes[0]) {\r\n            const [width, height] = [window.innerWidth, window.innerHeight - 50];\r\n\r\n            // Make sure every time the Canvas is mounted the props are passed to the showing nodes\r\n            this.updateEdgesAndFuncs();\r\n\r\n            this.setState({\r\n                canvasSize: {\r\n                    width,\r\n                    height,\r\n                },\r\n                stage: {\r\n                    stageScale: 1,\r\n                    stageX: width / 2 - (showingNodes[0].props.x + 300 / 2),\r\n                    stageY: height / 10 - (showingNodes[0].props.y + 30 / 2),\r\n                },\r\n            });\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: CanvasPropsAndRedux) {\r\n        // If the proof changed\r\n        if (prevProps.proof !== this.props.proof) {\r\n            this.updateEdgesAndFuncs();\r\n        }\r\n    }\r\n\r\n    updateEdgesAndFuncs() {\r\n        const { showingNodes, showingEdges } = this.state;\r\n        const { proof } = this.props;\r\n\r\n        // Update edges\r\n        proof.forEach((node) => {\r\n            if (showingNodes[node.parents[0]]) {\r\n                node.parents.forEach((parent) => {\r\n                    showingEdges[`${node.id}->${parent}`] = Line(\r\n                        this.LineProps(\r\n                            `${node.id}->${parent}`,\r\n                            showingNodes[node.id].props,\r\n                            showingNodes[parent].props,\r\n                        ),\r\n                    );\r\n                });\r\n            }\r\n        });\r\n        Object.keys(showingNodes).forEach((nodeId: string) => {\r\n            // Make sure a function is updated once\r\n            if (!showingNodes[parseInt(nodeId)].props.setNodeOnFocus.length) {\r\n                const { openDrawer } = this.props;\r\n\r\n                // Set the node functions\r\n                showingNodes[parseInt(nodeId)] = (\r\n                    <Node\r\n                        {...{\r\n                            ...showingNodes[parseInt(nodeId)].props,\r\n                            setNodeOnFocus: this.setNodeOnFocus,\r\n                            toggleNodeSelection: this.toggleNodeSelection,\r\n                            updateNodePosition: this.updateNodePosition,\r\n                            openDrawer: openDrawer,\r\n                            onDragEnd: this.saveNodePosition,\r\n                            createTree: this.createTree,\r\n                        }}\r\n                    />\r\n                );\r\n            }\r\n        });\r\n        this.setState({ showingEdges, showingNodes });\r\n    }\r\n\r\n    /* NODE MENU ACTIONS */\r\n    foldAllDescendants = (): void => {\r\n        const { nodeOnFocus } = this.state;\r\n        const { foldAllDescendants, reRender } = this.props;\r\n\r\n        reRender();\r\n        foldAllDescendants(nodeOnFocus);\r\n        this.setState({ nodesSelected: [] });\r\n    };\r\n\r\n    foldSelectedNodes = (): void => {\r\n        const { nodesSelected } = this.state;\r\n        const { hideNodes, reRender } = this.props;\r\n\r\n        reRender();\r\n        hideNodes(nodesSelected);\r\n        this.setState({ nodesSelected: [] });\r\n    };\r\n\r\n    unfold = (): void => {\r\n        const { nodeOnFocus, proof } = this.state;\r\n        const { unhideNodes, reRender } = this.props;\r\n\r\n        // Get the pi node (to be unfold)\r\n        const obj = proof.find((node) => node.id === nodeOnFocus);\r\n        // Get the hidden nodes and their ids\r\n        const hiddenNodes = obj ? (obj.hiddenNodes ? obj.hiddenNodes : []) : [];\r\n        const hiddenIds = hiddenNodes ? hiddenNodes.map((node) => node.id) : [];\r\n\r\n        reRender();\r\n        unhideNodes({ pi: nodeOnFocus, hiddens: hiddenIds });\r\n\r\n        this.setState({ nodesSelected: [] });\r\n    };\r\n\r\n    changeNodeColor = (color: string): void => {\r\n        const { showingNodes, nodesSelected, nodeOnFocus } = this.state;\r\n        const { setVisualInfo } = this.props;\r\n        let { visualInfo } = this.props;\r\n\r\n        // Save the current position\r\n        nodesSelected.forEach((nodeId) => {\r\n            visualInfo = {\r\n                ...visualInfo,\r\n                [nodeId]: {\r\n                    ...visualInfo[nodeId],\r\n                    color: color,\r\n                    selected: false,\r\n                },\r\n            };\r\n        });\r\n        if (!nodesSelected.length && showingNodes[nodeOnFocus]) {\r\n            visualInfo = {\r\n                ...visualInfo,\r\n                [nodeOnFocus]: { ...visualInfo[nodeOnFocus], color: color, selected: false },\r\n            };\r\n        }\r\n\r\n        setVisualInfo(visualInfo);\r\n        this.setState({ nodesSelected: [] });\r\n    };\r\n\r\n    toggleNodeSelection = (id: number): void => {\r\n        let { nodesSelected } = this.state;\r\n        const { visualInfo, setVisualInfo } = this.props;\r\n\r\n        if (visualInfo[id].selected) {\r\n            nodesSelected = nodesSelected.filter((nodeId) => nodeId !== id);\r\n        } else {\r\n            nodesSelected.push(id);\r\n        }\r\n\r\n        // Save the current position\r\n        setVisualInfo({\r\n            ...visualInfo,\r\n            [id]: {\r\n                ...visualInfo[id],\r\n                selected: !visualInfo[id].selected,\r\n            },\r\n        });\r\n\r\n        this.setState({ nodesSelected });\r\n    };\r\n\r\n    /*TREE*/\r\n    createTree = (id: number): TreeNode[] => {\r\n        return this.props.createTree(this.state.proof, id);\r\n    };\r\n\r\n    /* UTILS */\r\n    setNodeOnFocus = (id: number): void => {\r\n        this.setState({ nodeOnFocus: id });\r\n    };\r\n\r\n    LineProps = (key: string, from: NodeProps, to: NodeProps): LineProps => ({\r\n        key,\r\n        points: [from.x + 150, from.y, to.x + 150, to.y + 105],\r\n    });\r\n\r\n    saveNodePosition = (): void => {\r\n        const { visualInfo, setVisualInfo } = this.props;\r\n        const { showingNodes } = this.state;\r\n\r\n        // Get the current position of the nodes and create a proofState with them included\r\n        setVisualInfo(Canvas.copyNodePosition(visualInfo, showingNodes));\r\n    };\r\n\r\n    updateNodePosition = (key: number, x: number, y: number): void => {\r\n        const { showingNodes, showingEdges } = this.state;\r\n\r\n        showingNodes[key] = <Node {...{ ...showingNodes[key].props, x, y }} />;\r\n\r\n        Object.keys(showingEdges)\r\n            .filter((edgeKey) => edgeKey.indexOf(key.toString()) !== -1)\r\n            .forEach((edge) => {\r\n                const [from, to] = edge.split('->').map((x) => parseInt(x));\r\n                showingEdges[edge] = Line(this.LineProps(edge, showingNodes[from].props, showingNodes[to].props));\r\n            });\r\n        this.setState({ showingNodes, showingEdges });\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        const { canvasSize, stage, showingNodes, showingEdges, nodesSelected, nodeOnFocus, proof } = this.state;\r\n        const color = showingNodes[nodeOnFocus] ? showingNodes[nodeOnFocus].props.color : '';\r\n        const found = proof.find((o) => o.id === nodeOnFocus);\r\n\r\n        return (\r\n            <div>\r\n                <Menu\r\n                    unfold={this.unfold}\r\n                    foldSelectedNodes={this.foldSelectedNodes}\r\n                    foldAllDescendants={this.foldAllDescendants}\r\n                    changeNodeColor={this.changeNodeColor}\r\n                    options={{\r\n                        unfold: showingNodes[nodeOnFocus] ? Boolean(showingNodes[nodeOnFocus].props.nHided) : false,\r\n                        foldSelected: nodesSelected.length && nodesSelected.includes(nodeOnFocus) ? true : false,\r\n                        foldAllDescendants:\r\n                            Boolean(found?.children.length) && !Boolean(found?.hiddenNodes?.length) && found?.id != 0,\r\n                    }}\r\n                    currentColor={color}\r\n                ></Menu>\r\n                <Stage\r\n                    draggable\r\n                    onDragMove={() => null}\r\n                    onDragEnd={() => null}\r\n                    width={canvasSize.width}\r\n                    height={canvasSize.height}\r\n                    onWheel={(e) => this.setState({ stage: handleWheel(e) })}\r\n                    scaleX={stage.stageScale}\r\n                    scaleY={stage.stageScale}\r\n                    x={stage.stageX}\r\n                    y={stage.stageY}\r\n                    onContextMenu={(e) => e.evt.preventDefault()}\r\n                >\r\n                    <Layer>\r\n                        {Object.keys(showingEdges).length > 0 &&\r\n                            Object.keys(showingEdges).map(function (key) {\r\n                                return showingEdges[key];\r\n                            })}\r\n                        {Object.keys(showingNodes).length > 0 &&\r\n                            Object.keys(showingNodes).map(\r\n                                (value: string): JSX.Element => showingNodes[parseInt(value)],\r\n                            )}\r\n                    </Layer>\r\n                </Stage>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: ReduxState, ownProps: CanvasProps) {\r\n    return {\r\n        visualInfo: selectVisualInfo(state),\r\n        nodeFindData: selectFindData(state),\r\n        renderData: selectRenderData(state),\r\n        ...ownProps,\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    hideNodes,\r\n    unhideNodes,\r\n    foldAllDescendants,\r\n    applyView,\r\n    setVisualInfo,\r\n    findNode,\r\n    reRender,\r\n    addRenderCount,\r\n    blockRenderNewFile,\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Canvas);\r\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport React, { useEffect, useReducer, useState } from 'react';\r\n\r\nimport { Classes, Tree, TreeNodeInfo } from '@blueprintjs/core';\r\nimport { TreeProps } from '../../interfaces/interfaces';\r\nimport { castProofNodeToTreeNode } from '../VisualizerStage/VisualizerStage';\r\n\r\nconst VisualizerTree: React.FC<TreeProps> = ({ darkTheme, proof, positionMap, content, setNodeInfo }: TreeProps) => {\r\n    // STATES:\r\n    const [, forceUpdate] = useReducer((x) => x + 1, 0);\r\n    const [nodes, setNodes] = useState(content);\r\n    const [selected, setSelected] = useState(NaN);\r\n\r\n    // USE EFFECT:\r\n    useEffect(() => setNodes(content), [content]);\r\n\r\n    // UTILS:\r\n    const forEachNode = (nodes: TreeNodeInfo[], callback: (node: TreeNodeInfo) => void) => {\r\n        if (nodes == null) {\r\n            return;\r\n        }\r\n\r\n        for (const node of nodes) {\r\n            callback(node);\r\n            forEachNode(node.childNodes ? node.childNodes : [], callback);\r\n        }\r\n    };\r\n\r\n    const handleNodeClick = (nodeData: any, _nodePath: number[], e: React.MouseEvent<HTMLElement>) => {\r\n        const toBeShow: any = selected !== nodeData.id ? nodeData : nodes[0];\r\n        setNodeInfo({\r\n            rule: toBeShow.rule ? toBeShow.rule : '',\r\n            args: toBeShow.args ? toBeShow.args : '',\r\n            conclusion: toBeShow.conclusion ? toBeShow.conclusion : '',\r\n            nHided: toBeShow.nHided ? toBeShow.nHided : 0,\r\n            nDescendants: toBeShow.descendants,\r\n            hiddenNodes: toBeShow.hiddenNodes,\r\n            dependencies: toBeShow.dependencies,\r\n        });\r\n        const originallySelected = nodeData.isSelected;\r\n\r\n        // Set all the nodes to be not selected\r\n        if (!e.shiftKey) forEachNode(nodes, (n) => (n.isSelected = false));\r\n\r\n        nodeData.isSelected = originallySelected == null ? true : !originallySelected;\r\n        setSelected(selected === nodeData.id ? NaN : nodeData.id);\r\n    };\r\n\r\n    const handleNodeCollapse = (nodeData: TreeNodeInfo) => {\r\n        nodeData.isExpanded = false;\r\n        forceUpdate();\r\n    };\r\n\r\n    const handleNodeExpand = (nodeData: TreeNodeInfo) => {\r\n        nodeData.isExpanded = true;\r\n        if (nodeData.hasCaret && !nodeData.childNodes?.length) {\r\n            const currentNode = proof[positionMap[nodeData.id]];\r\n            currentNode.children.forEach((c) => {\r\n                const child = proof[positionMap[c]];\r\n                nodeData.childNodes?.push(castProofNodeToTreeNode(child));\r\n            });\r\n        }\r\n        forceUpdate();\r\n    };\r\n\r\n    return (\r\n        <div style={{ backgroundColor: darkTheme ? '#394b59' : 'white' }}>\r\n            <Tree\r\n                contents={nodes}\r\n                onNodeClick={handleNodeClick}\r\n                onNodeCollapse={handleNodeCollapse}\r\n                onNodeExpand={handleNodeExpand}\r\n                className={Classes.ELEVATION_0}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VisualizerTree;\r\n","import React, { useState, useReducer, useEffect } from 'react';\r\n\r\nimport { Icon, Collapse, Pre } from '@blueprintjs/core';\r\n\r\nimport '../../../scss/VisualizerDirectoryStyle.scss';\r\nimport { useAppSelector } from '../../../store/hooks';\r\nimport { selectTheme } from '../../../store/features/theme/themeSlice';\r\nimport { NodeInfo, DirectoryStyleProps } from '../../../interfaces/interfaces';\r\nimport { drawerHelpersKind } from '../../../interfaces/enum';\r\nimport VisualizerTree from '../../VisualizerTree/VisualizerTree';\r\nimport { selectOriginalProof } from '../../../store/features/proof/proofSlice';\r\n\r\nconst VisualizerDirectoryStyle: React.FC<DirectoryStyleProps> = ({\r\n    proofTree,\r\n    ruleHelper,\r\n    indent,\r\n    translate,\r\n}: DirectoryStyleProps) => {\r\n    const proof = useAppSelector(selectOriginalProof);\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const [nodeInfo, setNodeInfo] = useState<NodeInfo>({\r\n        rule: '',\r\n        args: '',\r\n        conclusion: '',\r\n        nHided: 0,\r\n        nDescendants: 0,\r\n        hiddenNodes: [],\r\n        dependencies: [],\r\n    });\r\n    const [[ruleHelperIsOpen, argsHelperIsOpen, concHelperIsOpen], dispatchHelper] = useReducer(\r\n        (state: boolean[], action: { type: drawerHelpersKind; payload: boolean }): boolean[] => {\r\n            const { type, payload } = action;\r\n\r\n            // Act over all the positions\r\n            if (type === drawerHelpersKind.ALL) {\r\n                for (let i = 0; i < state.length; i++) {\r\n                    state[i] = payload;\r\n                }\r\n            }\r\n            // If wanna set a position\r\n            else if (payload) {\r\n                // Reset everything and set the wanted\r\n                for (let i = 0; i < state.length; i++) {\r\n                    state[i] = i === type ? payload : false;\r\n                }\r\n            }\r\n            // If wanna only reset a position\r\n            else state[type] = payload;\r\n\r\n            return [...state];\r\n        },\r\n        // Rule, args, conclusion\r\n        [false, false, false],\r\n    );\r\n    const [positionMap, setMap] = useState<any>({});\r\n\r\n    useEffect(() => {\r\n        const _map: any = {};\r\n        // Map the { [node id]: list array id }\r\n        proof.forEach((n, id) => (_map[n.id] = id));\r\n        setMap(_map);\r\n    }, [proof]);\r\n\r\n    const nodeInfoTable = () => {\r\n        return (\r\n            <table\r\n                id=\"table-node-info\"\r\n                className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\r\n                style={{ width: '100%' }}\r\n            >\r\n                <thead>\r\n                    <tr>\r\n                        <th>Property</th>\r\n                        <th>Value</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr>\r\n                        <td>\r\n                            <strong>RULE </strong>\r\n                            <Icon\r\n                                id=\"icon\"\r\n                                icon=\"help\"\r\n                                onClick={() => {\r\n                                    dispatchHelper({ type: drawerHelpersKind.RULE, payload: !ruleHelperIsOpen });\r\n                                }}\r\n                            ></Icon>\r\n                        </td>\r\n                        <td>\r\n                            {nodeInfo.rule}\r\n                            <Collapse isOpen={ruleHelperIsOpen}>\r\n                                <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                    {ruleHelper(nodeInfo.rule)}\r\n                                </Pre>\r\n                            </Collapse>\r\n                        </td>\r\n                    </tr>\r\n\r\n                    {nodeInfo.args && (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>ARGS</strong>{' '}\r\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\r\n                                    <Icon\r\n                                        id=\"icon\"\r\n                                        icon=\"translate\"\r\n                                        onClick={() => {\r\n                                            dispatchHelper({\r\n                                                type: drawerHelpersKind.ARGS,\r\n                                                payload: !argsHelperIsOpen,\r\n                                            });\r\n                                        }}\r\n                                    ></Icon>\r\n                                ) : null}\r\n                            </td>\r\n                            <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                                {nodeInfo.args}\r\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\r\n                                    <Collapse isOpen={argsHelperIsOpen}>\r\n                                        <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                            {indent(translate(nodeInfo.args))}\r\n                                        </Pre>\r\n                                    </Collapse>\r\n                                ) : null}\r\n                            </td>\r\n                        </tr>\r\n                    )}\r\n\r\n                    <tr>\r\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                            <strong>CONCLUSION</strong>{' '}\r\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\r\n                                <Icon\r\n                                    id=\"icon\"\r\n                                    icon=\"translate\"\r\n                                    onClick={() => {\r\n                                        dispatchHelper({ type: drawerHelpersKind.CONC, payload: !concHelperIsOpen });\r\n                                    }}\r\n                                ></Icon>\r\n                            ) : null}\r\n                        </td>\r\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                            {nodeInfo.conclusion}\r\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\r\n                                <Collapse isOpen={concHelperIsOpen}>\r\n                                    <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                        {indent(translate(nodeInfo.conclusion))}\r\n                                    </Pre>\r\n                                </Collapse>\r\n                            ) : null}\r\n                        </td>\r\n                    </tr>\r\n\r\n                    {nodeInfo.nDescendants ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>#DESCENDANTS</strong>\r\n                            </td>\r\n                            <td>{nodeInfo.nDescendants}</td>\r\n                        </tr>\r\n                    ) : null}\r\n\r\n                    {nodeInfo.nHided ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>#HIDDEN</strong>\r\n                            </td>\r\n                            <td>{`[${nodeInfo.hiddenNodes.map((node) => ' ' + node)} ]`}</td>\r\n                        </tr>\r\n                    ) : null}\r\n                    {nodeInfo.dependencies.length ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>DEPENDENCIES</strong>\r\n                            </td>\r\n                            <td>{`${nodeInfo.dependencies.map(\r\n                                (dependency) => ` ${dependency.piId}: [${dependency.depsId.map((dep) => ' ' + dep)} ] `,\r\n                            )}`}</td>\r\n                        </tr>\r\n                    ) : null}\r\n                </tbody>\r\n            </table>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className=\"dir-style\"\r\n            style={{\r\n                backgroundColor: darkTheme ? 'rgb(57, 75, 89)' : 'white',\r\n                height:\r\n                    window.innerHeight - (document.getElementsByClassName('bp3-navbar')[0] as HTMLElement).offsetHeight,\r\n            }}\r\n        >\r\n            <div\r\n                style={{\r\n                    width: '50%',\r\n                    height: '100%',\r\n                    float: 'left',\r\n                    clear: 'none',\r\n                    borderRight: '1px solid black',\r\n                    overflow: 'auto',\r\n                }}\r\n            >\r\n                <VisualizerTree\r\n                    darkTheme={darkTheme}\r\n                    proof={proof}\r\n                    positionMap={positionMap}\r\n                    content={proofTree}\r\n                    setNodeInfo={setNodeInfo}\r\n                ></VisualizerTree>\r\n            </div>\r\n            <div\r\n                style={{\r\n                    width: '50%',\r\n                    height: '100%',\r\n                    float: 'left',\r\n                    clear: 'none',\r\n                }}\r\n            >\r\n                {nodeInfoTable()}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VisualizerDirectoryStyle;\r\n","interface Line {\r\n    value: string;\r\n    indentLevel: number;\r\n}\r\n\r\nclass Let {\r\n    name: string;\r\n    value: string;\r\n    lines: Line[];\r\n    biggerID: number;\r\n    isExpanded: boolean;\r\n    externalLets: { [key: string]: { let: Let; idx: number[] } };\r\n\r\n    constructor(name: string, letText: string, letsList: { [key: string]: Let }, indices: { [key: number]: string }) {\r\n        this.name = name;\r\n        this.value = letText;\r\n        this.lines = [{ value: letText, indentLevel: 0 }];\r\n        this.biggerID = 0;\r\n        this.isExpanded = false;\r\n\r\n        this.externalLets = {};\r\n        Object.keys(indices).forEach((key) => {\r\n            const numKey = Number(key);\r\n            const letName = indices[numKey];\r\n            this.externalLets[letName] = {\r\n                let: letsList[letName],\r\n                idx: this.externalLets[letName] ? [...this.externalLets[letName].idx, numKey] : [numKey],\r\n            };\r\n        });\r\n    }\r\n\r\n    getTextWidth = (text: string, font: string): number => {\r\n        const canvas = document.createElement('canvas');\r\n        const context = canvas.getContext('2d');\r\n        let size = 0;\r\n        if (context) {\r\n            context.font = font;\r\n            size = context.measureText(text).width;\r\n        }\r\n        return size;\r\n    };\r\n\r\n    expandValue = (shouldUpdate = false): string => {\r\n        const keyList = Object.keys(this.externalLets).map((key) => this.externalLets[key].let.name);\r\n        let letText = this.value;\r\n\r\n        // Iterate from the last to the first external let\r\n        for (let i = keyList.length - 1; i >= 0; i--) {\r\n            const letName = keyList[i];\r\n\r\n            // For each let, iterate through all the indexes they show up inside the string\r\n            for (let k = this.externalLets[letName].idx.length - 1; k >= 0; k--) {\r\n                const idx = this.externalLets[letName].idx[k];\r\n\r\n                // Expand all the terms\r\n                letText =\r\n                    letText.substring(0, idx) +\r\n                    this.externalLets[letName].let.expandValue() +\r\n                    letText.substring(idx + letName.length, letText.length);\r\n            }\r\n        }\r\n        if (shouldUpdate) {\r\n            this.lines = [{ value: letText, indentLevel: 0 }];\r\n            this.biggerID = 0;\r\n        }\r\n        return letText;\r\n    };\r\n\r\n    expandPartialy = (externalRef: Let, letIdx: number): string => {\r\n        const key = externalRef.name;\r\n        const indentedText = this.printLines();\r\n\r\n        let lastLine = 0,\r\n            count = 0,\r\n            i;\r\n        // Iterates through the first lines until the point we reach the changed line\r\n        for (i = 0; i < this.lines.length; i++) {\r\n            lastLine = this.lines[i].value.length + 4 * this.lines[i].indentLevel + 1;\r\n            count += lastLine;\r\n            if (letIdx < count) break;\r\n        }\r\n        // New index (points to the start of the line content (ignores initial indent white space))\r\n        const newIdx = letIdx - (count - lastLine + 4 * this.lines[i].indentLevel);\r\n\r\n        // Update the new line to the new content\r\n        this.lines[i].value =\r\n            this.lines[i].value.substring(0, newIdx) +\r\n            externalRef.value +\r\n            this.lines[i].value.substring(newIdx + key.length, this.lines[i].value.length);\r\n\r\n        // Returns the indented text with the content to be replaced\r\n        return (\r\n            indentedText.substring(0, letIdx) +\r\n            externalRef.value +\r\n            indentedText.substring(letIdx + key.length, indentedText.length)\r\n        );\r\n    };\r\n\r\n    shrinkValue = (): string => {\r\n        this.lines = [{ value: this.value, indentLevel: 0 }];\r\n        this.biggerID = 0;\r\n        return this.value;\r\n    };\r\n\r\n    fitsTheWindow = (windowSize: number, font: string): boolean => {\r\n        const line = this.lines[this.biggerID];\r\n        const size = this.getTextWidth(`${'    '.repeat(line.indentLevel)}${line.value}`, font);\r\n        return size < windowSize;\r\n    };\r\n\r\n    indent = (windowSize: number, mode: boolean, font: string): string => {\r\n        let someDoesntFit;\r\n        if (mode) someDoesntFit = true;\r\n        else someDoesntFit = this.getTextWidth(this.lines[this.biggerID].value, font) < windowSize ? false : true;\r\n\r\n        // While there are lines that doesn't fit the window size\r\n        while (someDoesntFit) {\r\n            const { lines, biggerID } = this;\r\n            const newLines: Line[] = [];\r\n            const thisLevel = lines[biggerID].indentLevel;\r\n            const thisLine = lines[biggerID].value;\r\n\r\n            let lastSpace = -1,\r\n                lastUsedSpace = -1,\r\n                lastOpenParenthesis = -1,\r\n                indent = lines[biggerID].indentLevel - 1,\r\n                biggestSize = 0,\r\n                newBiggerID = 0;\r\n\r\n            // Iterate through the line and calculate the indentation levels\r\n            for (let i = 0; i < thisLine.length; i++) {\r\n                const c = thisLine[i];\r\n                // Opening parenthesis\r\n                if (c === '(') {\r\n                    indent++;\r\n                    // If it's one of the arguments of the operation\r\n                    if (indent === thisLevel + 1) lastOpenParenthesis = i;\r\n                }\r\n                // Closing parenthesis\r\n                else if (c === ')') {\r\n                    // If it's the end of this line\r\n                    if (indent === thisLevel) {\r\n                        // If the last argument was not inserted\r\n                        if (thisLine[i - 1] !== ')') {\r\n                            newLines.push({\r\n                                value: thisLine.substring(lastSpace + 1, i),\r\n                                indentLevel: indent + 1,\r\n                            });\r\n                        }\r\n                        newLines.push({ value: ')', indentLevel: indent });\r\n                    }\r\n                    // If it's the end of this argument\r\n                    else if (indent === thisLevel + 1) {\r\n                        newLines.push({\r\n                            value: thisLine.substring(lastOpenParenthesis, i + 1),\r\n                            indentLevel: indent,\r\n                        });\r\n                    }\r\n                    indent--;\r\n                }\r\n                // If a new space is detected in the current identation level\r\n                //   and the last argument is not between parenthesis\r\n                else if (c === ' ') {\r\n                    lastSpace = i;\r\n\r\n                    if (indent === thisLevel) {\r\n                        if (thisLine[i - 1] !== ')') {\r\n                            newLines.push({\r\n                                value: thisLine.substring(lastUsedSpace + 1, i),\r\n                                indentLevel: newLines.length ? indent + 1 : indent,\r\n                            });\r\n                        }\r\n                        lastUsedSpace = i;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Insert new lines if happend some indentation\r\n            if (newLines.length > 0) this.lines.splice(biggerID, 1, ...newLines);\r\n\r\n            // Find the new biggest line\r\n            this.lines.forEach((line, id) => {\r\n                // Get the size of this new line\r\n                const thisSize = this.getTextWidth(`${'    '.repeat(line.indentLevel)}${line.value}`, font);\r\n                if (thisSize > biggestSize) {\r\n                    biggestSize = thisSize;\r\n                    newBiggerID = id;\r\n                }\r\n            });\r\n\r\n            this.biggerID = newBiggerID;\r\n\r\n            // If the biggest size fits the window or no new line was found (minimal indentation)\r\n            if (biggestSize < windowSize || newLines.length < 1) someDoesntFit = false;\r\n        }\r\n        return this.printLines();\r\n    };\r\n\r\n    groupUp = (): string => {\r\n        let original = '';\r\n        // Group up all the lines into one single string\r\n        this.lines.forEach((line, id, self) => {\r\n            original += line.value;\r\n            if (id < self.length - 1 && self[id + 1].value !== ')') {\r\n                original += ' ';\r\n            }\r\n        });\r\n        return original;\r\n    };\r\n\r\n    printLines = (): string => {\r\n        return this.lines.reduce((ac, line) => (ac += `${'    '.repeat(line.indentLevel)}${line.value}\\n`), '');\r\n    };\r\n}\r\n\r\nexport default Let;\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { LetRenderProps } from '../../interfaces/interfaces';\r\nimport { renderLetKind } from '../../interfaces/enum';\r\nimport Let from './let';\r\nimport { Pre } from '@blueprintjs/core';\r\n\r\nconst font = '13px monospace';\r\n\r\nconst LetRender: React.FC<LetRenderProps> = ({\r\n    id,\r\n    toRender,\r\n    letMap,\r\n    shouldExpand,\r\n    shouldRevert,\r\n    dispatchExpansion,\r\n}: LetRenderProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const widthRef = useRef(0);\r\n    const [resizeMode, setResizeMode] = useState(0);\r\n    const [letMapS, setLetMapS] = useState(\r\n        (() => {\r\n            const newMap = { ...letMap };\r\n            if (toRender[0] !== '(' && toRender[toRender.length] !== ')') {\r\n                toRender = `(${toRender})`;\r\n            }\r\n            newMap['this'] = toRender;\r\n            return newMap;\r\n        })(),\r\n    );\r\n\r\n    const initializeLet = (key = 'this', lets: { [key: string]: Let } = {}) => {\r\n        const currentLet = letMapS[key];\r\n        const indices: { [key: number]: string } = {};\r\n\r\n        // Finds all occurences of let in the currentLet\r\n        [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n            if (match.index) indices[match.index] = match[0];\r\n        });\r\n\r\n        // Call recursive for all the external lets\r\n        Object.keys(indices).forEach((indice) => {\r\n            initializeLet(indices[Number(indice)], lets);\r\n        });\r\n\r\n        // If this let was not created yet\r\n        if (Object.keys(lets).indexOf(key) === -1) {\r\n            lets[key] = new Let(key, currentLet, lets, indices);\r\n        }\r\n\r\n        return lets;\r\n    };\r\n    const letsRef = useRef<{ [key: string]: Let }>(initializeLet());\r\n\r\n    // ComponentDidMount\r\n    useEffect(() => {\r\n        // Handler to call on window resize and set the value column width\r\n        function handleResize() {\r\n            const width = widthRef.current;\r\n\r\n            const newWidth = document.getElementsByClassName(`let-render-${id}`)[0].clientWidth - 30;\r\n            width === newWidth ? setResizeMode(1) : width > newWidth ? setResizeMode(0) : setResizeMode(2);\r\n\r\n            widthRef.current = newWidth;\r\n        }\r\n\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // Expand\r\n        if (shouldExpand) {\r\n            expandAll('this');\r\n            dispatchExpansion({ type: renderLetKind.EXPAND, payload: false });\r\n        }\r\n        // Revert\r\n        else if (shouldRevert) {\r\n            revertLet('this');\r\n            dispatchExpansion({ type: renderLetKind.REVERT, payload: false });\r\n        }\r\n    }, [shouldExpand, shouldRevert]);\r\n\r\n    const expandLet = (parent: string, key: string, letIdx: number) => {\r\n        const lets = letsRef.current;\r\n\r\n        const externalRef = lets[key];\r\n        lets[parent].isExpanded = true;\r\n        letMapS[parent] = lets[parent].expandPartialy(externalRef, letIdx);\r\n        setLetMapS({ ...letMapS });\r\n    };\r\n\r\n    const expandAll = (key: string) => {\r\n        const lets = letsRef.current;\r\n\r\n        lets[key].isExpanded = true;\r\n        letMapS[key] = lets[key].expandValue(true);\r\n        setLetMapS({ ...letMapS });\r\n    };\r\n\r\n    const revertLet = (key: string) => {\r\n        const lets = letsRef.current;\r\n\r\n        // Only when is expanded\r\n        if (lets[key].isExpanded) {\r\n            lets[key].isExpanded = false;\r\n            letMapS[key] = lets[key].shrinkValue();\r\n            setLetMapS({ ...letMapS });\r\n        }\r\n    };\r\n\r\n    const renderLet = (): JSX.Element => {\r\n        const lets = letsRef.current;\r\n        const width = widthRef.current;\r\n        const key = 'this';\r\n\r\n        // Waits for the width to be updated and the DOM element to be updated\r\n        if (width) {\r\n            let currentLet = letMapS[key];\r\n            let indices: { [key: number]: string } = {};\r\n\r\n            // Finds all occurences of let in the currentLet\r\n            [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                if (match.index !== undefined) indices[match.index] = match[0];\r\n            });\r\n\r\n            // If doesn't fits, then indent\r\n            if (!lets[key].fitsTheWindow(width, font)) {\r\n                currentLet = lets[key].indent(width, true, font);\r\n                letMapS[key] = currentLet;\r\n\r\n                indices = {};\r\n                // Finds all occurences of let in the currentLet after indentation\r\n                [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                    if (match.index) indices[match.index] = match[0];\r\n                });\r\n            }\r\n            // If fits\r\n            else {\r\n                // Only in the momment the page size is growing and the line is broken\r\n                if (resizeMode >= 0 && lets[key].lines.length > 1) {\r\n                    // Reset the line\r\n                    lets[key].lines = [\r\n                        { value: lets[key].isExpanded ? lets[key].groupUp() : lets[key].value, indentLevel: 0 },\r\n                    ];\r\n                    lets[key].biggerID = 0;\r\n\r\n                    // Indent it again\r\n                    currentLet = lets[key].indent(width, false, font);\r\n                    letMapS[key] = currentLet;\r\n\r\n                    indices = {};\r\n                    // Finds all occurences of let in the currentLet after indentation\r\n                    [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                        if (match.index) indices[match.index] = match[0];\r\n                    });\r\n                }\r\n            }\r\n\r\n            const arr: (JSX.Element | string)[] = [];\r\n            let start = 0;\r\n\r\n            // Slice the currentLet into an array with strings and JSX elements\r\n            Object.keys(indices).forEach((index, i, self) => {\r\n                const idx = Number(index);\r\n                const thisLet = indices[idx];\r\n\r\n                // Add the elements to the arr\r\n                arr.push(currentLet.substring(start, idx));\r\n                arr.push(\r\n                    <a\r\n                        className={darkTheme ? 'let-literal-or' : 'let-literal'}\r\n                        onClick={() => {\r\n                            expandLet(key, thisLet, idx);\r\n                        }}\r\n                    >\r\n                        {thisLet}\r\n                    </a>,\r\n                );\r\n                // Defines a new start\r\n                start = idx + thisLet.length;\r\n\r\n                // If it's the last let\r\n                if (i === self.length - 1) {\r\n                    arr.push(currentLet.substring(start, currentLet.length));\r\n                }\r\n            });\r\n\r\n            // If there is a let in this current let\r\n            if (Object.keys(indices).length) {\r\n                return (\r\n                    <span className=\"let-instance\" style={{ overflowWrap: 'break-word' }}>\r\n                        {arr}\r\n                    </span>\r\n                );\r\n            } else {\r\n                return (\r\n                    <span className=\"let-instance\" style={{ overflowWrap: 'break-word' }}>\r\n                        {currentLet}\r\n                    </span>\r\n                );\r\n            }\r\n        }\r\n        return <></>;\r\n    };\r\n\r\n    return (\r\n        <Pre\r\n            className={`let-render-${id}`}\r\n            style={{ maxHeight: '300px', overflow: 'auto', margin: '0', whiteSpace: 'pre-wrap' }}\r\n        >\r\n            {renderLet()}\r\n        </Pre>\r\n    );\r\n};\r\n\r\nexport default LetRender;\r\n","/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport React, { useEffect, useReducer, useState } from 'react';\r\n\r\nimport { Drawer, Position, Classes, Icon, Collapse, Pre, TreeNodeInfo } from '@blueprintjs/core';\r\nimport Canvas from './Canvas/VisualizerCanvas';\r\nimport VisualizerTree from '../VisualizerTree/VisualizerTree';\r\nimport VisualizerDirectoryStyle from './VisualizerDirectoryStyle/VisualizerDirectoryStyle';\r\n\r\nimport '../../scss/VisualizerStage.scss';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport { selectFileCount } from '../../store/features/file/fileSlice';\r\nimport { selectStyle, selectLetMap, selectProof } from '../../store/features/proof/proofSlice';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { NodeInfo, NodeInterface, TreeNode } from '../../interfaces/interfaces';\r\nimport { renderLetKind, drawerHelpersKind } from '../../interfaces/enum';\r\nimport LetRender from '../VisualizerLetDrawer/LetRender';\r\n\r\nfunction ruleHelper(rule: string) {\r\n    switch (rule.split(' ')[0]) {\r\n        case '':\r\n            return 'This node hides some parts of the proof, you can unfold it.';\r\n        case 'ASSUME':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Assumption (a leaf)\\nChildren: none\\nArguments: (F)\\n--------------\\nConclusion: F\\n\\nThis rule has special status, in that an application of assume is an open leaf in a proof that is not (yet) justified. An assume leaf is analogous to a free variable in a term, where we say \"F is a free assumption in proof P\" if it contains an application of F that is not  bound by SCOPE.'\r\n            );\r\n        case 'SCOPE':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Scope (a binder for assumptions)\\nChildren: (P:F)\\nArguments: (F1, ..., Fn)\\n--------------\\nConclusion: (=> (and F1 ... Fn) F) or (not (and F1 ... Fn)) if F is false\\n\\nThis rule has a dual purpose with ASSUME. It is a way to close assumptions in a proof. We require that F1 ... Fn are free assumptions in P and say that F1, ..., Fn are not free in (SCOPE P). In other words, they are bound by this application. For example, the proof node: (SCOPE (ASSUME F) :args F) has the conclusion (=> F F) and has no free assumptions. More generally, a proof with no free assumptions always concludes a valid formula.'\r\n            );\r\n        case 'SUBS':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Substitution\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (t, (ids)?)\\n---------------------------------------------------------------\\nConclusion: (= t t*sigma{ids}(Fn)*...*sigma{ids}(F1))\\nwhere sigma{ids}(Fi) are substitutions, which notice are applied in reverse order. Notice that ids is a MethodId identifier, which determines how to convert the formulas F1, ..., Fn into substitutions.'\r\n            );\r\n        case 'REWRITE':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Rewrite\\nChildren: none\\nArguments: (t, (idr)?)\\n----------------------------------------\\nConclusion: (= t Rewriter{idr}(t))\\nwhere idr is a MethodId identifier, which determines the kind of rewriter to apply, e.g. Rewriter::rewrite.'\r\n            );\r\n        case 'EVALUATE':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Evaluate\\nChildren: none\\n\\nArguments: (t)\\n----------------------------------------\\nConclusion: (= t Evaluator::evaluate(t))\\nNote this is equivalent to: (REWRITE t MethodId::RW_EVALUATE)'\r\n            );\r\n        case 'MACRO_SR_EQ_INTRO':\r\n            return (\r\n                rule +\r\n                \"\\n\\nIn this rule, we provide a term t and conclude that it is equal to its rewritten form under a (proven) substitution.\\n\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (t, (ids (ida (idr)?)?)?)\\n---------------------------------------------------------------\\nConclusion: (= t t')\\nwhere t' is Rewriter{idr}(t*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1))\\n\\nIn other words, from the point of view of Skolem forms, this rule transforms t to t' by standard substitution + rewriting.\\n\\nThe arguments ids, ida and idr are optional and specify the identifier of the substitution, the substitution application and rewriter respectively to be used.\"\r\n            );\r\n        case 'MACRO_SR_PRED_INTRO':\r\n            return (\r\n                rule +\r\n                \"\\n\\nIn this rule, we provide a formula F and conclude it, under the condition that it rewrites to true under a proven substitution.\\n\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (F, (ids (ida (idr)?)?)?)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)) == true where ids and idr are method identifiers.\\n\\nMore generally, this rule also holds when: Rewriter::rewrite(toOriginal(F')) == true where F' is the result of the left hand side of the equality above. Here, notice that we apply rewriting on the original form of F', meaning that this rule may conclude an F whose Skolem form is justified by the definition of its (fresh) Skolem variables. For example, this rule may justify the conclusion (= k t) where k is the purification Skolem for t, e.g. where the original form of k is t.\\n\\nFurthermore, notice that the rewriting and substitution is applied only within the side condition, meaning the rewritten form of the original form of F does not escape this rule.\"\r\n            );\r\n        case 'MACRO_SR_PRED_ELIM':\r\n            return (\r\n                rule +\r\n                \"\\n\\nIn this rule, if we have proven a formula F, then we may conclude its rewritten form under a proven substitution.\\n\\nChildren: (P1:F, P2:F1, ..., P_{n+1}:Fn)\\nArguments: ((ids (ida (idr)?)?)?)\\n----------------------------------------\\nConclusion: F'\\nwhere F' is Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)). where ids and idr are method identifiers.\\n\\nWe rewrite only on the Skolem form of F, similar to MACRO_SR_EQ_INTRO.\"\r\n            );\r\n        case 'MACRO_SR_PRED_TRANSFORM':\r\n            return (\r\n                rule +\r\n                \"\\n\\nIn this rule, if we have proven a formula F, then we may provide a formula G and conclude it if F and G are equivalent after rewriting under a proven substitution.\\n\\nChildren: (P1:F, P2:F1, ..., P_{n+1}:Fn)\\nArguments: (G, (ids (ida (idr)?)?)?)\\n----------------------------------------\\nConclusion: G\\nwhere Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)) == Rewriter{idr}(G*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1))\\n\\nMore generally, this rule also holds when:\\n  Rewriter::rewrite(toOriginal(F')) == Rewriter::rewrite(toOriginal(G'))\\nwhere F' and G' are the result of each side of the equation above. Here, original forms are used in a similar manner to MACRO_SR_PRED_INTRO above.\"\r\n            );\r\n        case 'REMOVE_TERM_FORMULA_AXIOM':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Remove Term Formulas Axiom\\nChildren: none\\nArguments: (t)\\n---------------------------------------------------------------\\nConclusion: RemoveTermFormulas::getAxiomFor(t).'\r\n            );\r\n        case 'THEORY_LEMMA':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Theory lemma\\nChildren: none\\nArguments: (F, tid)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is a (T-valid) theory lemma generated by theory with TheoryId tid. This is a \"coarse-grained\" rule that is used as a placeholder if a theory did not provide a proof for a lemma or conflict.'\r\n            );\r\n        case 'THEORY_REWRITE':\r\n            return (\r\n                rule +\r\n                \"\\n\\n======== Theory Rewrite\\nChildren: none\\nArguments: (F, tid, rid)\\n----------------------------------------\\nConclusion: F\\nwhere F is an equality of the form (= t t') where t' is obtained by applying the kind of rewriting given by the method identifier rid, which is one of: { RW_REWRITE_THEORY_PRE, RW_REWRITE_THEORY_POST, RW_REWRITE_EQ_EXT } Notice that the checker for this rule does not replay the rewrite to ensure correctness, since theory rewriter methods are not static. For example, the quantifiers rewriter involves constructing new bound variables that are not guaranteed to be consistent on each call.\"\r\n            );\r\n        case 'PREPROCESS':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = t' where t was replaced by t' based on some preprocessing pass, or otherwise F was added as a new assertion by some preprocessing pass.\"\r\n            );\r\n        case 'PREPROCESS_LEMMA':\r\n            return (\r\n                rule +\r\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F was added as a new assertion by some preprocessing pass.'\r\n            );\r\n        case 'THEORY_PREPROCESS':\r\n            return (\r\n                rule +\r\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = Theory::ppRewrite(t) for some theory. Notice this is a \"trusted\" rule.'\r\n            );\r\n        case 'THEORY_PREPROCESS_LEMMA':\r\n            return (\r\n                rule +\r\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F was added as a new assertion by theory preprocessing.'\r\n            );\r\n        case 'THEORY_EXPAND_DEF':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = t' where t was replaced by t' based on theory expand definitions.\"\r\n            );\r\n        case 'WITNESS_AXIOM':\r\n            return (\r\n                rule +\r\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an existential (exists ((x T)) (P x)) used for introducing a witness term (witness ((x T)) (P x)).'\r\n            );\r\n        case 'TRUST_REWRITE':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of rewriting that could not be replayed during proof postprocessing.\"\r\n            );\r\n        case 'TRUST_SUBS':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of substitution that could not be replayed during proof postprocessing.\"\r\n            );\r\n        case 'TRUST_SUBS_MAP':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of substitution that could not be determined by the TrustSubstitutionMap. This inference may contain possibly multiple children corresponding to the formulas used to derive the substitution.\"\r\n            );\r\n        case 'TRUST_SUBS_EQ':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is a solved equality of the form (= x t) derived as the solved form of F', where F' is given as a child.\"\r\n            );\r\n        case 'SAT_REFUTATION':\r\n            return (\r\n                rule +\r\n                '\\n\\n========= SAT Refutation for assumption-based unsat cores\\nChildren: (P1, ..., Pn)\\nArguments: none\\n---------------------\\nConclusion: false\\nNote: P1, ..., Pn correspond to the unsat core determined by the SAT solver.'\r\n            );\r\n        case 'RESOLUTION':\r\n            return (\r\n                rule +\r\n                \"\\n\\n======== Resolution\\nChildren:\\n(P1:C1, P2:C2)\\nArguments: (pol, L)\\n---------------------\\nConclusion: C\\nwhere\\n- C1 and C2 are nodes viewed as clauses, i.e., either an OR node with each children viewed as a literal or a node viewed as a literal. Note that an OR node could also be a literal.\\n- pol is either true or false, representing the polarity of the pivot on the first clause\\n- L is the pivot of the resolution, which occurs as is (resp. under a NOT) in C1 and negatively (as is) in C2 if pol = true (pol = false).\\nC is a clause resulting from collecting all the literals in C1, minus the first occurrence of the pivot or its negation, and C2, minus the first occurrence of the pivot or its negation, according to the policy above. If the resulting clause has a single literal, that literal itself is the result; if it has no literals, then the result is false; otherwise it's an OR node of the resulting literals.\\n\\nNote that it may be the case that the pivot does not occur in the clauses. In this case the rule is not unsound, but it does not correspond to resolution but rather to a weakening of the clause that did not have a literal eliminated.\"\r\n            );\r\n        case 'CHAIN_RESOLUTION':\r\n            return (\r\n                rule +\r\n                \"\\n\\n======== N-ary Resolution\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined above\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined above\\n- let C_1' = C_1 (from P1),\\n- for each i > 1, let C_i' = C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C = C_n'\"\r\n            );\r\n        case 'FACTORING':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Factoring\\nChildren: (P:C1)\\nArguments: ()\\n---------------------\\nConclusion: C2\\nwhere Set representations of C1 and C2 is the same and the number of literals in C2 is smaller than that of C1'\r\n            );\r\n        case 'REORDERING':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Reordering\\nChildren: (P:C1)\\nArguments: (C2)\\n---------------------\\nConclusion: C2\\nwhere Set representations of C1 and C2 are the same and the number of literals in C2 is the same of that of C1'\r\n            );\r\n        case 'MACRO_RESOLUTION':\r\n            return (\r\n                rule +\r\n                \"\\n\\n======== N-ary Resolution + Factoring + Reordering\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (C, pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined in RESOLUTION\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined in RESOLUTION\\n- let C_1' be equal, in its set representation, to C_1 (from P1),\\n- for each i > 1, let C_i' be equal, it its set representation, to C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C, which is equal, in its set representation, to C_n'\"\r\n            );\r\n        case 'MACRO_RESOLUTION_TRUST':\r\n            return (\r\n                rule +\r\n                \"\\n\\nAs MACRO_RESOLUTION but not checked\\n\\nMACRO_RESOLUTION definition:\\n======== N-ary Resolution + Factoring + Reordering\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (C, pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined in RESOLUTION\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined in RESOLUTION\\n- let C_1' be equal, in its set representation, to C_1 (from P1),\\n- for each i > 1, let C_i' be equal, it its set representation, to C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C, which is equal, in its set representation, to C_n'\"\r\n            );\r\n        default:\r\n            return rule;\r\n    }\r\n}\r\n\r\nexport function castProofNodeToTreeNode(node: NodeInterface): TreeNode {\r\n    const label = node.hiddenNodes?.length\r\n        ? // Pi node\r\n          `${node.id} :   ${node.conclusion}`\r\n        : node.dependencies.length\r\n        ? // Node with dependencies\r\n          `${node.id} :   ${node.conclusion}`\r\n        : //Normal node\r\n          `${node.id} : ${node.conclusion}`;\r\n\r\n    // Create the node tree\r\n    return {\r\n        id: node.id,\r\n        icon: 'graph',\r\n        label: label,\r\n        secondaryLabel: `${node.rule}`,\r\n        rule: node.rule,\r\n        args: node.args,\r\n        conclusion: node.conclusion,\r\n        parentId: node.parents[0],\r\n        descendants: node.descendants - 1,\r\n        nHided: node.hiddenNodes ? node.hiddenNodes.length : 0,\r\n        hiddenNodes: node.hiddenNodes ? node.hiddenNodes.map((n) => n.id) : [],\r\n        childNodes: [],\r\n        dependencies: node.dependencies,\r\n        parentsId: node.parents,\r\n        hasCaret: Boolean(node.descendants - 1),\r\n    };\r\n}\r\n\r\nfunction createTree(proof: NodeInterface[], id: number): TreeNode[] {\r\n    const rootNode = proof.find((o) => o.id === id);\r\n    const tree: TreeNode[] = [];\r\n\r\n    // Make sure found the root node\r\n    if (rootNode) {\r\n        tree.push(castProofNodeToTreeNode(rootNode));\r\n    }\r\n    return tree;\r\n}\r\n\r\nconst VisualizerStage: React.FC = () => {\r\n    // Proof data\r\n    const letMap = useAppSelector(selectLetMap);\r\n    const proof = useAppSelector(selectProof);\r\n    const fileID = useAppSelector(selectFileCount);\r\n    const style = useAppSelector(selectStyle);\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    // Data structures\r\n    const [proofTree, setProofTree] = useState<TreeNodeInfo[]>([]);\r\n    const [nodeInfo, setNodeInfo] = useState<NodeInfo>({\r\n        rule: '',\r\n        args: '',\r\n        conclusion: '',\r\n        nHided: 0,\r\n        nDescendants: 0,\r\n        hiddenNodes: [],\r\n        dependencies: [],\r\n    });\r\n    const [map, setMap] = useState<any>({});\r\n    // Drawer\r\n    const [[ruleHelperIsOpen, argsHelperIsOpen, concHelperIsOpen], dispatchHelper] = useReducer(\r\n        (state: boolean[], action: { type: drawerHelpersKind; payload: boolean }): boolean[] => {\r\n            const { type, payload } = action;\r\n\r\n            // Act over all the positions\r\n            if (type === drawerHelpersKind.ALL) {\r\n                for (let i = 0; i < state.length; i++) {\r\n                    state[i] = payload;\r\n                }\r\n            }\r\n            // If wanna set a position\r\n            else if (payload) {\r\n                // Reset everything and set the wanted\r\n                for (let i = 0; i < state.length; i++) {\r\n                    state[i] = i === type ? payload : false;\r\n                }\r\n            }\r\n            // If wanna only reset a position\r\n            else state[type] = payload;\r\n\r\n            return [...state];\r\n        },\r\n        // Rule, args, conclusion\r\n        [false, false, false],\r\n    );\r\n    const [[expandAll, revertAll], dispatchLetExpansion] = useReducer(\r\n        (state: boolean[], action: { type: renderLetKind; payload: boolean }): boolean[] => {\r\n            const { type, payload } = action;\r\n\r\n            for (let i = 0; i < state.length; i++) {\r\n                state[i] = i === type ? payload : false;\r\n            }\r\n\r\n            return [...state];\r\n        },\r\n        // Expand, revert\r\n        [false, false],\r\n    );\r\n    const [drawerIsOpen, setDrawerIsOpen] = useState(false);\r\n    const [tree, setTree] = useState<TreeNodeInfo[]>([]);\r\n\r\n    // Make sure that a new tree is created only when a new dot is used\r\n    useEffect(() => setProofTree(createTree(proof, 0)), [fileID]);\r\n    useEffect(() => {\r\n        const _map: any = {};\r\n        // Map the { [node id]: list array id }\r\n        proof.forEach((n, id) => (_map[n.id] = id));\r\n        setMap(_map);\r\n    }, [proof]);\r\n\r\n    const openDrawer = (nodeInfo: NodeInfo, tree?: TreeNodeInfo[]) => {\r\n        setNodeInfo(nodeInfo);\r\n        setTree(tree ? tree : []);\r\n        setDrawerIsOpen(true);\r\n    };\r\n\r\n    const nodeInfoTable = (): JSX.Element => {\r\n        return (\r\n            <table\r\n                id=\"table-node-info\"\r\n                className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\r\n                style={{ width: '100%' }}\r\n            >\r\n                <thead>\r\n                    <tr>\r\n                        <th>Property</th>\r\n                        <th>Value</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr>\r\n                        <td>\r\n                            <strong>RULE </strong>\r\n                            <Icon\r\n                                id=\"icon\"\r\n                                icon=\"help\"\r\n                                onClick={() => {\r\n                                    dispatchHelper({ type: drawerHelpersKind.RULE, payload: !ruleHelperIsOpen });\r\n                                }}\r\n                            ></Icon>\r\n                        </td>\r\n                        <td>\r\n                            {nodeInfo.rule}\r\n                            <Collapse isOpen={ruleHelperIsOpen}>\r\n                                <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                    {ruleHelper(nodeInfo.rule)}\r\n                                </Pre>\r\n                            </Collapse>\r\n                        </td>\r\n                    </tr>\r\n\r\n                    {nodeInfo.args && (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>ARGS</strong>{' '}\r\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\r\n                                    <Icon\r\n                                        id=\"icon\"\r\n                                        icon=\"translate\"\r\n                                        onClick={() => {\r\n                                            dispatchHelper({\r\n                                                type: drawerHelpersKind.ARGS,\r\n                                                payload: !argsHelperIsOpen,\r\n                                            });\r\n                                        }}\r\n                                    ></Icon>\r\n                                ) : null}\r\n                            </td>\r\n                            <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                                {nodeInfo.args}\r\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\r\n                                    <Collapse isOpen={argsHelperIsOpen}>\r\n                                        <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                            {nodeInfo.args}\r\n                                        </Pre>\r\n                                    </Collapse>\r\n                                ) : null}\r\n                            </td>\r\n                        </tr>\r\n                    )}\r\n\r\n                    <tr>\r\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                            <strong>CONCLUSION</strong>{' '}\r\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\r\n                                <>\r\n                                    <Icon\r\n                                        id=\"icon\"\r\n                                        icon=\"translate\"\r\n                                        onClick={() => {\r\n                                            dispatchHelper({\r\n                                                type: drawerHelpersKind.CONC,\r\n                                                payload: !concHelperIsOpen,\r\n                                            });\r\n                                            dispatchLetExpansion({\r\n                                                type: renderLetKind.EXPAND,\r\n                                                payload: true,\r\n                                            });\r\n                                        }}\r\n                                    ></Icon>\r\n                                    <Icon\r\n                                        id=\"icon\"\r\n                                        icon=\"undo\"\r\n                                        onClick={() => {\r\n                                            dispatchHelper({\r\n                                                type: drawerHelpersKind.CONC,\r\n                                                payload: false,\r\n                                            });\r\n                                            dispatchLetExpansion({\r\n                                                type: renderLetKind.REVERT,\r\n                                                payload: true,\r\n                                            });\r\n                                        }}\r\n                                    ></Icon>\r\n                                </>\r\n                            ) : null}\r\n                        </td>\r\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\r\n                                <LetRender\r\n                                    id={0}\r\n                                    toRender={nodeInfo.conclusion}\r\n                                    letMap={letMap}\r\n                                    shouldExpand={expandAll}\r\n                                    shouldRevert={revertAll}\r\n                                    dispatchExpansion={dispatchLetExpansion}\r\n                                />\r\n                            ) : null}\r\n                        </td>\r\n                    </tr>\r\n\r\n                    {nodeInfo.nDescendants ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>#DESCENDANTS</strong>\r\n                            </td>\r\n                            <td>{nodeInfo.nDescendants}</td>\r\n                        </tr>\r\n                    ) : null}\r\n\r\n                    {nodeInfo.nHided ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>#HIDDEN</strong>\r\n                            </td>\r\n                            <td>{`[${nodeInfo.hiddenNodes.map((node) => ' ' + node)} ]`}</td>\r\n                        </tr>\r\n                    ) : null}\r\n                    {nodeInfo.dependencies.length ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>DEPENDENCIES</strong>\r\n                            </td>\r\n                            <td>{`${nodeInfo.dependencies.map(\r\n                                (dependency) => ` ${dependency.piId}: [${dependency.depsId.map((dep) => ' ' + dep)} ] `,\r\n                            )}`}</td>\r\n                        </tr>\r\n                    ) : null}\r\n                </tbody>\r\n            </table>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div onContextMenu={(e) => e.preventDefault()}>\r\n            {proof.length > 1 && (\r\n                <>\r\n                    {style === 'graph' ? (\r\n                        <Canvas key={fileID} proof={proof} openDrawer={openDrawer} createTree={createTree} />\r\n                    ) : (\r\n                        <VisualizerDirectoryStyle\r\n                            proofTree={proofTree}\r\n                            ruleHelper={ruleHelper}\r\n                            indent={() => ''}\r\n                            translate={() => ''}\r\n                        />\r\n                    )}\r\n                    <Drawer\r\n                        className={darkTheme ? 'bp3-dark' : ''}\r\n                        autoFocus={true}\r\n                        canEscapeKeyClose={true}\r\n                        canOutsideClickClose={true}\r\n                        enforceFocus={true}\r\n                        hasBackdrop={false}\r\n                        isOpen={drawerIsOpen}\r\n                        position={Position.BOTTOM}\r\n                        usePortal={true}\r\n                        onClose={(e) => {\r\n                            e.preventDefault();\r\n                            setDrawerIsOpen(false);\r\n                            dispatchHelper({ type: drawerHelpersKind.ALL, payload: false });\r\n                        }}\r\n                        icon=\"info-sign\"\r\n                        title=\"Node info\"\r\n                    >\r\n                        <div className={Classes.DRAWER_BODY}>\r\n                            <div style={{ maxHeight: '500px', overflow: 'auto' }}>\r\n                                <VisualizerTree\r\n                                    darkTheme={darkTheme}\r\n                                    proof={proof}\r\n                                    positionMap={map}\r\n                                    content={tree}\r\n                                    setNodeInfo={setNodeInfo}\r\n                                />\r\n                            </div>\r\n                            <div className={Classes.DIALOG_BODY}>{nodeInfoTable()}</div>\r\n                        </div>\r\n                    </Drawer>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VisualizerStage;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Button, Classes } from '@blueprintjs/core';\r\n\r\nimport Let from './let';\r\nimport '../../scss/Let.scss';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { selectLetMap } from '../../store/features/proof/proofSlice';\r\nimport { DrawerVisualizerTabProps } from '../../interfaces/interfaces';\r\n\r\nconst font =\r\n    '14px / 18px -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Open Sans\", \"Helvetica Neue\", Icons16, sans-serif';\r\n\r\nconst VisualizerLetDrawer: React.FC<DrawerVisualizerTabProps> = ({ shouldResize }: DrawerVisualizerTabProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const widthRef = useRef(0);\r\n    const [resizeMode, setResizeMode] = useState(0);\r\n\r\n    const [letMap, setLetMap] = useState({ ...useAppSelector(selectLetMap) });\r\n    const letsRef = useRef<{ [key: string]: Let }>({});\r\n\r\n    // Handler to call on window resize and set the value column width\r\n    function handleResize() {\r\n        const width = widthRef.current;\r\n\r\n        // -22 from the fixed padding size\r\n        const newWidth = document.getElementsByClassName('letMap-value-column')[0].clientWidth - 24;\r\n        width === newWidth ? setResizeMode(1) : width > newWidth ? setResizeMode(0) : setResizeMode(2);\r\n\r\n        widthRef.current = newWidth;\r\n    }\r\n\r\n    // ComponentDidMount\r\n    useEffect(() => {\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n\r\n        // Init the let ref\r\n        Object.keys(letMap).forEach((key) => {\r\n            const currentLet = letMap[key];\r\n            const indices: { [key: number]: string } = {};\r\n            // Finds all occurences of let in the currentLet\r\n            [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                if (match.index) indices[match.index] = match[0];\r\n            });\r\n\r\n            letsRef.current[key] = new Let(key, currentLet, letsRef.current, indices);\r\n        });\r\n\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        handleResize();\r\n    }, [shouldResize]);\r\n\r\n    const expandLet = (parent: string, key: string, letIdx: number) => {\r\n        const lets = letsRef.current;\r\n\r\n        const externalRef = lets[key];\r\n        lets[parent].isExpanded = true;\r\n        letMap[parent] = lets[parent].expandPartialy(externalRef, letIdx);\r\n        setLetMap({ ...letMap });\r\n    };\r\n\r\n    const expandAll = (key: string) => {\r\n        const thisLet = letsRef.current[key];\r\n        thisLet.isExpanded = true;\r\n        letMap[key] = thisLet.expandValue(true);\r\n        setLetMap({ ...letMap });\r\n    };\r\n\r\n    const revertLet = (key: string) => {\r\n        const thisLet = letsRef.current[key];\r\n        // Only when is expanded\r\n        if (thisLet.isExpanded) {\r\n            thisLet.isExpanded = false;\r\n            letMap[key] = thisLet.shrinkValue();\r\n            setLetMap({ ...letMap });\r\n        }\r\n    };\r\n\r\n    const renderLet = (key: string): JSX.Element => {\r\n        const lets = letsRef.current;\r\n        const width = widthRef.current;\r\n\r\n        // Waits for the width to be updated and the DOM element to be updated\r\n        if (width) {\r\n            let currentLet = letMap[key];\r\n            const thisLet = lets[key];\r\n\r\n            // If doesn't fits, then indent\r\n            if (!thisLet.fitsTheWindow(width, font)) {\r\n                currentLet = thisLet.indent(width, true, font);\r\n                letMap[key] = currentLet;\r\n            }\r\n            // If fits, then only in the momment the page size is growing and the line is broken\r\n            else if (resizeMode >= 0 && thisLet.lines.length > 1) {\r\n                // Reset the line\r\n                thisLet.lines = [{ value: thisLet.isExpanded ? thisLet.groupUp() : thisLet.value, indentLevel: 0 }];\r\n                thisLet.biggerID = 0;\r\n\r\n                // Indent it again\r\n                currentLet = thisLet.indent(width, false, font);\r\n                letMap[key] = currentLet;\r\n            }\r\n\r\n            // Finds all occurences of let in the currentLet\r\n            const indices: { [key: number]: string } = {};\r\n            [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                if (match.index) indices[match.index] = match[0];\r\n            });\r\n\r\n            const arr: (JSX.Element | string)[] = [];\r\n            let start = 0;\r\n            // Slice the currentLet into an array with strings and JSX elements\r\n            Object.keys(indices).forEach((index, i, self) => {\r\n                const idx = Number(index);\r\n                const thisLet = indices[idx];\r\n\r\n                // Add the elements to the arr\r\n                arr.push(currentLet.substring(start, idx));\r\n                arr.push(\r\n                    <a\r\n                        className={darkTheme ? 'let-literal-or' : 'let-literal'}\r\n                        onClick={() => {\r\n                            expandLet(key, thisLet, idx);\r\n                        }}\r\n                    >\r\n                        {thisLet}\r\n                    </a>,\r\n                );\r\n                // Defines a new start\r\n                start = idx + thisLet.length;\r\n\r\n                // If it's the last let\r\n                if (i === self.length - 1) {\r\n                    arr.push(currentLet.substring(start, currentLet.length));\r\n                }\r\n            });\r\n\r\n            // If there is a let in this current let\r\n            if (Object.keys(indices).length) {\r\n                return <span className=\"let-instance\">{arr}</span>;\r\n            } else {\r\n                return <span className=\"let-instance\">{currentLet}</span>;\r\n            }\r\n        }\r\n        return <></>;\r\n    };\r\n\r\n    return (\r\n        <div className={Classes.DIALOG_BODY}>\r\n            <table\r\n                id=\"table-node-info-2\"\r\n                className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\r\n                style={{ width: '100%' }}\r\n            >\r\n                <thead>\r\n                    <tr>\r\n                        <th style={{ width: '50px' }}>Property</th>\r\n                        <th className=\"letMap-value-column\">Value</th>\r\n                        <th style={{ width: '100px' }}>Action</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {Object.keys(letMap).map((key, id) => {\r\n                        return (\r\n                            <tr key={id}>\r\n                                <td>\r\n                                    <strong>{key}</strong>\r\n                                </td>\r\n                                <td style={{ width: '100%', whiteSpace: 'pre-wrap' }}>{renderLet(key)}</td>\r\n                                <td style={{ width: '100px', height: '100%' }}>\r\n                                    <Button\r\n                                        onClick={() => expandAll(key)}\r\n                                        className=\"bp3-minimal\"\r\n                                        icon=\"translate\"\r\n                                        text=\"Expand\"\r\n                                    />\r\n                                    <Button\r\n                                        onClick={() => revertLet(key)}\r\n                                        className=\"bp3-minimal\"\r\n                                        icon=\"undo\"\r\n                                        text=\"Revert\"\r\n                                    />\r\n                                </td>\r\n                            </tr>\r\n                        );\r\n                    })}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VisualizerLetDrawer;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Button, Classes } from '@blueprintjs/core';\r\nimport { selectLetMap, selectTheoryLemmas } from '../../store/features/proof/proofSlice';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport Let from '../VisualizerLetDrawer/let';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { DrawerVisualizerTabProps } from '../../interfaces/interfaces';\r\n\r\nconst font =\r\n    '14px / 18px -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Open Sans\", \"Helvetica Neue\", Icons16, sans-serif';\r\n\r\nconst VisualizerTheoryLemma: React.FC<DrawerVisualizerTabProps> = ({ shouldResize }: DrawerVisualizerTabProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const letMap = useAppSelector(selectLetMap);\r\n    const widthRef = useRef(0);\r\n\r\n    const [theoryLemmas, setTheoryLemmas] = useState([...useAppSelector(selectTheoryLemmas)]);\r\n    const [resizeMode, setResizeMode] = useState(0);\r\n    const letsRef = useRef<{ [key: string]: Let }>({});\r\n\r\n    // Handler to call on window resize and set the value column width\r\n    function handleResize() {\r\n        const width = widthRef.current;\r\n\r\n        // -22 from the fixed padding size\r\n        const newWidth = document.getElementsByClassName('theoryLemma-value-column')[0].clientWidth - 24;\r\n        width === newWidth ? setResizeMode(1) : width > newWidth ? setResizeMode(0) : setResizeMode(2);\r\n\r\n        widthRef.current = newWidth;\r\n    }\r\n\r\n    // ComponentDidMount\r\n    useEffect(() => {\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n\r\n        // Init the lets\r\n        Object.keys(letMap).forEach((key) => {\r\n            const currentLet = letMap[key];\r\n\r\n            const indices: { [key: number]: string } = {};\r\n            // Finds all occurences of let in the currentLet\r\n            [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                if (match.index) indices[match.index] = match[0];\r\n            });\r\n            letsRef.current[key] = new Let(key, currentLet, letsRef.current, indices);\r\n        });\r\n\r\n        // Init the theory lemmas\r\n        theoryLemmas.forEach((tl, id) => {\r\n            const indices: { [key: number]: string } = {};\r\n            // Finds all occurences of let in the currentTL\r\n            [...tl.matchAll(/let\\d+/g)].forEach((match) => {\r\n                if (match.index) indices[match.index] = match[0];\r\n            });\r\n\r\n            letsRef.current[id] = new Let(String(id), tl, letsRef.current, indices);\r\n        });\r\n\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        handleResize();\r\n    }, [shouldResize]);\r\n\r\n    const expandLet = (parent: number, key: string, letIdx: number) => {\r\n        const lets = letsRef.current;\r\n        const externalRef = lets[key];\r\n        lets[parent].isExpanded = true;\r\n        theoryLemmas[parent] = lets[parent].expandPartialy(externalRef, letIdx);\r\n        setTheoryLemmas([...theoryLemmas]);\r\n    };\r\n\r\n    const expandAll = (key: number) => {\r\n        const thisLet = letsRef.current[key];\r\n        thisLet.isExpanded = true;\r\n        theoryLemmas[key] = thisLet.expandValue(true);\r\n        setTheoryLemmas([...theoryLemmas]);\r\n    };\r\n\r\n    const revertLet = (key: number) => {\r\n        const thisLet = letsRef.current[key];\r\n        // Only when is expanded\r\n        if (thisLet.isExpanded) {\r\n            thisLet.isExpanded = false;\r\n            theoryLemmas[key] = thisLet.shrinkValue();\r\n            setTheoryLemmas([...theoryLemmas]);\r\n        }\r\n    };\r\n\r\n    const renderLet = (key: number): JSX.Element => {\r\n        const lets = letsRef.current;\r\n        const width = widthRef.current;\r\n\r\n        // Waits for the width to be updated and the DOM element to be updated\r\n        if (width) {\r\n            let currentTL = theoryLemmas[key];\r\n            const thisLet = lets[key];\r\n\r\n            // If doesn't fits, then indent\r\n            if (!thisLet.fitsTheWindow(width, font)) {\r\n                currentTL = thisLet.indent(width, true, font);\r\n                theoryLemmas[key] = currentTL;\r\n            }\r\n            // If fits, then only in the momment the page size is growing and the line is broken\r\n            else if (resizeMode >= 0 && thisLet.lines.length > 1) {\r\n                // Reset the line\r\n                thisLet.lines = [{ value: thisLet.isExpanded ? thisLet.groupUp() : thisLet.value, indentLevel: 0 }];\r\n                thisLet.biggerID = 0;\r\n\r\n                // Indent it again\r\n                currentTL = thisLet.indent(width, false, font);\r\n                theoryLemmas[key] = currentTL;\r\n            }\r\n\r\n            // Finds all occurences of let in the currentTL\r\n            const indices: { [key: number]: string } = {};\r\n            [...currentTL.matchAll(/let\\d+/g)].forEach((match) => {\r\n                if (match.index) indices[match.index] = match[0];\r\n            });\r\n\r\n            const arr: (JSX.Element | string)[] = [];\r\n            let start = 0;\r\n            // Slice the currentTL into an array with strings and JSX elements\r\n            Object.keys(indices).forEach((index, i, self) => {\r\n                const idx = Number(index);\r\n                const thisLet = indices[idx];\r\n\r\n                // Add the elements to the arr\r\n                arr.push(currentTL.substring(start, idx));\r\n                arr.push(\r\n                    <a\r\n                        className={darkTheme ? 'let-literal-or' : 'let-literal'}\r\n                        onClick={() => {\r\n                            expandLet(key, thisLet, idx);\r\n                        }}\r\n                    >\r\n                        {thisLet}\r\n                    </a>,\r\n                );\r\n                // Defines a new start\r\n                start = idx + thisLet.length;\r\n\r\n                // If it's the last let\r\n                if (i === self.length - 1) {\r\n                    arr.push(currentTL.substring(start, currentTL.length));\r\n                }\r\n            });\r\n\r\n            // If there is a let in this current let\r\n            if (Object.keys(indices).length) {\r\n                return <span className=\"let-instance\">{arr}</span>;\r\n            } else {\r\n                return <span className=\"let-instance\">{currentTL}</span>;\r\n            }\r\n        }\r\n        return <></>;\r\n    };\r\n\r\n    return (\r\n        <div className={Classes.DIALOG_BODY}>\r\n            <table\r\n                id=\"table-node-info-2\"\r\n                className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\r\n                style={{ width: '100%', minWidth: '230px' }}\r\n            >\r\n                <thead>\r\n                    <tr>\r\n                        <th className=\"theoryLemma-value-column\">Value</th>\r\n                        <th style={{ width: '100px' }}>Action</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {theoryLemmas.map((tl, id) => {\r\n                        return (\r\n                            <tr key={id}>\r\n                                <td style={{ width: '100%', whiteSpace: 'pre-wrap' }}>{renderLet(id)}</td>\r\n                                <td style={{ width: '100px', height: '100%' }}>\r\n                                    <Button\r\n                                        onClick={() => expandAll(id)}\r\n                                        className=\"bp3-minimal\"\r\n                                        icon=\"translate\"\r\n                                        text=\"Expand\"\r\n                                    />\r\n                                    <Button\r\n                                        onClick={() => revertLet(id)}\r\n                                        className=\"bp3-minimal\"\r\n                                        icon=\"undo\"\r\n                                        text=\"Revert\"\r\n                                    />\r\n                                </td>\r\n                            </tr>\r\n                        );\r\n                    })}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VisualizerTheoryLemma;\r\n","import React, { useState } from 'react';\r\n\r\nimport '../../scss/VisualizersDrawer.scss';\r\nimport { Drawer, Position, Classes, Tabs, Tab, TabId, Button } from '@blueprintjs/core';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { DrawerProps } from '../../interfaces/interfaces';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../../store/hooks';\r\nimport { applyView, selectNodeClusters, selectNodes } from '../../store/features/proof/proofSlice';\r\nimport { reRender } from '../../store/features/externalCmd/externalCmd';\r\nimport VisualizerLetDrawer from '../VisualizerLetDrawer/VisualizerLetDrawer';\r\nimport VisualizerTheoryLemma from '../VisualizerTheoryLemma/VisualizerTheoryLemma';\r\nimport { ClusterKind } from '../../interfaces/enum';\r\n\r\nconst VisualizersDrawer: React.FC<DrawerProps> = ({ drawerIsOpen, setDrawerIsOpen }: DrawerProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const nodeClusters = useAppSelector(selectNodeClusters);\r\n    const dispatch = useAppDispatch();\r\n\r\n    const [tabID, setTabID] = useState('lm');\r\n    const [resizeFlag, setResizeFlag] = useState([false, false]);\r\n\r\n    const handleTabChange = (newTabId: string, _: any, e: any): void => {\r\n        setTabID(newTabId);\r\n        const newResizeFlag = [...resizeFlag];\r\n        if (newTabId === 'lm') newResizeFlag[0] = !newResizeFlag[0];\r\n        else if (newTabId === 'tl') newResizeFlag[1] = !newResizeFlag[1];\r\n        setResizeFlag(newResizeFlag);\r\n    };\r\n\r\n    const handleClusterClick = (type: ClusterKind): void => {\r\n        if (type === ClusterKind.NONE) {\r\n            dispatch(selectNodes(nodeClusters.reduce((acc: number[], c) => acc.concat(c.hiddenNodes), [])));\r\n        } else {\r\n            dispatch(\r\n                selectNodes(\r\n                    nodeClusters.reduce((acc: number[], c) => (c.type === type ? acc.concat(c.hiddenNodes) : acc), []),\r\n                ),\r\n            );\r\n        }\r\n    };\r\n\r\n    const menus = {\r\n        view: (\r\n            <div className={'view-infos ' + Classes.DIALOG_BODY}>\r\n                <div className=\"bts\">\r\n                    <Button\r\n                        text=\"Full\"\r\n                        onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                            e.preventDefault();\r\n                            dispatch(applyView('full'));\r\n                            dispatch(reRender());\r\n                        }}\r\n                    />\r\n                    <Button\r\n                        text=\"Clustered\"\r\n                        onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                            e.preventDefault();\r\n                            dispatch(applyView('clustered'));\r\n                            dispatch(reRender());\r\n                        }}\r\n                    />\r\n                    <Button\r\n                        text=\"Full and Colored\"\r\n                        onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                            e.preventDefault();\r\n                            dispatch(applyView('colored-full'));\r\n                            dispatch(reRender());\r\n                        }}\r\n                    />\r\n                </div>\r\n                <div className=\"views-color-map\">\r\n                    <span onClick={() => handleClusterClick(ClusterKind.NONE)}> First Scope</span>\r\n                    <span onClick={() => handleClusterClick(ClusterKind.SAT)}> SAT</span>\r\n                    <span onClick={() => handleClusterClick(ClusterKind.CNF)}> CNF</span>\r\n                    <span onClick={() => handleClusterClick(ClusterKind.TL)}> Theory Lemma</span>\r\n                    <span onClick={() => handleClusterClick(ClusterKind.PP)}> Pre Processing</span>\r\n                    <span onClick={() => handleClusterClick(ClusterKind.IN)}> Input</span>\r\n                </div>\r\n            </div>\r\n        ),\r\n        letMap: <VisualizerLetDrawer shouldResize={resizeFlag[0]} />,\r\n        theoryLemma: <VisualizerTheoryLemma shouldResize={resizeFlag[1]} />,\r\n    };\r\n\r\n    return (\r\n        <Drawer\r\n            className={darkTheme ? 'bp3-dark' : ''}\r\n            style={{ maxHeight: '65%', width: '35%' }}\r\n            autoFocus={true}\r\n            canEscapeKeyClose={true}\r\n            canOutsideClickClose={false}\r\n            enforceFocus={false}\r\n            hasBackdrop={false}\r\n            isOpen={drawerIsOpen}\r\n            position={Position.RIGHT}\r\n            usePortal={false}\r\n            onClose={(e) => {\r\n                e.preventDefault();\r\n                setDrawerIsOpen(false);\r\n            }}\r\n            icon=\"applications\"\r\n            title=\"Visualizers\"\r\n        >\r\n            <div className={Classes.DRAWER_BODY}>\r\n                <Tabs id=\"services-tabs\" onChange={handleTabChange} selectedTabId={tabID}>\r\n                    <Tab id=\"vw\" title=\"View\" panel={menus['view']} className=\"services-tab\" />\r\n                    <Tab id=\"lm\" title=\"Let Map\" panel={menus['letMap']} className=\"services-tab\" />\r\n                    <Tab id=\"tl\" title=\"Theory Lemma\" panel={menus['theoryLemma']} className=\"services-tab\" />\r\n                </Tabs>\r\n            </div>\r\n        </Drawer>\r\n    );\r\n};\r\n\r\nexport default VisualizersDrawer;\r\n","import { Button, Divider, Icon } from '@blueprintjs/core';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { TutorialPopoverProps } from '../../interfaces/interfaces';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { useAppSelector } from '../../store/hooks';\r\n\r\nconst TutorialPopover: React.FC<TutorialPopoverProps> = ({\r\n    setIsOpen,\r\n    nextTutorial,\r\n    content,\r\n    W,\r\n    position,\r\n}: TutorialPopoverProps) => {\r\n    const [page, setPage] = useState(0);\r\n\r\n    const darkTheme = useAppSelector(selectTheme);\r\n\r\n    const renderPageBall = (): JSX.Element[] => {\r\n        return content.map((_, id) => (\r\n            <div key={id} className={`page-ball ${id === page && (darkTheme ? 'page-on' : 'page-on-light')}`} />\r\n        ));\r\n    };\r\n\r\n    const changePage = (type: string): void => {\r\n        if (type === '>') setPage(page + 1);\r\n        else setPage(page - 1);\r\n    };\r\n\r\n    useEffect(() => {\r\n        function handleEsc(e: KeyboardEvent): void {\r\n            e.stopPropagation();\r\n            if (e.key === 'Escape') {\r\n                setIsOpen(false);\r\n            }\r\n        }\r\n        window.addEventListener('keydown', handleEsc, false);\r\n\r\n        return () => {\r\n            window.removeEventListener('keydown', handleEsc, false);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div className={darkTheme ? 'bp3-dark' : ''}>\r\n            <div\r\n                className=\"arrow-up\"\r\n                style={{\r\n                    left: position.tW,\r\n                    top: position.y - 7,\r\n                    borderBottomColor: darkTheme ? 'rgb(30, 38, 44)' : 'rgb(255,255,255)',\r\n                }}\r\n            />\r\n            <div className=\"tutorial-popover bp3-dialog\" style={{ width: W, left: position.x, top: position.y }}>\r\n                <div className=\"bp3-dialog-header\">\r\n                    <div className=\"cur-page\">{renderPageBall()}</div>\r\n                    <Icon icon=\"small-cross\" size={20} onClick={() => setIsOpen(false)} />\r\n                </div>\r\n                <body>\r\n                    {page > 0 && (\r\n                        <div\r\n                            className=\"next-page regress\"\r\n                            onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                changePage('<');\r\n                            }}\r\n                        >\r\n                            {'<'}\r\n                        </div>\r\n                    )}\r\n                    <p className=\"content\">{content[page]}</p>\r\n                    {page < content.length - 1 && (\r\n                        <div\r\n                            className=\"next-page progress\"\r\n                            onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                changePage('>');\r\n                            }}\r\n                        >\r\n                            {'>'}\r\n                        </div>\r\n                    )}\r\n                </body>\r\n                {page === content.length - 1 && (\r\n                    <>\r\n                        <Divider style={{ backgroundColor: darkTheme ? 'white' : '' }} />\r\n                        <div className=\"bp3-dialog-footer\">\r\n                            <Button\r\n                                text=\"Next\"\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    nextTutorial();\r\n                                    setPage(0);\r\n                                }}\r\n                            />\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TutorialPopover;\r\n","import { Portal } from '@blueprintjs/core';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { TutorialProps } from '../../interfaces/interfaces';\r\nimport '../../scss/Tutorial.scss';\r\nimport TutorialPopover from './TutorialPopover';\r\n\r\nconst W = 180;\r\nconst divsIds = [\r\n    'proof-visualizer-name',\r\n    'upload-proof-bt',\r\n    'examples-bt',\r\n    'file-name-title',\r\n    'command',\r\n    'style-bt',\r\n    'visualizers-bt',\r\n    'download-bt',\r\n    'switch-button-dark-theme',\r\n];\r\nconst tutorials: string[][] = [\r\n    [\"This website is a SMT solver proofs visualizer. Let's start the tutorial\"],\r\n    [\r\n        'Here you can upload your proofs to be visualized.',\r\n        'The proofs can have a .dot or .json format.',\r\n        'The .json format is obtained in the download section.',\r\n    ],\r\n    ['Here you can visualize some examples of differents proofs.'],\r\n    ['This is the name of the current proof uploaded'],\r\n    [\r\n        'This is the command section. Here you can apply some commands that will transform the proof, changing the way you comprehend it.',\r\n        \"Click in the '?' button to see a description of all commands.\",\r\n    ],\r\n    [\r\n        'Here you can change the way the visualizer presents the proof.',\r\n        \"The graph style is the default and it's where the commands transformations happens.\",\r\n        \"In the directory style each proof node is a 'folder' and your children nodes are inside it.\",\r\n    ],\r\n    [\r\n        'Here you have access to 3 visualizers:',\r\n        'View: It allow you to change the way the proof nodes are viewed.',\r\n        'Let Map: Here you can see a map of all the LETS used inside the proofs. A let is a therm that shorten some expression (e.g.: let1 = (and A B))',\r\n        'Theory Lemma: It allow you to see all the theory lemmas in the proof construction.',\r\n    ],\r\n    [\r\n        'This section allow you to download the proof in different ways.',\r\n        '.DOT is the default format. It only holds informations about the proof structure and your clusters.',\r\n        '.JSON allow the user to save all the visual informations about the proof (i.e. the nodes positions, colors and foldings after any transformation applied) and your structural infos just like the .DOT.',\r\n        '.PNG prints the proof in the current state (i.e. includes all the transformations) into a image.',\r\n    ],\r\n    ['Allow to change between dark/light mode.'],\r\n];\r\n\r\n// panel stack\r\nconst VisualizerTutorial: React.FC<TutorialProps> = ({ inTutorial, setInTutorial }: TutorialProps) => {\r\n    const [stage, setStage] = useState(-1);\r\n    const [position, setPosition] = useState({ x: 0, y: 0, tW: 0 });\r\n    const sizeRef = useRef({ w: 0, h: 0 });\r\n\r\n    const increaseStage = () => {\r\n        if (stage < tutorials.length - 1) setStage(stage + 1);\r\n        else setInTutorial(false);\r\n    };\r\n\r\n    // ComponentDidMount\r\n    useEffect(() => {\r\n        // Handler to call on window resize and set the value column width\r\n        function handleResize() {\r\n            sizeRef.current.w = window.innerWidth;\r\n            sizeRef.current.h = window.innerHeight;\r\n        }\r\n\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (inTutorial) setStage(0);\r\n        else setStage(-1);\r\n    }, [inTutorial]);\r\n\r\n    useEffect(() => {\r\n        const toBeWrapped: HTMLElement | null = document.getElementById(divsIds[stage]);\r\n        if (toBeWrapped) {\r\n            const { x, y, width, height } = toBeWrapped.getClientRects()[0];\r\n            const newY = y + height;\r\n            let newX = x + width / 2;\r\n            const newTW = newX;\r\n            // Positioning in the beggining\r\n            if (newX < W) newX = 3;\r\n            // Positioning in the end\r\n            else if (newX + W / 2 > sizeRef.current.w) newX = sizeRef.current.w - W - 3;\r\n            // Positioning in the normal position\r\n            else newX -= W / 2;\r\n\r\n            setPosition({ x: newX, y: newY, tW: newTW });\r\n        }\r\n    }, [stage]);\r\n\r\n    return (\r\n        <Portal className={`tutorial-portal`}>\r\n            <div\r\n                className=\"bp3-overlay-enter-done\"\r\n                style={{\r\n                    width: sizeRef.current.w,\r\n                    height: sizeRef.current.h,\r\n                    pointerEvents: stage >= 0 ? 'auto' : 'none',\r\n                    backgroundColor: stage >= 0 ? 'rgba(87, 82, 82, 0.233)' : 'transparent',\r\n                }}\r\n            >\r\n                {stage >= 0 && (\r\n                    <TutorialPopover\r\n                        setIsOpen={setInTutorial}\r\n                        nextTutorial={increaseStage}\r\n                        content={tutorials[stage]}\r\n                        W={W}\r\n                        position={position}\r\n                    />\r\n                )}\r\n            </div>\r\n        </Portal>\r\n        // bp3-overlay-backdrop\r\n    );\r\n};\r\n\r\nexport default VisualizerTutorial;\r\n","import React, { useEffect, useReducer, useState } from 'react';\r\n\r\nimport { Intent, Position, Toaster } from '@blueprintjs/core';\r\n\r\nimport VisualizerNavbar from '../VisualizerNavbar/VisualizerNavbar';\r\nimport VisualizerDialog from '../VisualizerDialog/VisualizerDialog';\r\nimport VisualizerStage from '../VisualizerStage/VisualizerStage';\r\nimport VisualizersDrawer from '../VisualizersDrawer/VisualizersDrawer';\r\n\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport VisualizerTutorial from '../VisualizerTutorial/VisualizerTutorial';\r\n\r\nconst App: React.FC = () => {\r\n    const [dialogIsOpen, setDialogIsOpen] = useState(true);\r\n    const [inTutorial, setInTutorial] = useState(false);\r\n    const [drawerIsOpen, setDrawerOpenState] = useReducer((isOpen) => !isOpen, false);\r\n    const darkTheme = useAppSelector(selectTheme);\r\n\r\n    // Toaster\r\n    let toaster: Toaster;\r\n    const refHandlers = {\r\n        toaster: (ref: Toaster) => (toaster = ref),\r\n    };\r\n\r\n    const addErrorToast = (err: string) => {\r\n        toaster.show({ icon: 'warning-sign', intent: Intent.DANGER, message: err });\r\n    };\r\n\r\n    useEffect(() => {\r\n        document.getElementsByClassName('bp3-overlay')[0]\r\n            ? (document.getElementsByClassName('bp3-overlay')[0].className = '')\r\n            : null;\r\n    }, [drawerIsOpen]);\r\n\r\n    return (\r\n        <div className={darkTheme ? ' bp3-dark' : ''} style={{ height: '100%' }}>\r\n            <VisualizerTutorial inTutorial={inTutorial} setInTutorial={setInTutorial} />\r\n            <Toaster position={Position.TOP} ref={refHandlers.toaster} />\r\n            <VisualizerNavbar\r\n                setDialogIsOpen={setDialogIsOpen}\r\n                setDrawerIsOpen={setDrawerOpenState}\r\n                addErrorToast={addErrorToast}\r\n                inTutorial={inTutorial}\r\n                setInTutorial={setInTutorial}\r\n            ></VisualizerNavbar>\r\n            <VisualizerDialog\r\n                dialogIsOpen={dialogIsOpen}\r\n                setDialogIsOpen={setDialogIsOpen}\r\n                addErrorToast={addErrorToast}\r\n            ></VisualizerDialog>\r\n            <VisualizerStage></VisualizerStage>\r\n            {drawerIsOpen ? (\r\n                <VisualizersDrawer drawerIsOpen={drawerIsOpen} setDrawerIsOpen={setDrawerOpenState}></VisualizersDrawer>\r\n            ) : null}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default App;\r\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\r\nimport externalCmdReducer from './features/externalCmd/externalCmd';\r\nimport fileReducer from './features/file/fileSlice';\r\nimport proofReducer from './features/proof/proofSlice';\r\nimport themeReducer from './features/theme/themeSlice';\r\n\r\nexport const store = configureStore({\r\n    reducer: {\r\n        file: fileReducer,\r\n        proof: proofReducer,\r\n        theme: themeReducer,\r\n        externalCmd: externalCmdReducer,\r\n    },\r\n});\r\n\r\nexport type AppDispatch = typeof store.dispatch;\r\nexport type RootState = ReturnType<typeof store.getState>;\r\nexport type AppThunk<ReturnType = void> = ThunkAction<ReturnType, RootState, unknown, Action<string>>;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler): void => {\r\n    if (onPerfEntry && onPerfEntry instanceof Function) {\r\n        import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n            getCLS(onPerfEntry);\r\n            getFID(onPerfEntry);\r\n            getFCP(onPerfEntry);\r\n            getLCP(onPerfEntry);\r\n            getTTFB(onPerfEntry);\r\n        });\r\n    }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './components/App/App';\r\nimport { store } from './store/store';\r\nimport { Provider } from 'react-redux';\r\n\r\nimport './scss/index.scss';\r\n\r\nimport reportWebVitals from './ReactUtils/reportWebVitals';\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <Provider store={store}>\r\n            <App />\r\n        </Provider>\r\n    </React.StrictMode>,\r\n    document.getElementById('root'),\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}