{"version":3,"sources":["store/hooks.ts","store/features/file/fileSlice.ts","store/features/proof/auxi.ts","store/features/theme/auxi.ts","store/features/proof/proofSlice.ts","store/features/theme/themeSlice.ts","store/features/externalCmd/externalCmd.ts","components/VisualizerNavbar/VisualizerNavbar.tsx","components/VisualizerDialog/VisualizerDialog.tsx","components/VisualizerStage/Canvas/VisualizerNode.tsx","components/VisualizerStage/Canvas/VisualizerLine.tsx","components/VisualizerStage/Canvas/VisualizerMenu.tsx","components/VisualizerStage/Canvas/VisualizerCanvas.tsx","interfaces/enum.ts","components/VisualizerTree/VisualizerTree.tsx","components/VisualizerStage/VisualizerDirectoryStyle/VisualizerDirectoryStyle.tsx","components/VisualizerLetDrawer/let.ts","components/VisualizerLetDrawer/LetRender.tsx","components/VisualizerStage/VisualizerStage.tsx","components/VisualizerLetDrawer/VisualizerLetDrawer.tsx","components/App/App.tsx","store/store.ts","ReactUtils/reportWebVitals.ts","index.tsx"],"names":["useAppDispatch","useDispatch","useAppSelector","useSelector","fileSlice","createSlice","name","initialState","value","filesCount","reducers","set","state","action","payload","actions","selectFileName","file","selectDot","split","pop","JSON","parse","dot","selectFileCount","removeEscapedCharacters","s","newS","i","length","descendants","proof","nodeId","children","concat","reduce","acc","childId","colorConverter","colorName","color","proofSlice","view","style","hiddenNodes","letMap","visualInfo","clustersInfos","process","proofJSON","isJSON","indexOf","nodes","id","conclusion","rule","args","views","parents","NaN","dependencies","comment","slice","lastIndexOf","replace","forEach","line","search","label","idx","numbers","substring","trim","map","num","Number","push","parseInt","attributes","commentJSON","subProofQty","x","child","parent","isNaN","processDot","cluster","node","y","selected","size","Object","keys","hideNodes","toHideNodes","filter","every","hiddenNodesArray","clusters","clusteredNodes","hiddenNode","clusterID","p","hiddenID","some","_p","pastCluster","stringify","clusterParents","parentCluster","splice","findNodesClusters","piNodeId","foldAllDescendants","index","self","unhideNodes","pi","hiddens","setVisualInfo","selectNodes","len","unselectNodes","changeStyle","applyView","visualInfoSize","proofSize","proofNode","applyColor","selectProof","piNodeChildren","haveHiddenParent","n","piNodeParents","piNodeDependencies","depMap","dep","String","piId","depsId","groupPiNodeDependencies","piNode","parentId","c","highHierarchyNodes","ac","childID","selectOriginalProof","selectView","selectStyle","selectLetMap","selectVisualInfo","selectHiddenNodes","themeSlice","toggle","selectTheme","theme","externalCmd","findData","nodeToFind","findOption","renderData","count","fileChanged","findNode","option","reRender","addRenderCount","blockRender","allowRenderNewFile","blockRenderNewFile","selectFindData","selectRenderData","mapDispatchToProps","connect","ownProps","setDialogIsOpen","setDialogContent","setDrawerIsOpen","addErrorToast","fileName","darkTheme","windowSize","useState","width","height","setWindowSize","useEffect","handleResize","window","innerWidth","innerHeight","addEventListener","removeEventListener","useWindowSize","command","setCommand","lastCommands","setLastCommands","commandId","setCommandId","dispatch","runCommands","hiddenIds","commands","cmdArg","string","matches","matchAll","idList","insideBracket","insideMatches","rangeLim","numS","Array","from","_","listStr","match","word","argMatch","argIsConclusion","regexString","regex","RegExp","test","err","allNodesIds","obj","find","menus","icon","text","onClick","e","preventDefault","download","downloadJSON","fName","link","document","createElement","href","encodeURIComponent","click","replaceAll","getElementsByClassName","toDataURL","help","className","Group","align","Alignment","LEFT","Heading","Divider","content","RIGHT","placeholder","onChange","target","onKeyDown","key","unshift","newId","rightElement","placement","autoComplete","marginLeft","undefined","disabled","checked","readUploadedFileAsText","inputFile","temporaryFileReader","FileReader","Promise","resolve","reject","onerror","abort","DOMException","onload","result","readAsText","VisualizerDialog","dialogIsOpen","dialogContent","dialogProps","title","dialogBody","succesButton","changeFileName","changeFile","useReducer","newFlag","focusFlag","flagCount","setFocusFlag","Classes","DIALOG_BODY","childNodes","focus","DIALOG_FOOTER_ACTIONS","closeDialog","hasSelection","onInputChange","a","files","File","fileContents","message","fill","ext","intent","Intent","SUCCESS","isOpen","onClose","usePortal","DIALOG_FOOTER","textColorFromBg","bgColor","sixDigitColor","charAt","join","Node","props","nHided","nDescendants","setNodeOnFocus","toggleNodeSelection","updateNodePosition","openDrawer","onDragEnd","createTree","tag","stroke","strokeWidth","this","fontSize","padding","depSize","infos","idSize","setIdSize","descendantSize","setDescendantSize","font","calc","context","getContext","measureText","getTextWidth","toString","draggable","onDragMove","attrs","evt","button","shiftKey","menuNode","getElementById","top","clientY","left","clientX","display","points","depLineSize","radius","depText","Line","Menu","unfold","foldSelectedNodes","changeNodeColor","currentColor","options","setColor","foldSelected","stopPropagation","vertical","handleWheel","stage","getStage","oldScale","scaleX","pointerPosition","getPointerPosition","mousePointTo","newScale","deltaY","stageScale","stageX","stageY","Canvas","nodeOnFocus","setState","nodesSelected","showingNodes","LineProps","to","saveNodePosition","copyNodePosition","showingEdges","edgeKey","edge","componentDidUpdate","bind","canvasSize","newShowingNodes","newNodeProps","updateEdgesAndFuncs","prevProps","found","o","Boolean","includes","onWheel","scaleY","onContextMenu","current_state","proofChanged","visualInfoChanged","nodeFindData","nodeWidth","nodeHeight","g","dagre","graphlib","Graph","setGraph","rankdir","ranker","setDefaultEdgeLabel","setNode","setEdge","layout","xOffset","yOffset","v","console","log","Component","newVisualInfo","visualInfos","drawerHelpersKind","renderLetKind","VisualizerTree","originalNodeInfo","setNodeInfo","forceUpdate","setNodes","setSelected","forEachNode","callback","backgroundColor","contents","onNodeClick","nodeData","_nodePath","originallySelected","isSelected","onNodeCollapse","isExpanded","onNodeExpand","ELEVATION_0","VisualizerDirectoryStyle","proofTree","ruleHelper","indent","translate","nodeInfo","type","ALL","ruleHelperIsOpen","argsHelperIsOpen","concHelperIsOpen","dispatchHelper","offsetHeight","float","clear","borderRight","overflow","RULE","maxHeight","ARGS","CONC","dependency","Let","letText","letsList","indices","lines","biggerID","externalLets","expandValue","shouldUpdate","keyList","let","letName","k","indentLevel","expandPartialy","externalRef","letIdx","indentedText","printLines","lastLine","newIdx","shrinkValue","fitsTheWindow","repeat","mode","someDoesntFit","newLines","thisLevel","thisLine","lastSpace","lastUsedSpace","lastOpenParenthesis","biggestSize","newBiggerID","thisSize","groupUp","original","numKey","LetRender","toRender","shouldExpand","shouldRevert","dispatchExpansion","widthRef","useRef","resizeMode","setResizeMode","newMap","letMapS","setLetMapS","letsRef","initializeLet","lets","currentLet","indice","current","newWidth","clientWidth","expandAll","EXPAND","revertLet","REVERT","margin","whiteSpace","arr","start","thisLet","expandLet","overflowWrap","renderLet","castProofNodeToTreeNode","secondaryLabel","parentsId","hasCaret","rootNode","tree","roots","currentNode","stack","childrenStack","insertedStack","lastNode","lastChild","nextNode","VisualizerStage","fileID","setProofTree","setOriginalNodeInfo","revertAll","dispatchLetExpansion","drawerIsOpen","setTree","autoFocus","canEscapeKeyClose","canOutsideClickClose","enforceFocus","hasBackdrop","position","Position","BOTTOM","DRAWER_BODY","VisualizerLetDrawer","App","toaster","setDrawerOpenState","refHandlers","ref","show","DANGER","TOP","store","configureStore","reducer","fileReducer","proofReducer","themeReducer","externalCmdReducer","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.5f6a8a06.chunk.js","sourcesContent":["import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\r\nimport type { RootState, AppDispatch } from './store';\r\n\r\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { RootState } from '../../store';\r\nimport { FileState } from '../../../interfaces/interfaces';\r\n\r\nconst initialState: FileState = {\r\n    name: 'ex.smt2',\r\n    value: 'digraph proof {\\n\\trankdir=\"BT\";\\n\\tnode [shape=record];\\n\\t0 [label=\"{SCOPE((not a), a)|(not (and (not a) a))}\", class = \" basic \", comment = \"{\\'subProofQty\\':1}\" ];\\n\\t1 [label=\"{CHAIN_RESOLUTION(true, a)|false}\", class = \" propositional \", comment = \"{\\'subProofQty\\':2}\" ];\\n\\t2 [label=\"{ASSUME(a)|a}\", comment = \"{\\'subProofQty\\':0}\"];\\n\\t3 [label=\"{ASSUME((not a))|(not a)}\", comment = \"{\\'subProofQty\\':0}\"];\\n\\t1->0;\\n\\t2->1;\\n\\t3->1;\\n}',\r\n    filesCount: 0,\r\n};\r\n\r\nexport const fileSlice = createSlice({\r\n    name: 'file',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        set: (state, action: PayloadAction<{ name: string; value: string }>) => {\r\n            state.name = action.payload.name;\r\n            state.value = action.payload.value;\r\n            state.filesCount++;\r\n        },\r\n    },\r\n});\r\n\r\nexport const { set } = fileSlice.actions;\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice file. For example: `useSelector((state: RootState) => state.counter.value)`\r\nexport const selectFileName = (state: RootState): string => state.file.name;\r\n\r\nexport const selectFileExtension = (state: RootState): string => {\r\n    const ext = state.file.name.split('.').pop();\r\n    return ext ? ext : '';\r\n};\r\n\r\nexport const selectDot = (state: RootState): string =>\r\n    state.file.name.split('.').pop() === 'json' ? JSON.parse(state.file.value).dot : state.file.value;\r\n\r\nexport const selectFile = (state: RootState): string => state.file.value;\r\n\r\nexport const selectFileCount = (state: RootState): number => state.file.filesCount;\r\n\r\nexport default fileSlice.reducer;\r\n","import { NodeInterface, ProofState } from '../../../interfaces/interfaces';\r\n\r\nfunction removeEscapedCharacters(s: string): string {\r\n    let newS = '';\r\n    for (let i = 0; i < s.length; i += 1) {\r\n        if (\r\n            !(\r\n                s[i] === '\\\\' &&\r\n                (s[i + 1] === '\"' ||\r\n                    s[i + 1] === '>' ||\r\n                    s[i + 1] === '<' ||\r\n                    s[i + 1] === '{' ||\r\n                    s[i + 1] === '}' ||\r\n                    s[i + 1] === '|')\r\n            )\r\n        ) {\r\n            newS += s[i];\r\n        }\r\n    }\r\n\r\n    return newS;\r\n}\r\n\r\nexport function processDot(dot: string): [NodeInterface[], ProofState['letMap'], ProofState['clustersInfos']] {\r\n    const nodes: NodeInterface[] = [\r\n        {\r\n            id: 0,\r\n            conclusion: '',\r\n            rule: '',\r\n            args: '',\r\n            views: [],\r\n            children: [],\r\n            parents: [NaN],\r\n            descendants: 0,\r\n            dependencies: [],\r\n        },\r\n    ];\r\n    let comment: string | null = dot.slice(dot.indexOf('comment='));\r\n    comment = comment\r\n        ? removeEscapedCharacters(\r\n              removeEscapedCharacters(comment.slice(comment.indexOf('=') + 2, comment.indexOf(';') - 1)),\r\n          )\r\n        : null;\r\n\r\n    const clustersInfos: ProofState['clustersInfos'] = [];\r\n    const lines = dot\r\n        .slice(dot.indexOf('{') + 1, dot.lastIndexOf('}') - 2)\r\n        .replace(/(\\n|\\t)/gm, '')\r\n        .split(';');\r\n    lines.forEach((line) => {\r\n        if (line.search('subgraph') !== -1) {\r\n            // Get the label of this node subgraph\r\n            let label = '';\r\n            let idx = line.indexOf('label=\"') + 7;\r\n            while (line[idx] !== '\"') {\r\n                label += line[idx];\r\n                idx++;\r\n            }\r\n\r\n            // Get the label of this node subgraph\r\n            let color = '';\r\n            idx = line.indexOf('bgcolor=\"') + 9;\r\n            while (line[idx] !== '\"') {\r\n                color += line[idx];\r\n                idx++;\r\n            }\r\n\r\n            // Get the nodes ID's\r\n            const numbers = line\r\n                .substring(idx + 1, line.length - 1)\r\n                .trim()\r\n                .split(' ')\r\n                .map((num) => Number(num));\r\n            clustersInfos.push({ hiddenNodes: numbers, label: label, color: color });\r\n        } else if (line.search('label') !== -1) {\r\n            const id = parseInt(line.slice(0, line.indexOf('[')).trim());\r\n            let attributes = line.slice(line.indexOf('[') + 1, line.lastIndexOf(']')).trim();\r\n\r\n            let label = attributes.slice(attributes.search(/(?<!\\\\)\"/) + 2);\r\n            label = label.slice(0, label.search(/(?<!\\\\)\"/) - 1);\r\n            let [conclusion, rule, args] = ['', '', ''];\r\n            [conclusion, rule] = label.split(/(?<!\\\\)\\|/);\r\n            [rule, args] = rule.indexOf(':args') != -1 ? rule.split(':args') : [rule, ''];\r\n\r\n            attributes = attributes.slice(attributes.indexOf(', class = ') + ', class = '.length);\r\n            attributes = attributes.slice(attributes.indexOf('\"') + 1, attributes.slice(1).indexOf('\"') + 1);\r\n            const views = attributes.trim().split(' ');\r\n            const comment: string = removeEscapedCharacters(line.slice(line.indexOf('comment'), line.lastIndexOf('\"')));\r\n            const commentJSON = JSON.parse(comment.slice(comment.indexOf('\"') + 1).replace(/'/g, '\"'));\r\n\r\n            if (!nodes[id]) {\r\n                nodes[id] = {\r\n                    id: id,\r\n                    conclusion: '',\r\n                    rule: '',\r\n                    args: '',\r\n                    views: [],\r\n                    children: [],\r\n                    parents: [NaN],\r\n                    descendants: 0,\r\n                    dependencies: [],\r\n                };\r\n            }\r\n            nodes[id].conclusion = removeEscapedCharacters(conclusion);\r\n            nodes[id].rule = removeEscapedCharacters(rule);\r\n            nodes[id].args = removeEscapedCharacters(args);\r\n            nodes[id].views = views;\r\n            nodes[id].descendants = commentJSON.subProofQty;\r\n        }\r\n        // TODO: Se o filho ja existe, isso aqui vai resetar os dados setados do filho\r\n        else if (line.search('->') !== -1) {\r\n            const [child, parent] = line.split('->').map((x) => parseInt(x.trim()));\r\n            nodes[parent].children.push(child);\r\n            // If there isn't a child node\r\n            if (!nodes[child]) {\r\n                nodes[child] = {\r\n                    id: child,\r\n                    conclusion: '',\r\n                    rule: '',\r\n                    args: '',\r\n                    views: [],\r\n                    children: [],\r\n                    parents: [],\r\n                    descendants: 0,\r\n                    dependencies: [],\r\n                };\r\n            }\r\n            // If there is and is an invalid parent\r\n            else if (isNaN(nodes[child].parents[0])) {\r\n                nodes[child].parents = [];\r\n            }\r\n            nodes[child].parents.push(parent);\r\n        }\r\n    });\r\n\r\n    return comment ? [nodes, JSON.parse(comment)['letMap'], clustersInfos] : [nodes, {}, clustersInfos];\r\n}\r\n\r\nexport const piNodeParents = (\r\n    proof: NodeInterface[],\r\n    hiddenNodesArray: number[],\r\n    dependencies: { [parentId: number]: number[] } = {},\r\n): number[] => {\r\n    const parents = hiddenNodesArray\r\n        // Concat all the parents\r\n        .reduce((acc: number[], hiddenNode) => {\r\n            let haveHiddenParent = false;\r\n\r\n            proof[hiddenNode].parents.forEach((parent) => {\r\n                // If this parent is a hidden node\r\n                if (hiddenNodesArray.indexOf(parent) !== -1) {\r\n                    haveHiddenParent = true;\r\n                } else {\r\n                    dependencies[parent]\r\n                        ? dependencies[parent].push(hiddenNode)\r\n                        : (dependencies[parent] = [hiddenNode]);\r\n                }\r\n            });\r\n\r\n            if (haveHiddenParent) return acc;\r\n            return acc.concat(proof[hiddenNode].parents);\r\n        }, [])\r\n        // Filter the duplicated elements\r\n        .filter((parent, i, self) => self.indexOf(parent) === i)\r\n        // Only the parents that aren't in he hidden nodes array remains\r\n        .filter((parent) => hiddenNodesArray.indexOf(parent) === -1);\r\n\r\n    // Removes the pi node parents from the dependencies\r\n    Object.keys(dependencies).forEach((parent) => {\r\n        const n = Number(parent);\r\n        if (parents.indexOf(n) !== -1) delete dependencies[n];\r\n    });\r\n\r\n    return parents;\r\n};\r\n\r\nexport const descendants = (proof: NodeInterface[], nodeId: number): number[] => {\r\n    return proof[nodeId].children.concat(\r\n        proof[nodeId].children.reduce((acc: number[], childId) => acc.concat(descendants(proof, childId)), []),\r\n    );\r\n};\r\n\r\nexport const piNodeChildren = (proof: NodeInterface[], hiddenNodesArray: number[]): number[] => {\r\n    const children = hiddenNodesArray\r\n        // Get all the childrens\r\n        .reduce((acc: number[], hiddenNode) => acc.concat(proof[hiddenNode].children), [])\r\n        // Exclude the childrens that are part of the hidden nodes\r\n        .filter((child) => hiddenNodesArray.indexOf(child) === -1);\r\n    return children;\r\n};\r\n\r\nexport const findNodesClusters = (proof: NodeInterface[], hiddenNodesArray: number[]): number[][] => {\r\n    const hiddenNodes = [...hiddenNodesArray];\r\n    const clusters: number[][] = [];\r\n    let clusteredNodes = 0;\r\n    const parents = hiddenNodes.map((hiddenNode) => proof[hiddenNode].parents);\r\n\r\n    // Cluster the nodes based on similiar parents\r\n    parents.forEach((parent, clusterID) => {\r\n        // If not all of the nodes where clustered and is a non empty cluster\r\n        if (clusteredNodes !== parents.length && parents[clusterID].length) {\r\n            clusters.push([]);\r\n            parents.forEach((p, hiddenID) => {\r\n                // If those nodes have some parent in commom and they weren't verified yet\r\n                if (parents[hiddenID].length && parent.some((_p) => p.indexOf(_p) !== -1)) {\r\n                    clusters[clusters.length - 1].push(hiddenNodes[hiddenID]);\r\n                    // Removes these parents from the array, making shure they will not get verified again (already clustered)\r\n                    parents[hiddenID] = [];\r\n                    // Increases the number o clustered nodes\r\n                    clusteredNodes++;\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    let pastCluster: number[][] = [];\r\n    // Cluster the nodes until there aren't changes being made\r\n    while (JSON.stringify(pastCluster) != JSON.stringify(clusters)) {\r\n        pastCluster = [...clusters];\r\n        clusters.forEach((cluster, clusterID) => {\r\n            const clusterParents = proof[cluster[0]].parents;\r\n\r\n            // For each cluster\r\n            clusters.forEach((parentCluster, id) => {\r\n                // If this parentCluster (cluster) is parent of the current cluster\r\n                if (parentCluster.some((hiddenID) => clusterParents.indexOf(hiddenID) !== -1)) {\r\n                    // Group the nodes couple in one single cluster (the parent cluster)\r\n                    clusters[id] = clusters[id].concat(clusters[clusterID]);\r\n                    clusters.splice(clusterID, 1);\r\n                    clusterID--;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    // Filter the nodes with length 1\r\n    return clusters.filter((cluster) => cluster.length > 1);\r\n};\r\n\r\nexport const groupPiNodeDependencies = (\r\n    proof: NodeInterface[],\r\n    hiddenNodesArray: number[],\r\n): NodeInterface['dependencies'] => {\r\n    const piNodeDependencies: NodeInterface['dependencies'] = [];\r\n    const depMap: { [piID: number]: number } = {};\r\n\r\n    // Copy all the hidden nodes dependencies to the new pi node\r\n    proof.forEach((node) => {\r\n        // Search for all the hidden nodes that have deps\r\n        if (hiddenNodesArray.indexOf(node.id) !== -1 && node.dependencies.length) {\r\n            // For each dependence in this node\r\n            node.dependencies.forEach((dep) => {\r\n                // This pi node dependence wasn't inserted yet\r\n                if (Object.keys(depMap).indexOf(String(dep.piId)) === -1) {\r\n                    piNodeDependencies.push(dep);\r\n                    depMap[dep.piId] = piNodeDependencies.length - 1;\r\n                }\r\n                // Concat the nodes inside the pi node already inserted\r\n                else {\r\n                    piNodeDependencies[depMap[dep.piId]].depsId = piNodeDependencies[depMap[dep.piId]].depsId.concat(\r\n                        dep.depsId,\r\n                    );\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return piNodeDependencies;\r\n};\r\n","export const colorConverter = (colorName: string): string => {\r\n    let color = '#fff';\r\n    switch (colorName) {\r\n        case 'red':\r\n            color = '#f72b34';\r\n            break;\r\n        case 'orange':\r\n            color = '#ff8334';\r\n            break;\r\n        case 'yellow':\r\n            color = '#ffc149';\r\n            break;\r\n        case 'green':\r\n            color = '#60aa51';\r\n            break;\r\n        case 'blue':\r\n            color = '#0097e4';\r\n            break;\r\n        case 'purple':\r\n            color = '#a73da5';\r\n            break;\r\n        case 'brown':\r\n            color = '#a95a49';\r\n            break;\r\n        case 'black':\r\n            color = '#464646';\r\n            break;\r\n\r\n        case 'white':\r\n            color = '#f0f0f0';\r\n            break;\r\n    }\r\n    return color;\r\n};\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { RootState } from '../../store';\r\nimport {\r\n    processDot,\r\n    piNodeChildren,\r\n    piNodeParents,\r\n    descendants,\r\n    findNodesClusters,\r\n    groupPiNodeDependencies,\r\n} from './auxi';\r\nimport { NodeInterface, ProofState } from '../../../interfaces/interfaces';\r\nimport { colorConverter } from '../theme/auxi';\r\n\r\nconst initialState: ProofState = {\r\n    proof: [],\r\n    view: 'full',\r\n    style: 'graph',\r\n    hiddenNodes: [],\r\n    letMap: {},\r\n    visualInfo: [],\r\n    clustersInfos: [],\r\n};\r\n\r\nexport const proofSlice = createSlice({\r\n    name: 'proof',\r\n    initialState,\r\n\r\n    reducers: {\r\n        process: (state, action: PayloadAction<string>) => {\r\n            let proofJSON;\r\n            let dot = action.payload;\r\n            let isJSON = false;\r\n\r\n            // If the payload is a .json file\r\n            if (dot.indexOf('{\"dot\":\"') !== -1) {\r\n                proofJSON = JSON.parse(dot);\r\n                dot = proofJSON.dot;\r\n                isJSON = true;\r\n            }\r\n\r\n            const [proof, letMap, clustersInfos] = processDot(dot);\r\n            state.proof = proof;\r\n            state.letMap = letMap;\r\n            state.clustersInfos = clustersInfos;\r\n            state.view = isJSON ? proofJSON.view : 'full';\r\n            state.hiddenNodes = isJSON ? proofJSON.hiddenNodes : clustersInfos.map((cluster) => cluster.hiddenNodes);\r\n\r\n            if (isJSON) state.visualInfo = proofJSON.visualInfo;\r\n            else {\r\n                const visualInfo: ProofState['visualInfo'] = {};\r\n                state.proof.forEach((node) => {\r\n                    visualInfo[node.id] = {\r\n                        color: '#fff',\r\n                        x: 0,\r\n                        y: 0,\r\n                        selected: false,\r\n                    };\r\n                });\r\n\r\n                const size = Object.keys(visualInfo).length;\r\n                state.clustersInfos.forEach((cluster, i) => {\r\n                    visualInfo[size + i] = {\r\n                        color: colorConverter(cluster.color),\r\n                        x: 0,\r\n                        y: 0,\r\n                        selected: false,\r\n                    };\r\n                });\r\n\r\n                state.visualInfo = visualInfo;\r\n            }\r\n        },\r\n        hideNodes: (state, action: PayloadAction<number[]>) => {\r\n            const toHideNodes = action.payload.filter(\r\n                (id) =>\r\n                    id > 0 &&\r\n                    id < state.proof.length &&\r\n                    state.hiddenNodes.every((hiddenNodesArray) => hiddenNodesArray.indexOf(id) === -1),\r\n            );\r\n\r\n            const clusters = findNodesClusters(state.proof, toHideNodes);\r\n            state.hiddenNodes = state.hiddenNodes\r\n                .concat(clusters)\r\n                .filter((hiddenNodesArray) => hiddenNodesArray.length > 0);\r\n\r\n            // Set the visual info for the new pi nodes\r\n            const piNodeId = Object.keys(state.visualInfo).length;\r\n            for (let i = 0; i < clusters.length; i++) {\r\n                state.visualInfo = {\r\n                    ...state.visualInfo,\r\n                    [piNodeId + i]: {\r\n                        color: '#555',\r\n                        x: 0,\r\n                        y: 0,\r\n                        selected: false,\r\n                    },\r\n                };\r\n            }\r\n\r\n            // Unselect the selected nodes\r\n            toHideNodes.forEach(\r\n                (id) =>\r\n                    (state.visualInfo[id] = {\r\n                        ...state.visualInfo[id],\r\n                        selected: false,\r\n                    }),\r\n            );\r\n        },\r\n        foldAllDescendants: (state, action: PayloadAction<number>) => {\r\n            state.hiddenNodes = state.hiddenNodes\r\n                .concat([\r\n                    [action.payload, ...descendants(state.proof, action.payload)].filter(\r\n                        (id, index, self) =>\r\n                            id > 0 &&\r\n                            id < state.proof.length &&\r\n                            state.hiddenNodes.every((hiddenNodesArray) => hiddenNodesArray.indexOf(id) === -1) &&\r\n                            self.indexOf(id) === index,\r\n                    ),\r\n                ])\r\n                .filter((hiddenNodesArray) => hiddenNodesArray.length > 0);\r\n\r\n            // Set the visual info for the new pi node and the root node\r\n            const piNodeId = Object.keys(state.visualInfo).length;\r\n            state.visualInfo = {\r\n                ...state.visualInfo,\r\n                [action.payload]: {\r\n                    ...state.visualInfo[action.payload],\r\n                    selected: false,\r\n                },\r\n                [piNodeId]: {\r\n                    color: '#555',\r\n                    x: 0,\r\n                    y: 0,\r\n                    selected: false,\r\n                },\r\n            };\r\n        },\r\n        unhideNodes: (state, action: PayloadAction<{ pi: number; hiddens: number[] }>) => {\r\n            const { pi, hiddens } = action.payload;\r\n            state.hiddenNodes = state.hiddenNodes\r\n                .map((hiddenNodesArray) => hiddenNodesArray.filter((id) => hiddens.indexOf(id) === -1))\r\n                .filter((hiddenNodesArray) => hiddenNodesArray.length > 0);\r\n\r\n            // Make sure the ids are realocated\r\n            const size = Object.keys(state.visualInfo).length;\r\n            for (let i = pi; i < size - 1; i++) {\r\n                state.visualInfo[i] = state.visualInfo[i + 1];\r\n            }\r\n            // Delete the last position\r\n            delete state.visualInfo[size - 1];\r\n\r\n            // Unselect the hidden nodes\r\n            hiddens.forEach(\r\n                (id) =>\r\n                    (state.visualInfo[id] = {\r\n                        ...state.visualInfo[id],\r\n                        selected: false,\r\n                    }),\r\n            );\r\n        },\r\n        setVisualInfo: (state, action: PayloadAction<ProofState['visualInfo']>) => {\r\n            state.visualInfo = action.payload;\r\n        },\r\n        selectNodes: (state, action: PayloadAction<number[]>) => {\r\n            const len = Object.keys(state.visualInfo).length;\r\n            action.payload.forEach((id) => {\r\n                if (id >= 0 && id < len) {\r\n                    state.visualInfo[id].selected = true;\r\n                }\r\n            });\r\n        },\r\n        unselectNodes: (state, action: PayloadAction<number[]>) => {\r\n            const len = Object.keys(state.visualInfo).length;\r\n            action.payload.forEach((id) => {\r\n                if (id >= 0 && id < len) {\r\n                    state.visualInfo[id].selected = false;\r\n                }\r\n            });\r\n        },\r\n        changeStyle: (state, action: PayloadAction<'graph' | 'directory'>) => {\r\n            switch (action.payload) {\r\n                case 'graph':\r\n                    state.style = 'graph';\r\n                    break;\r\n                case 'directory':\r\n                    state.style = 'directory';\r\n                    break;\r\n            }\r\n        },\r\n        applyView: (state, action: PayloadAction<'basic' | 'propositional' | 'full' | 'clustered'>) => {\r\n            const visualInfoSize = Object.keys(state.visualInfo).length;\r\n            const proofSize = state.proof.length;\r\n            // Delete all the pi nodes\r\n            for (let i = 0; i < visualInfoSize - proofSize; i++) {\r\n                delete state.visualInfo[proofSize + i];\r\n            }\r\n\r\n            switch (action.payload) {\r\n                //\r\n                case 'basic':\r\n                    state.view = 'basic';\r\n                    state.hiddenNodes = [\r\n                        state.proof\r\n                            .filter((proofNode) => proofNode.views.indexOf('basic') === -1)\r\n                            .map((proofNode) => proofNode.id),\r\n                    ];\r\n\r\n                    // Set the visual info for the new pi nodes\r\n                    state.visualInfo = {\r\n                        ...state.visualInfo,\r\n                        [Object.keys(state.visualInfo).length]: {\r\n                            color: '#555',\r\n                            x: 0,\r\n                            y: 0,\r\n                            selected: false,\r\n                        },\r\n                    };\r\n\r\n                    break;\r\n                // Hide all nodes that haven't view equal to basic and propositional\r\n                case 'propositional':\r\n                    state.view = 'propositional';\r\n                    state.hiddenNodes = [\r\n                        // Hide nodes that aren't basics a\r\n                        // nos q n so basicos (folhas e o no raiz) e nem proposicionais (outra classe q n tem no .dot1)\r\n                        state.proof\r\n                            .filter(\r\n                                (node) =>\r\n                                    node.views.indexOf('basic') === -1 && node.views.indexOf('propositional') === -1,\r\n                            )\r\n                            .map((node) => node.id),\r\n                    ];\r\n\r\n                    // Set the visual info for the new pi nodes\r\n                    state.visualInfo = {\r\n                        ...state.visualInfo,\r\n                        [Object.keys(state.visualInfo).length]: {\r\n                            color: '#555',\r\n                            x: 0,\r\n                            y: 0,\r\n                            selected: false,\r\n                        },\r\n                    };\r\n\r\n                    break;\r\n                // View without hidden Nodes\r\n                case 'full':\r\n                    state.view = 'full';\r\n                    state.hiddenNodes = [];\r\n                    break;\r\n                // Cluster all the nodes in your respective group\r\n                case 'clustered':\r\n                    // If there are clusters infos\r\n                    if (state.clustersInfos.length) {\r\n                        state.hiddenNodes = [];\r\n                        const size = Object.keys(state.visualInfo).length;\r\n\r\n                        state.clustersInfos.forEach((cluster, i) => {\r\n                            state.visualInfo[size + i] = {\r\n                                color: colorConverter(cluster.color),\r\n                                x: 0,\r\n                                y: 0,\r\n                                selected: false,\r\n                            };\r\n\r\n                            state.hiddenNodes.push(cluster.hiddenNodes);\r\n                        });\r\n                    }\r\n                    break;\r\n            }\r\n        },\r\n        applyColor: (state, action: PayloadAction<string>) => {\r\n            Object.keys(state.visualInfo).forEach((id) => {\r\n                if (state.visualInfo[Number(id)].selected) {\r\n                    state.visualInfo[Number(id)].color = action.payload;\r\n                    state.visualInfo[Number(id)].selected = false;\r\n                }\r\n            });\r\n        },\r\n    },\r\n});\r\n\r\nexport const {\r\n    process,\r\n    hideNodes,\r\n    foldAllDescendants,\r\n    unhideNodes,\r\n    setVisualInfo,\r\n    selectNodes,\r\n    unselectNodes,\r\n    changeStyle,\r\n    applyView,\r\n    applyColor,\r\n} = proofSlice.actions;\r\n\r\nexport const selectProof = (state: RootState): NodeInterface[] => {\r\n    let proof = state.proof.proof;\r\n    const hiddenNodes = state.proof.hiddenNodes;\r\n\r\n    hiddenNodes.forEach((hiddenNodesArray) => {\r\n        const dependencies: { [parentId: number]: number[] } = {};\r\n        const children = piNodeChildren(proof, hiddenNodesArray);\r\n        const parents = piNodeParents(proof, hiddenNodesArray, dependencies);\r\n        const piNodeDependencies = groupPiNodeDependencies(proof, hiddenNodesArray);\r\n\r\n        const piNodeId = proof.length;\r\n        proof = proof.concat({\r\n            id: piNodeId,\r\n            conclusion: '',\r\n            rule: '',\r\n            args: '',\r\n            views: [],\r\n            children: children,\r\n            parents: parents,\r\n            hiddenNodes: hiddenNodesArray.map((hiddenNode) => proof[hiddenNode]),\r\n            descendants: 1,\r\n            dependencies: piNodeDependencies,\r\n        });\r\n\r\n        const piNode = proof[piNodeId];\r\n\r\n        children.forEach(\r\n            (childId) =>\r\n                (proof[childId] = {\r\n                    ...proof[childId],\r\n                    parents: proof[childId].parents\r\n                        .concat([piNodeId])\r\n                        .filter((proofNode) => hiddenNodesArray.indexOf(proofNode) === -1),\r\n                }),\r\n        );\r\n        parents.forEach(\r\n            (parentId) =>\r\n                (proof[parentId] = {\r\n                    ...proof[parentId],\r\n                    children: proof[parentId].children\r\n                        .concat([piNodeId])\r\n                        .filter((proofNode) => hiddenNodesArray.indexOf(proofNode) === -1),\r\n                }),\r\n        );\r\n\r\n        // Set the dependencies array of each parent that has deps and remove\r\n        //  the children that are dependencies\r\n        Object.keys(dependencies).forEach((parent) => {\r\n            const parentId = Number(parent);\r\n            proof[parentId] = {\r\n                ...proof[parentId],\r\n                children: proof[parentId].children.filter((c) => dependencies[parentId].indexOf(c) === -1),\r\n                dependencies: [...proof[parentId].dependencies, { piId: piNodeId, depsId: dependencies[parentId] }],\r\n            };\r\n        });\r\n\r\n        // Get the high hierarchy nodes in this pi node\r\n        const highHierarchyNodes = hiddenNodesArray?.filter((node) =>\r\n            proof[node].parents.every((parentId) => piNode.parents.indexOf(parentId) !== -1),\r\n        );\r\n\r\n        // Get the conclusion array\r\n        const conclusion = highHierarchyNodes.map((node) => ' ' + proof[node].conclusion);\r\n        piNode.conclusion = conclusion.length > 1 ? `[${conclusion} ]` : `${conclusion}`;\r\n\r\n        // Get the rule array\r\n        const rule = highHierarchyNodes.map((node) => ' ' + proof[node].rule);\r\n        piNode.rule = rule.length > 1 ? `[${rule} ]` : `${rule} `;\r\n\r\n        // Set the descendants number\r\n        piNode.descendants = piNode.children.reduce(\r\n            (ac: number, childID) => ((ac += proof[childID].descendants), ac),\r\n            1,\r\n        );\r\n    });\r\n\r\n    proof = proof.filter((proofNode) =>\r\n        hiddenNodes.every((hiddenNodesArray) => hiddenNodesArray.indexOf(proofNode.id) === -1),\r\n    );\r\n\r\n    return proof;\r\n};\r\n\r\nexport const selectOriginalProof = (state: RootState): NodeInterface[] => {\r\n    return state.proof.proof;\r\n};\r\n\r\nexport const selectView = (state: RootState): 'basic' | 'propositional' | 'full' => {\r\n    return state.proof.view;\r\n};\r\n\r\nexport const selectStyle = (state: RootState): 'graph' | 'directory' => {\r\n    return state.proof.style;\r\n};\r\n\r\nexport const selectLetMap = (state: RootState): { [Key: string]: string } => {\r\n    return state.proof.letMap;\r\n};\r\n\r\nexport const selectVisualInfo = (state: RootState): ProofState['visualInfo'] => {\r\n    if (state.proof.proof.length) return state.proof.visualInfo;\r\n    // If there is no proof node\r\n    return { 0: { color: '#555', x: 0, y: 0, selected: false } };\r\n};\r\n\r\nexport const selectHiddenNodes = (state: RootState): number[][] => {\r\n    return state.proof.hiddenNodes;\r\n};\r\n\r\nexport default proofSlice.reducer;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\nimport { RootState } from '../../store';\r\nimport { ThemeState } from '../../../interfaces/interfaces';\r\n\r\nconst initialState: ThemeState = {\r\n    value: true,\r\n};\r\n\r\nexport const themeSlice = createSlice({\r\n    name: 'theme',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        toggle: (state) => {\r\n            state.value = !state.value;\r\n        },\r\n    },\r\n});\r\n\r\nexport const { toggle } = themeSlice.actions;\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice theme. For example: `useSelector((state: RootState) => state.counter.value)`\r\nexport const selectTheme = (state: RootState): boolean => state.theme.value;\r\n\r\nexport default themeSlice.reducer;\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { RootState } from '../../store';\r\nimport { ExternalCmdState } from '../../../interfaces/interfaces';\r\n\r\nconst initialState: ExternalCmdState = {\r\n    findData: {\r\n        nodeToFind: -1,\r\n        findOption: false,\r\n    },\r\n    renderData: {\r\n        count: 0,\r\n        fileChanged: false,\r\n    },\r\n};\r\n\r\nexport const externalCmd = createSlice({\r\n    name: 'externalCmd',\r\n    initialState,\r\n    reducers: {\r\n        findNode: (state, action: PayloadAction<{ nodeId: number; option: boolean }>) => {\r\n            state.findData = { nodeToFind: action.payload.nodeId, findOption: action.payload.option };\r\n        },\r\n        reRender: (state) => {\r\n            state.renderData.count = 0;\r\n        },\r\n        addRenderCount: (state) => {\r\n            state.renderData.count++;\r\n        },\r\n        blockRender: (state) => {\r\n            state.renderData.count = 2;\r\n        },\r\n        allowRenderNewFile: (state) => {\r\n            state.renderData.fileChanged = true;\r\n        },\r\n        blockRenderNewFile: (state) => {\r\n            state.renderData.fileChanged = false;\r\n        },\r\n    },\r\n});\r\n\r\nexport const { findNode, reRender, addRenderCount, blockRender, allowRenderNewFile, blockRenderNewFile } =\r\n    externalCmd.actions;\r\n\r\nexport const selectFindData = (state: RootState): { nodeToFind: number; findOption: boolean } =>\r\n    state.externalCmd.findData;\r\n\r\nexport const selectRenderData = (state: RootState): { count: number; fileChanged: boolean } =>\r\n    state.externalCmd.renderData;\r\n\r\nexport default externalCmd.reducer;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { useAppSelector, useAppDispatch } from '../../store/hooks';\r\nimport { selectDot, selectFileName } from '../../store/features/file/fileSlice';\r\nimport {\r\n    applyView,\r\n    changeStyle,\r\n    selectNodes,\r\n    applyColor,\r\n    hideNodes,\r\n    foldAllDescendants,\r\n    unhideNodes,\r\n    selectVisualInfo,\r\n    selectProof,\r\n    selectHiddenNodes,\r\n    selectView,\r\n    unselectNodes,\r\n} from '../../store/features/proof/proofSlice';\r\nimport { ReduxState, NavbarPropsAndRedux, NavbarProps } from '../../interfaces/interfaces';\r\n\r\nimport { Alignment, Button, Icon, InputGroup, Navbar, Switch, Menu, MenuItem } from '@blueprintjs/core';\r\nimport { Popover2 } from '@blueprintjs/popover2';\r\nimport { selectTheme, toggle } from '../../store/features/theme/themeSlice';\r\nimport '../../scss/VisualizerNavbar.scss';\r\nimport { findNode, reRender } from '../../store/features/externalCmd/externalCmd';\r\n\r\nfunction useWindowSize() {\r\n    // Initialize state with undefined width/height so server and client renders match\r\n    // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\r\n    const [windowSize, setWindowSize] = useState({\r\n        width: 0,\r\n        height: 0,\r\n    });\r\n    useEffect(() => {\r\n        // Handler to call on window resize\r\n        function handleResize() {\r\n            // Set window width/height to state\r\n            setWindowSize({\r\n                width: window.innerWidth,\r\n                height: window.innerHeight,\r\n            });\r\n        }\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []); // Empty array ensures that effect is only run on mount\r\n    return windowSize;\r\n}\r\n\r\nconst VisualizerNavbar: React.FC<NavbarPropsAndRedux> = ({\r\n    setDialogIsOpen,\r\n    setDialogContent,\r\n    setDrawerIsOpen,\r\n    addErrorToast,\r\n    visualInfo,\r\n    proof,\r\n    dot,\r\n    view,\r\n    hiddenNodes,\r\n    hideNodes,\r\n}: NavbarPropsAndRedux) => {\r\n    const fileName = useAppSelector(selectFileName);\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const windowSize = useWindowSize();\r\n    const [command, setCommand] = useState('');\r\n    const [lastCommands, setLastCommands] = useState(['']);\r\n    const [commandId, setCommandId] = useState(0);\r\n\r\n    const dispatch = useAppDispatch();\r\n\r\n    const openDialog = (content: string): void => {\r\n        setDialogIsOpen(true);\r\n        setDialogContent(content);\r\n    };\r\n\r\n    const handleInputKeyDown = (e: React.KeyboardEvent<HTMLElement>) => {\r\n        // Creates an commands historic, registering the past 4 commands\r\n        switch (e.key) {\r\n            case 'Enter':\r\n                // If the command is not a white space\r\n                if (command.trim() !== '') {\r\n                    runCommands(command);\r\n                    if (lastCommands.length === 5) {\r\n                        lastCommands.pop();\r\n                    }\r\n                    lastCommands.unshift('');\r\n                    setLastCommands(lastCommands);\r\n                    setCommand('');\r\n                }\r\n                break;\r\n            case 'ArrowUp':\r\n                if (commandId < lastCommands.length - 1) {\r\n                    const newId = commandId + 1;\r\n                    setCommandId(newId);\r\n                    setCommand(lastCommands[newId]);\r\n                }\r\n                break;\r\n            case 'ArrowDown':\r\n                if (commandId > 0) {\r\n                    const newId = commandId - 1;\r\n                    setCommandId(newId);\r\n                    setCommand(lastCommands[newId]);\r\n                }\r\n                break;\r\n        }\r\n    };\r\n\r\n    const runCommands = (command: string): void => {\r\n        const commands = command.trim().split(/ +/);\r\n        let hiddenIds: number[];\r\n\r\n        switch (commands[0]) {\r\n            case '/view':\r\n                switch (commands[1]) {\r\n                    case 'basic':\r\n                        dispatch(applyView('basic'));\r\n                        dispatch(reRender());\r\n                        break;\r\n                    case 'propositional':\r\n                        dispatch(applyView('propositional'));\r\n                        dispatch(reRender());\r\n                        break;\r\n                    case 'full':\r\n                        dispatch(applyView('full'));\r\n                        dispatch(reRender());\r\n                        break;\r\n                }\r\n                break;\r\n            case '/select':\r\n                if (commands[1]) {\r\n                    let cmdArg = '';\r\n                    commands.forEach((string, id) => id !== 0 && (cmdArg += string + ' '));\r\n                    // Matches all the brackets\r\n                    const matches = [...cmdArg.matchAll(/\\[([^\\[\\]]+)\\]/g)];\r\n                    let idList: number[] = [];\r\n\r\n                    // There is a case with brackets\r\n                    if (matches[0]) {\r\n                        const insideBracket = matches[0][1].trim();\r\n                        let insideMatches = [...insideBracket.matchAll(/\\s*\\d+\\s*-\\s*\\d+\\s*/g)];\r\n\r\n                        // Number range notation\r\n                        if (insideMatches[0]) {\r\n                            // Get the range limits\r\n                            const rangeLim = insideMatches[0][0].split(/\\s*-\\s*/).map((numS) => Number(numS));\r\n                            idList = Array.from({ length: rangeLim[1] - rangeLim[0] + 1 }, (_, i) => rangeLim[0] + i);\r\n                        }\r\n                        // List notation\r\n                        else {\r\n                            insideMatches = [...insideBracket.matchAll(/(\\s*\\d+\\s*,*)+/g)];\r\n                            // Number list notation\r\n                            if (insideMatches[0]) {\r\n                                // Group all the matches\r\n                                let listStr = '';\r\n                                insideMatches.forEach((match) => (listStr += match[0]));\r\n                                // Convert to number\r\n                                idList = listStr\r\n                                    .split(/,\\s*/)\r\n                                    .filter((word) => word.length > 0 && !isNaN(Number(word)))\r\n                                    .map((id) => Number(id));\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Is a regex select?\r\n                        const matches = [...cmdArg.matchAll(/\\/[^\\/]*\\//g)];\r\n                        const argMatch = [...cmdArg.matchAll(/--(c|r)/g)];\r\n                        // If there is a regex\r\n                        if (matches[0]) {\r\n                            let argIsConclusion = true;\r\n                            // Try to find the option\r\n                            if (argMatch[0]) {\r\n                                switch (argMatch[0][1]) {\r\n                                    case 'r':\r\n                                        argIsConclusion = false;\r\n                                        break;\r\n                                    case 'c':\r\n                                        argIsConclusion = true;\r\n                                        break;\r\n                                }\r\n                            }\r\n\r\n                            const regexString = matches[0][0].substring(1, matches[0][0].length - 1);\r\n                            try {\r\n                                // Search all the nodes with the specific regex matching in the conclusion\r\n                                const regex = new RegExp(regexString);\r\n                                idList = proof\r\n                                    .filter((node) => regex.test(argIsConclusion ? node.conclusion : node.rule))\r\n                                    .map((node) => node.id);\r\n                            } catch (err) {\r\n                                // If the inserted regex expression is invalid (probably missing \\)\r\n                                addErrorToast('Regex error: probably and wrong regex expression');\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    dispatch(selectNodes(idList));\r\n                }\r\n                break;\r\n            case '/unselect':\r\n                const allNodesIds = proof.map((node) => node.id);\r\n                dispatch(unselectNodes(allNodesIds));\r\n                break;\r\n            case '/color':\r\n                if (commands[1]) {\r\n                    // Hex color\r\n                    if (RegExp(/^#([0-9a-f]{3}){1,2}$/i).test(commands[1])) {\r\n                        dispatch(applyColor(commands[1]));\r\n                        break;\r\n                    }\r\n                    // Default colors\r\n                    switch (commands[1]) {\r\n                        case 'red':\r\n                            dispatch(applyColor('#f72b34'));\r\n                            break;\r\n                        case 'orange':\r\n                            dispatch(applyColor('#ff8334'));\r\n                            break;\r\n                        case 'yellow':\r\n                            dispatch(applyColor('#ffc149'));\r\n                            break;\r\n                        case 'green':\r\n                            dispatch(applyColor('#60aa51'));\r\n                            break;\r\n                        case 'blue':\r\n                            dispatch(applyColor('#0097e4'));\r\n                            break;\r\n                        case 'purple':\r\n                            dispatch(applyColor('#a73da5'));\r\n                            break;\r\n                        case 'brown':\r\n                            dispatch(applyColor('#a95a49'));\r\n                            break;\r\n                        case 'gray':\r\n                            dispatch(applyColor('#464646'));\r\n                            break;\r\n                        case 'white':\r\n                            dispatch(applyColor('#f0f0f0'));\r\n                            break;\r\n                    }\r\n                }\r\n                break;\r\n            case '/hide':\r\n                // Hide all the selected nodes\r\n                hiddenIds = Object.keys(visualInfo)\r\n                    .map((id) => Number(id))\r\n                    .filter((id) => visualInfo[id].selected);\r\n                // Make sure there are nodes selected\r\n                if (hiddenIds.length > 1) {\r\n                    // Re-render the canvas and update the store\r\n                    dispatch(reRender());\r\n                    dispatch(hideNodes(hiddenIds));\r\n                }\r\n                break;\r\n            case '/fold':\r\n                // If the option is a number\r\n                if (commands[1] && !isNaN(Number(commands[1]))) {\r\n                    const nodeId = Number(commands[1]);\r\n                    // Is a valid node\r\n                    if (nodeId >= 0 && nodeId < proof.length) {\r\n                        // Re-render the canvas and update the store\r\n                        dispatch(reRender());\r\n                        dispatch(foldAllDescendants(nodeId));\r\n                    }\r\n                }\r\n                break;\r\n            case '/unfold':\r\n                // If there is a number argument\r\n                if (commands[1] && !isNaN(Number(commands[1]))) {\r\n                    const id = Number(commands[1]);\r\n                    // Get the pi node (to be unfold)\r\n                    const obj = proof.find((node) => node.id === id);\r\n                    // If it's a pi node\r\n                    if (obj && obj.hiddenNodes?.length) {\r\n                        // Get the hidden nodes and their ids\r\n                        const hiddenNodes = obj.hiddenNodes ? obj.hiddenNodes : [];\r\n                        hiddenIds = hiddenNodes ? hiddenNodes.map((node) => node.id) : [];\r\n                        // Re-render the canvas and update the store\r\n                        dispatch(reRender());\r\n                        dispatch(unhideNodes({ pi: id, hiddens: hiddenIds }));\r\n                    }\r\n                }\r\n                break;\r\n            case '/find':\r\n                // If there is an argument and is a number\r\n                if (commands[1] && !isNaN(Number(commands[1]))) {\r\n                    // Find the node\r\n                    dispatch(\r\n                        findNode({\r\n                            nodeId: Number(commands[1]),\r\n                            option: commands[2] === '--s' ? true : false,\r\n                        }),\r\n                    );\r\n                }\r\n                break;\r\n        }\r\n    };\r\n\r\n    const exportJSON = () => {\r\n        const downloadJSON = {\r\n            dot: dot,\r\n            visualInfo: visualInfo,\r\n            hiddenNodes: hiddenNodes,\r\n            view: view,\r\n        };\r\n        const fName = fileName.split('.');\r\n        fName.splice(fName.length - 1, 1);\r\n\r\n        const link = document.createElement('a');\r\n        link.download = fName + '.json';\r\n        link.href = `data:attachment/text,${encodeURIComponent(JSON.stringify(downloadJSON))}`;\r\n        link.click();\r\n    };\r\n\r\n    const menus = {\r\n        style: (\r\n            <Menu>\r\n                <MenuItem\r\n                    icon=\"diagram-tree\"\r\n                    text=\"Graph\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        dispatch(changeStyle('graph'));\r\n                    }}\r\n                />\r\n                <MenuItem\r\n                    icon=\"folder-open\"\r\n                    text=\"Directory\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        dispatch(changeStyle('directory'));\r\n                    }}\r\n                />\r\n            </Menu>\r\n        ),\r\n        views: (\r\n            <Menu>\r\n                <MenuItem\r\n                    text=\"Basic\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        dispatch(applyView('basic'));\r\n                        dispatch(reRender());\r\n                    }}\r\n                />\r\n                <MenuItem\r\n                    text=\"Propositional\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        dispatch(applyView('propositional'));\r\n                        dispatch(reRender());\r\n                    }}\r\n                />\r\n                <MenuItem\r\n                    text=\"Full\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        dispatch(applyView('full'));\r\n                        dispatch(reRender());\r\n                    }}\r\n                />\r\n                <MenuItem\r\n                    text=\"Clustered\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        dispatch(applyView('clustered'));\r\n                        dispatch(reRender());\r\n                    }}\r\n                />\r\n            </Menu>\r\n        ),\r\n        download: (\r\n            <Menu>\r\n                <MenuItem icon=\"layout\" text=\"JSON\" onClick={exportJSON} />\r\n                <MenuItem\r\n                    icon=\"graph\"\r\n                    text=\"DOT\"\r\n                    href={`data:attachment/text,${encodeURIComponent(dot ? dot : '')}`}\r\n                    download={fileName ? `${fileName.replaceAll(' ', '_')}.dot` : ''}\r\n                />\r\n                <MenuItem\r\n                    icon=\"square\"\r\n                    text=\"PNG\"\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        const link = document.createElement('a');\r\n                        link.download = fileName ? `${fileName.replaceAll(' ', '_')}.png` : '';\r\n                        link.href = (\r\n                            document.getElementsByClassName('konvajs-content')[0].children[0] as HTMLCanvasElement\r\n                        ).toDataURL('image/png');\r\n                        link.click();\r\n                    }}\r\n                />\r\n            </Menu>\r\n        ),\r\n        help: (\r\n            <Menu>\r\n                <MenuItem text=\"/view\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that changes the view mode.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /view {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Option:</u> basic, propositional, full.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/select\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that select a group of nodes.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /select {'<option>'} {'<argument>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Options:</u>\r\n                            <div className=\"option\">\r\n                                1 - A list of node {`id's`} wrapped by brackets and separated by commas (and spaces if\r\n                                wanted) (eg.: [1, 15, 6,3]).\r\n                            </div>\r\n                            <div className=\"option\">\r\n                                2 - A range of node {`id's`} wrapped by brackets and separated by hyphen (and spaces if\r\n                                wanted) (eg.: [ 4 -15]). This range will include the last element.\r\n                            </div>\r\n                            <div className=\"option\">\r\n                                3 - A regex expression used to select all the nodes which the conclusion owns a match\r\n                                (eg.: /\\.*false\\.*/ {'->'} selects all the nodes with false anywhere in the conclusion).\r\n                                <br />\r\n                                <br />\r\n                                If wanted to search a match in the rule just insert the --r argument. The --c argument\r\n                                exists but the /select will by default search in the conclusion.\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/unselect\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that unselect all the nodes.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /unselect.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/color\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that changes the color of the current selected\r\n                            nodes.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /color {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Options:</u>\r\n                            <div className=\"option\">1 - A valid hex color notation (eg.: #A7B).</div>\r\n                            <div className=\"option\">\r\n                                2 - A color name between: red, orange, yellow, green, blue, purple, brown, gray, white.\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Prerequisites:</u> a group of nodes being selected.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/hide\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that try to fold (hide) a group of selected nodes.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /hide.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Prerequisites:</u> a group of nodes being selected.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/fold\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that fold all descendants of a specific node.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /fold {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Option:</u> a valid node id.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/unfold\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that unfold a specific pi node.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /unfold {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Option:</u> a valid pi node id.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n                <MenuItem text=\"/find\">\r\n                    <div className=\"cmd-desc\">\r\n                        <div>\r\n                            <u className=\"title\">Desc.:</u> Command that find a node and centralize the canvas at it.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Pattern:</u> /fild {'<node number>'} {'<option>'}.\r\n                        </div>\r\n                        <div>\r\n                            <u className=\"title\">Option:</u> --s: find and select the node.\r\n                        </div>\r\n                    </div>\r\n                </MenuItem>\r\n            </Menu>\r\n        ),\r\n    };\r\n\r\n    return (\r\n        <Navbar>\r\n            <Navbar.Group align={Alignment.LEFT}>\r\n                <Navbar.Heading>\r\n                    <b>{windowSize.width >= 900 ? 'Proof Visualizer' : 'PV'}</b>\r\n                </Navbar.Heading>\r\n                <Navbar.Divider />\r\n                <Button\r\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n                        e.preventDefault();\r\n                        openDialog('upload-proof');\r\n                    }}\r\n                    className=\"bp3-minimal\"\r\n                    icon=\"upload\"\r\n                    text={windowSize.width >= 900 ? 'Upload Proof' : ''}\r\n                />\r\n            </Navbar.Group>\r\n\r\n            <Navbar.Group align={Alignment.RIGHT}>\r\n                {fileName ? (\r\n                    <>\r\n                        <Navbar.Heading>{fileName}</Navbar.Heading>\r\n                        <Navbar.Divider />\r\n                        <InputGroup\r\n                            id=\"command\"\r\n                            placeholder=\"/command\"\r\n                            value={command}\r\n                            onChange={(e) => {\r\n                                setCommandId(0);\r\n                                lastCommands[0] = e.target.value;\r\n                                setLastCommands(lastCommands);\r\n                                setCommand(e.target.value);\r\n                            }}\r\n                            onKeyDown={handleInputKeyDown}\r\n                            rightElement={\r\n                                <Popover2 content={menus.help} placement=\"bottom-end\">\r\n                                    <Button icon=\"help\" className=\"bp3-minimal\" />\r\n                                </Popover2>\r\n                            }\r\n                            autoComplete=\"off\"\r\n                        />\r\n                        <Button\r\n                            style={{ marginLeft: '5px' }}\r\n                            icon=\"play\"\r\n                            onClick={() => {\r\n                                runCommands(command);\r\n                                lastCommands.pop();\r\n                                lastCommands.unshift(command);\r\n                                lastCommands[0] = '';\r\n                                setLastCommands(lastCommands);\r\n                                setCommand('');\r\n                            }}\r\n                        />\r\n                        <Navbar.Divider />\r\n                        <Popover2\r\n                            content={fileName ? menus.style : undefined}\r\n                            placement=\"bottom-end\"\r\n                            disabled={fileName ? false : true}\r\n                        >\r\n                            <Button\r\n                                icon=\"presentation\"\r\n                                className=\"bp3-minimal\"\r\n                                text={windowSize.width >= 900 ? 'Style' : ''}\r\n                                disabled={fileName ? false : true}\r\n                            />\r\n                        </Popover2>\r\n                        <Popover2\r\n                            content={fileName ? menus.views : undefined}\r\n                            placement=\"bottom-end\"\r\n                            disabled={fileName ? false : true}\r\n                        >\r\n                            <Button\r\n                                className=\"bp3-minimal\"\r\n                                icon=\"diagram-tree\"\r\n                                text={windowSize.width >= 900 ? 'View' : ''}\r\n                                disabled={fileName ? false : true}\r\n                            />\r\n                        </Popover2>\r\n                        <Button\r\n                            className=\"bp3-minimal\"\r\n                            icon=\"translate\"\r\n                            text={windowSize.width >= 900 ? 'Let Map' : ''}\r\n                            disabled={fileName ? false : true}\r\n                            onClick={() => setDrawerIsOpen(true)}\r\n                        />\r\n                        <Popover2\r\n                            content={fileName ? menus.download : undefined}\r\n                            placement=\"bottom-end\"\r\n                            disabled={fileName ? false : true}\r\n                        >\r\n                            <Button\r\n                                className=\"bp3-minimal\"\r\n                                icon=\"download\"\r\n                                text={windowSize.width >= 900 ? 'Download' : ''}\r\n                                disabled={fileName ? false : true}\r\n                            />\r\n                        </Popover2>\r\n                        <Navbar.Divider />\r\n                    </>\r\n                ) : null}\r\n\r\n                <span id=\"switch-button-dark-theme\">\r\n                    <Switch checked={useAppSelector(selectTheme)} onChange={() => dispatch(toggle())} />\r\n                    <Icon icon={darkTheme ? 'moon' : 'flash'}></Icon>\r\n                </span>\r\n            </Navbar.Group>\r\n        </Navbar>\r\n    );\r\n};\r\n\r\nfunction mapStateToProps(state: ReduxState, ownProps: NavbarProps) {\r\n    return {\r\n        ...ownProps,\r\n        proof: selectProof(state),\r\n        dot: selectDot(state),\r\n        view: selectView(state),\r\n        visualInfo: selectVisualInfo(state),\r\n        hiddenNodes: selectHiddenNodes(state),\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = { hideNodes };\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(VisualizerNavbar);\r\n","import React, { useState, useReducer, useEffect } from 'react';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport { Dispatch, SetStateAction } from 'react';\r\nimport { MaybeElement } from '@blueprintjs/core/lib/esm/common/props';\r\nimport { IconName } from '@blueprintjs/core/lib/esm/components/icon/icon';\r\n\r\nimport { Button, Classes, Dialog, FileInput, Intent } from '@blueprintjs/core';\r\n\r\nimport '../../scss/VisualizerDialog.scss';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { set } from '../../store/features/file/fileSlice';\r\nimport { process } from '../../store/features/proof/proofSlice';\r\nimport { allowRenderNewFile, blockRender, reRender } from '../../store/features/externalCmd/externalCmd';\r\n\r\ninterface DialogProps {\r\n    icon: IconName | MaybeElement;\r\n    title: React.ReactNode;\r\n}\r\n\r\ninterface VisualizerDialogProps {\r\n    dialogIsOpen: boolean;\r\n    setDialogIsOpen: Dispatch<SetStateAction<boolean>>;\r\n    dialogContent: string;\r\n    setDialogContent: Dispatch<SetStateAction<string>>;\r\n    addErrorToast: (err: string) => void;\r\n}\r\n\r\nconst readUploadedFileAsText = (inputFile: File) => {\r\n    const temporaryFileReader = new FileReader();\r\n\r\n    return new Promise((resolve, reject) => {\r\n        temporaryFileReader.onerror = () => {\r\n            temporaryFileReader.abort();\r\n            reject(new DOMException('Problem parsing input file.'));\r\n        };\r\n\r\n        temporaryFileReader.onload = () => {\r\n            resolve(temporaryFileReader.result);\r\n        };\r\n        temporaryFileReader.readAsText(inputFile);\r\n    });\r\n};\r\n\r\nconst VisualizerDialog: React.FC<VisualizerDialogProps> = ({\r\n    dialogIsOpen,\r\n    dialogContent,\r\n    setDialogContent,\r\n    setDialogIsOpen,\r\n    addErrorToast,\r\n}: VisualizerDialogProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const dispatch = useAppDispatch();\r\n\r\n    let dialogProps: DialogProps = { icon: 'error', title: 'Error' };\r\n    let dialogBody = <p>This wasn&apos;t supposed to happen. Please contact the developers.</p>;\r\n    let succesButton = <></>;\r\n\r\n    const [fileName, changeFileName] = useState('Choose file...');\r\n    const [file, changeFile] = useState('');\r\n    const [[focusFlag, flagCount], setFocusFlag] = useReducer(\r\n        (state: number[], newFlag: number): number[] => [newFlag, state[1] + 1],\r\n        [0, 0],\r\n    );\r\n\r\n    useEffect(() => {\r\n        if (dialogIsOpen && dialogContent === 'upload-proof') setFocusFlag(1);\r\n    }, [dialogIsOpen, dialogContent]);\r\n\r\n    useEffect(() => {\r\n        let el;\r\n        switch (focusFlag) {\r\n            // Focus the file input\r\n            case 1:\r\n                el = document.getElementsByClassName(Classes.DIALOG_BODY + ' dialog-body');\r\n                (el[0].childNodes[0] as HTMLElement).focus();\r\n                break;\r\n            // Focus the upload button\r\n            case 2:\r\n                el = document.getElementsByClassName(Classes.DIALOG_FOOTER_ACTIONS);\r\n                (el[0].childNodes[0] as HTMLElement).focus();\r\n                break;\r\n        }\r\n    }, [flagCount]);\r\n\r\n    const closeDialog = () => {\r\n        setDialogIsOpen(false);\r\n        changeFileName('Choose file...');\r\n        changeFile('');\r\n    };\r\n\r\n    switch (dialogContent) {\r\n        case 'upload-proof':\r\n            dialogProps = { icon: 'upload', title: 'Upload Proof' };\r\n            dialogBody = (\r\n                <FileInput\r\n                    text={fileName}\r\n                    hasSelection={fileName !== 'Choose file...'}\r\n                    onInputChange={async (e) => {\r\n                        const target = e.target as HTMLInputElement;\r\n                        const file = target.files ? target.files[0] : new File([''], 'filename');\r\n                        if (\r\n                            target.files &&\r\n                            target.files[0] &&\r\n                            target.files[0].name.split('.').slice(-1)[0] !== 'dot' &&\r\n                            target.files[0].name.split('.').slice(-1)[0] !== 'json'\r\n                        ) {\r\n                            addErrorToast('Sorry! Our app only support DOT and JSON files.');\r\n                            return;\r\n                        }\r\n\r\n                        try {\r\n                            // Make sure the file was selected and none error\r\n                            //  of \"no file select\" will be prompted\r\n                            if (file) {\r\n                                const fileContents = await readUploadedFileAsText(file);\r\n                                changeFile(fileContents as string);\r\n                                changeFileName(file.name);\r\n\r\n                                // If succeded, set the focus of the page to the upload button\r\n                                setFocusFlag(2);\r\n                            }\r\n                        } catch (er: any) {\r\n                            addErrorToast(er.message);\r\n                        }\r\n                    }}\r\n                    fill={true}\r\n                />\r\n            );\r\n            succesButton = (\r\n                <Button\r\n                    onClick={() => {\r\n                        dispatch(set({ name: fileName, value: file }));\r\n\r\n                        dispatch(allowRenderNewFile());\r\n                        const ext = fileName.split('.').pop();\r\n                        if (ext === 'json') dispatch(blockRender());\r\n                        else if (ext === 'dot') dispatch(reRender());\r\n\r\n                        dispatch(process(file));\r\n                        closeDialog();\r\n                    }}\r\n                    intent={Intent.SUCCESS}\r\n                    disabled={fileName === 'Choose file...'}\r\n                >\r\n                    Upload Proof\r\n                </Button>\r\n            );\r\n            break;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Dialog\r\n                className={darkTheme ? ' bp3-dark' : ''}\r\n                isOpen={dialogIsOpen}\r\n                onClose={(): void => closeDialog()}\r\n                usePortal={true}\r\n                {...dialogProps}\r\n            >\r\n                <div className={Classes.DIALOG_BODY + ' dialog-body'}>{dialogBody}</div>\r\n                <div className={Classes.DIALOG_FOOTER}>\r\n                    <div className={Classes.DIALOG_FOOTER_ACTIONS}>{succesButton}</div>\r\n                </div>\r\n            </Dialog>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default VisualizerDialog;\r\n","import { KonvaEventObject } from 'konva/types/Node';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Label, Text, Tag, Group, Circle, Arrow } from 'react-konva';\r\nimport { NodeProps } from '../../../interfaces/interfaces';\r\n\r\nfunction getTextWidth(text: string, font: string): number {\r\n    const canvas = document.createElement('canvas');\r\n    const context = canvas.getContext('2d');\r\n    let size = 0;\r\n    if (context) {\r\n        context.font = font;\r\n        size = context.measureText(text).width;\r\n    }\r\n    return size;\r\n}\r\n\r\nfunction textColorFromBg(bgColor: string) {\r\n    const r = parseInt(bgColor.substring(0, 2), 16);\r\n    const g = parseInt(bgColor.substring(2, 4), 16);\r\n    const b = parseInt(bgColor.substring(4, 6), 16);\r\n    return r * 0.299 + g * 0.587 + b * 0.114 > 150 ? '#000000' : '#ffffff';\r\n}\r\n\r\nfunction sixDigitColor(bgColor: string): string {\r\n    if (bgColor.charAt(0) === '#') {\r\n        if (bgColor.length == 4) {\r\n            return bgColor\r\n                .substring(1, 7)\r\n                .split('')\r\n                .map((c) => c + c)\r\n                .join('');\r\n        } else if (bgColor.length == 7) {\r\n            return bgColor.substring(1, 7);\r\n        }\r\n    } else {\r\n        if (bgColor.length == 3) {\r\n            return bgColor\r\n                .split('')\r\n                .map((c) => c + c)\r\n                .join('');\r\n        } else if (bgColor.length == 6) {\r\n            return bgColor;\r\n        }\r\n    }\r\n    return '000000';\r\n}\r\n\r\nconst Node: React.FC<NodeProps> = (props: NodeProps): JSX.Element => {\r\n    const {\r\n        id,\r\n        conclusion,\r\n        rule,\r\n        args,\r\n        x,\r\n        y,\r\n        nHided,\r\n        nDescendants,\r\n        hiddenNodes,\r\n        dependencies,\r\n        selected,\r\n        color,\r\n        setNodeOnFocus,\r\n        toggleNodeSelection,\r\n        updateNodePosition,\r\n        openDrawer,\r\n        onDragEnd,\r\n        createTree,\r\n    } = props;\r\n\r\n    const handleClick = (e: KonvaEventObject<MouseEvent>): void => {\r\n        if (e.evt.button === 0) {\r\n            if (e.evt.shiftKey) {\r\n                toggleNodeSelection(id);\r\n            } else {\r\n                openDrawer(\r\n                    {\r\n                        rule: rule,\r\n                        args: args,\r\n                        conclusion: conclusion,\r\n                        nHided: nHided,\r\n                        nDescendants: nDescendants - (rule === '' ? 0 : 0),\r\n                        hiddenNodes: hiddenNodes,\r\n                        dependencies: dependencies,\r\n                    },\r\n                    createTree(id),\r\n                );\r\n            }\r\n        } else if (e.evt.button === 2) {\r\n            setNodeOnFocus(id);\r\n            const menuNode = document.getElementById('menu');\r\n            if (menuNode) {\r\n                menuNode.style.top = `${e.evt.clientY}px`;\r\n                menuNode.style.left = `${e.evt.clientX}px`;\r\n                menuNode.style.display = 'initial';\r\n                window.addEventListener('click', () => {\r\n                    menuNode.style.display = 'none';\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    const depSize = 25,\r\n        depLineSize = 25;\r\n    const bgColor = color;\r\n\r\n    const style = {\r\n        tag: {\r\n            fill: bgColor,\r\n            stroke: selected ? 'red' : 'black',\r\n            strokeWidth: selected ? 3 : 1,\r\n        },\r\n        get dep() {\r\n            return { ...this.tag };\r\n        },\r\n        text: {\r\n            align: 'center',\r\n            fill: textColorFromBg(sixDigitColor(bgColor)),\r\n            fontSize: 15,\r\n            height: 35,\r\n            padding: 10,\r\n            width: 300,\r\n        },\r\n        get depText() {\r\n            return {\r\n                ...this.text,\r\n                padding: 0,\r\n                width: depSize * 2,\r\n            };\r\n        },\r\n    };\r\n    const infos = {\r\n        nHided: nHided ? `#hidden: ${nHided}` : '',\r\n        nDescendants: ` #descendants: ${nDescendants}`,\r\n        rule: nHided ? '' : rule,\r\n        dependencies: dependencies.length === 1 ? String(dependencies[0].piId) : '',\r\n    };\r\n\r\n    const [idSize, setIdSize] = useState(50);\r\n    const [descendantSize, setDescendantSize] = useState(style.text.width - 50);\r\n\r\n    // Component Did Mount\r\n    useEffect(() => {\r\n        const font = `${style.text.fontSize}px -apple-system, \"BlinkMacSystemFont\", \"Segoe UI\", \"Roboto\", \"Oxygen\", \"Ubuntu\", \"Cantarell\", \"Open Sans\", \"Helvetica Neue\", \"Icons16\", sans-serif`;\r\n        const calc = getTextWidth(id.toString(), font) + style.text.padding * 3;\r\n        setIdSize(calc);\r\n        setDescendantSize(style.text.width - calc);\r\n    }, []);\r\n\r\n    return (\r\n        <Group\r\n            draggable\r\n            id={id.toString()}\r\n            key={id}\r\n            onDragMove={(e) => {\r\n                updateNodePosition(id, e.target.attrs.x, e.target.attrs.y);\r\n            }}\r\n            onDragEnd={onDragEnd}\r\n            x={x}\r\n            y={y}\r\n            onClick={handleClick}\r\n        >\r\n            <Label x={0} y={0}>\r\n                <Tag {...style.tag} />\r\n                <Text {...style.text} text={conclusion} />\r\n            </Label>\r\n            <Label x={0} y={35}>\r\n                <Tag {...style.tag} />\r\n                <Text {...style.text} text={infos.rule} />\r\n            </Label>\r\n            <Label x={0} y={70} {...{ align: 'right' }}>\r\n                <Tag {...style.tag} />\r\n                <Text {...{ ...style.text, width: idSize }} text={id.toString()} />\r\n            </Label>\r\n            <Label x={idSize} y={70}>\r\n                <Tag {...style.tag} />\r\n                <Text {...{ ...style.text, width: descendantSize }} text={infos.nHided + infos.nDescendants} />\r\n            </Label>\r\n            {dependencies.length ? (\r\n                <Label x={300} y={0}>\r\n                    <Arrow strokeWidth={1} stroke=\"black\" fill=\"black\" points={[depLineSize, 53, 0, 53]} />\r\n                    <Circle x={depLineSize + depSize} y={53} radius={depSize} {...style.dep}></Circle>\r\n                    <Label x={depLineSize} y={45}>\r\n                        <Text {...style.depText} text={infos.dependencies} />\r\n                    </Label>\r\n                </Label>\r\n            ) : null}\r\n        </Group>\r\n    );\r\n};\r\n\r\nexport default Node;\r\n","import React from 'react';\r\nimport { Arrow } from 'react-konva';\r\n\r\nimport { LineProps } from '../../../interfaces/interfaces';\r\n\r\nconst Line = ({ key, points }: LineProps): JSX.Element => {\r\n    return <Arrow key={key} strokeWidth={1} stroke=\"black\" fill=\"black\" points={[...points]} />;\r\n};\r\n\r\nexport default Line;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { ControlGroup, Button, InputGroup } from '@blueprintjs/core';\r\nimport { colorConverter } from '../../../store/features/theme/auxi';\r\n\r\nconst Menu = ({\r\n    unfold,\r\n    foldSelectedNodes,\r\n    foldAllDescendants,\r\n    changeNodeColor,\r\n    currentColor,\r\n    options,\r\n}: {\r\n    unfold: () => void;\r\n    foldSelectedNodes: () => void;\r\n    foldAllDescendants: () => void;\r\n    changeNodeColor: (color: string) => void;\r\n    currentColor: string;\r\n    options: { unfold: boolean; foldSelected: boolean; foldAllDescendants: boolean };\r\n}): JSX.Element => {\r\n    const [color, setColor] = useState(currentColor);\r\n\r\n    useEffect(() => {\r\n        setColor(currentColor);\r\n    }, [currentColor]);\r\n\r\n    return (\r\n        <div className=\"bp3-popover2-content\">\r\n            <ul id=\"menu\" className=\"bp3-menu\">\r\n                {options.unfold ? (\r\n                    <li className=\"\">\r\n                        <a className=\"bp3-menu-item\" onClick={() => unfold()}>\r\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-open\">\r\n                                <span> Unfold</span>\r\n                            </div>\r\n                        </a>\r\n                    </li>\r\n                ) : null}\r\n                {options.foldSelected ? (\r\n                    <li className=\"\">\r\n                        <a className=\"bp3-menu-item\" onClick={() => foldSelectedNodes()}>\r\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-off\">\r\n                                <span> Fold selected nodes</span>\r\n                            </div>\r\n                        </a>\r\n                    </li>\r\n                ) : null}\r\n                {options.foldAllDescendants ? (\r\n                    <li className=\"\">\r\n                        <a className=\"bp3-menu-item\" onClick={() => foldAllDescendants()}>\r\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-off\">\r\n                                <span> Fold all descendants</span>\r\n                            </div>\r\n                        </a>\r\n                    </li>\r\n                ) : null}\r\n                <li className=\"\">\r\n                    <a className=\"bp3-menu-item\">\r\n                        <div className=\"bp3-text-overflow-ellipsis bp3-fill\">\r\n                            <span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('red'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('orange'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('yellow'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('green'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('blue'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('purple'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('brown'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('black'))}> </span>\r\n                                <span onClick={() => changeNodeColor(colorConverter('white'))}> </span>\r\n                            </span>\r\n                        </div>\r\n                    </a>\r\n                </li>\r\n                <li className=\"\">\r\n                    <a className=\"bp3-menu-item\">\r\n                        <div className=\"bp3-text-overflow-ellipsis bp3-fill\">\r\n                            <ControlGroup\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                }}\r\n                                fill={true}\r\n                                vertical={false}\r\n                            >\r\n                                <InputGroup\r\n                                    placeholder={currentColor}\r\n                                    value={color}\r\n                                    onChange={(e) => setColor(e.target.value)}\r\n                                />\r\n                                <Button\r\n                                    icon=\"style\"\r\n                                    onClick={() => {\r\n                                        changeNodeColor(color);\r\n                                        setColor('');\r\n                                    }}\r\n                                    disabled={color.match(/^#([0-9a-f]{3}){1,2}$/i) === null}\r\n                                ></Button>\r\n                            </ControlGroup>\r\n                        </div>\r\n                    </a>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Menu;\r\n","import React, { Component } from 'react';\r\nimport { Stage, Layer } from 'react-konva';\r\nimport Konva from 'konva';\r\nimport dagre from 'dagre';\r\nimport Node from './VisualizerNode';\r\nimport Line from './VisualizerLine';\r\nimport Menu from './VisualizerMenu';\r\n\r\nimport {\r\n    NodeProps,\r\n    LineProps,\r\n    TreeNode,\r\n    CanvasPropsAndRedux,\r\n    NodeInterface,\r\n    ProofState,\r\n    ReduxState,\r\n} from '../../../interfaces/interfaces';\r\n\r\nimport '../../../scss/VisualizerCanvas.scss';\r\n\r\nimport { CanvasProps, CanvasState } from '../../../interfaces/interfaces';\r\nimport { connect } from 'react-redux';\r\nimport { selectProof, selectVisualInfo } from '../../../store/features/proof/proofSlice';\r\nimport {\r\n    hideNodes,\r\n    unhideNodes,\r\n    foldAllDescendants,\r\n    applyView,\r\n    setVisualInfo,\r\n} from '../../../store/features/proof/proofSlice';\r\nimport {\r\n    selectFindData,\r\n    findNode,\r\n    selectRenderData,\r\n    reRender,\r\n    addRenderCount,\r\n    blockRenderNewFile,\r\n} from '../../../store/features/externalCmd/externalCmd';\r\n\r\nconst nodeWidth = 300,\r\n    nodeHeight = 130;\r\n\r\nfunction handleWheel(e: Konva.KonvaEventObject<WheelEvent>): { stageScale: number; stageX: number; stageY: number } {\r\n    e.evt.preventDefault();\r\n\r\n    const scaleBy = 1.08;\r\n    const stage = e.target.getStage();\r\n    if (stage) {\r\n        const oldScale = stage.scaleX();\r\n        const pointerPosition = stage.getPointerPosition();\r\n        let x, y;\r\n\r\n        if (pointerPosition) {\r\n            [x, y] = [pointerPosition.x, pointerPosition.y];\r\n        } else {\r\n            [x, y] = [0, 0];\r\n        }\r\n\r\n        const mousePointTo = {\r\n            x: x / oldScale - stage.x() / oldScale,\r\n            y: y / oldScale - stage.y() / oldScale,\r\n        };\r\n\r\n        const newScale = e.evt.deltaY > 0 ? oldScale * scaleBy : oldScale / scaleBy;\r\n\r\n        return {\r\n            stageScale: newScale,\r\n            stageX: -(mousePointTo.x - x / newScale) * newScale,\r\n            stageY: -(mousePointTo.y - y / newScale) * newScale,\r\n        };\r\n    }\r\n    return {\r\n        stageScale: 1,\r\n        stageX: 0,\r\n        stageY: 0,\r\n    };\r\n}\r\n\r\nclass Canvas extends Component<CanvasPropsAndRedux, CanvasState> {\r\n    constructor(props: CanvasPropsAndRedux) {\r\n        super(props);\r\n        this.componentDidUpdate = this.componentDidUpdate.bind(this);\r\n        this.setNodeOnFocus = this.setNodeOnFocus.bind(this);\r\n\r\n        this.state = {\r\n            canvasSize: {\r\n                width: 520,\r\n                height: 300,\r\n            },\r\n            stage: {\r\n                stageScale: 1,\r\n                stageX: 0,\r\n                stageY: 0,\r\n            },\r\n            showingNodes: {},\r\n            showingEdges: {},\r\n            nodeOnFocus: NaN,\r\n            nodesSelected: [],\r\n            proof: [],\r\n            visualInfo: {},\r\n        };\r\n    }\r\n\r\n    static copyNodePosition = (\r\n        visualInfo: ProofState['visualInfo'],\r\n        showingNodes: CanvasState['showingNodes'],\r\n    ): ProofState['visualInfo'] => {\r\n        // Get the current position of the nodes and create a proofState with them included\r\n        const newVisualInfo: ProofState['visualInfo'] = {};\r\n        Object.keys(visualInfo).forEach((id) => {\r\n            const key = Number(id);\r\n\r\n            if (showingNodes[key]) {\r\n                newVisualInfo[key] = {\r\n                    ...visualInfo[key],\r\n                    x: showingNodes[key].props.x,\r\n                    y: showingNodes[key].props.y,\r\n                };\r\n            } else {\r\n                newVisualInfo[key] = {\r\n                    ...visualInfo[key],\r\n                };\r\n            }\r\n        });\r\n        return newVisualInfo;\r\n    };\r\n\r\n    static newNodeProps = (node: NodeInterface, visualInfos: ProofState['visualInfo']): NodeProps => {\r\n        const visualInfo = visualInfos[node.id];\r\n        return {\r\n            id: node.id,\r\n            conclusion: node.conclusion,\r\n            rule: node.rule,\r\n            args: node.args,\r\n            x: visualInfo.x,\r\n            y: visualInfo.y,\r\n            nHided: node.hiddenNodes ? node.hiddenNodes.length : 0,\r\n            nDescendants: node.descendants - 1,\r\n            hiddenNodes: node.hiddenNodes ? node.hiddenNodes.map((node) => node.id) : [],\r\n            dependencies: node.dependencies ? node.dependencies : [],\r\n            selected: visualInfo.selected,\r\n            color: visualInfo.color,\r\n            setNodeOnFocus: () => undefined,\r\n            toggleNodeSelection: () => undefined,\r\n            updateNodePosition: () => undefined,\r\n            openDrawer: () => undefined,\r\n            onDragEnd: () => undefined,\r\n            createTree: () => {\r\n                return [];\r\n            },\r\n        };\r\n    };\r\n\r\n    static getDerivedStateFromProps(props: CanvasPropsAndRedux, current_state: CanvasState) {\r\n        const proofChanged = JSON.stringify(current_state.proof) !== JSON.stringify(props.proof);\r\n        const visualInfoChanged = JSON.stringify(current_state.visualInfo) !== JSON.stringify(props.visualInfo);\r\n        const { nodeToFind, findOption } = props.nodeFindData;\r\n        const { count, fileChanged } = props.renderData;\r\n        const stage = current_state.stage;\r\n\r\n        // If there is a node to be found\r\n        if (nodeToFind > -1) {\r\n            // Is valid node\r\n            if (nodeToFind <= props.proof[props.proof.length - 1].id) {\r\n                // Change the stage position\r\n                const { x, y } = props.visualInfo[nodeToFind];\r\n                stage.stageX = current_state.canvasSize.width / 2 - (x + nodeWidth / 2) * stage.stageScale;\r\n                stage.stageY = current_state.canvasSize.height / 2 - (y + nodeHeight / 2) * stage.stageScale;\r\n\r\n                // Select the finded node\r\n                if (findOption) {\r\n                    props.setVisualInfo({\r\n                        ...props.visualInfo,\r\n                        [nodeToFind]: { ...props.visualInfo[nodeToFind], selected: true },\r\n                    });\r\n                }\r\n            }\r\n            // Reset the node finder\r\n            props.findNode({ nodeId: -1, option: false });\r\n        }\r\n\r\n        // If the proof or visual info changed or we have a new file being uploaded\r\n        if (proofChanged || visualInfoChanged || fileChanged) {\r\n            // Create the showing nodes array\r\n            const showingNodes: CanvasState['showingNodes'] = {};\r\n            props.proof.forEach((node, id) => {\r\n                showingNodes[node.id] = <Node key={id} {...Canvas.newNodeProps(node, props.visualInfo)} />;\r\n            });\r\n\r\n            // If has nodes and can render\r\n            if (showingNodes[0] && count < 2) {\r\n                props.addRenderCount();\r\n\r\n                const g = new dagre.graphlib.Graph();\r\n                g.setGraph({ rankdir: 'BT', ranker: 'tight-tree' });\r\n                g.setDefaultEdgeLabel(function () {\r\n                    return {};\r\n                });\r\n                props.proof.forEach((node) => {\r\n                    g.setNode(node.id.toString(), {\r\n                        width: nodeWidth + (node.dependencies.length ? 95 : 0),\r\n                        height: nodeHeight,\r\n                    });\r\n                    node.children.forEach((child) => {\r\n                        g.setEdge(child.toString(), node.id.toString());\r\n                    });\r\n                });\r\n                dagre.layout(g);\r\n\r\n                const xOffset = g.node('0').x - (showingNodes[0].props.x ? showingNodes[0].props.x : 0);\r\n                const yOffset = g.node('0').y - (showingNodes[0].props.y ? showingNodes[0].props.y : 0);\r\n                g.nodes().forEach((v) => {\r\n                    try {\r\n                        const { x, y } = g.node(v);\r\n                        const key = parseInt(v);\r\n                        showingNodes[key] = (\r\n                            <Node\r\n                                {...{\r\n                                    ...showingNodes[key].props,\r\n                                    x: x - xOffset,\r\n                                    y: y - yOffset,\r\n                                }}\r\n                            />\r\n                        );\r\n                    } catch (e) {\r\n                        console.log(e);\r\n                    }\r\n                });\r\n\r\n                props.setVisualInfo(Canvas.copyNodePosition(props.visualInfo, showingNodes));\r\n            }\r\n            // Reset the new file indicator if it's true\r\n            if (fileChanged) props.blockRenderNewFile();\r\n\r\n            return {\r\n                showingNodes: showingNodes,\r\n                showingEdges: {},\r\n                proof: props.proof,\r\n                visualInfo: props.visualInfo,\r\n                stage: stage,\r\n            };\r\n        }\r\n        return { stage: stage };\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        const { showingNodes } = this.state;\r\n        const { proof, visualInfo } = this.props;\r\n\r\n        const newShowingNodes: CanvasState['showingNodes'] = {};\r\n        proof.forEach((node, id) => {\r\n            newShowingNodes[node.id] = <Node key={id} {...Canvas.newNodeProps(node, visualInfo)} />;\r\n        });\r\n\r\n        this.setState({ proof: proof, showingNodes: newShowingNodes });\r\n\r\n        if (showingNodes[0]) {\r\n            const [width, height] = [window.innerWidth, window.innerHeight - 50];\r\n\r\n            // Make sure every time the Canvas is mounted the props are passed to the showing nodes\r\n            this.updateEdgesAndFuncs();\r\n\r\n            this.setState({\r\n                canvasSize: {\r\n                    width,\r\n                    height,\r\n                },\r\n                stage: {\r\n                    stageScale: 1,\r\n                    stageX: width / 2 - (showingNodes[0].props.x + 300 / 2),\r\n                    stageY: height / 10 - (showingNodes[0].props.y + 30 / 2),\r\n                },\r\n            });\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: CanvasPropsAndRedux) {\r\n        // If the proof changed\r\n        if (prevProps.proof !== this.props.proof) {\r\n            this.updateEdgesAndFuncs();\r\n        }\r\n    }\r\n\r\n    updateEdgesAndFuncs() {\r\n        const { showingNodes, showingEdges } = this.state;\r\n        const { proof } = this.props;\r\n\r\n        // Update edges\r\n        proof.forEach((node) => {\r\n            if (showingNodes[node.parents[0]]) {\r\n                node.parents.forEach((parent) => {\r\n                    showingEdges[`${node.id}->${parent}`] = Line(\r\n                        this.LineProps(\r\n                            `${node.id}->${parent}`,\r\n                            showingNodes[node.id].props,\r\n                            showingNodes[parent].props,\r\n                        ),\r\n                    );\r\n                });\r\n            }\r\n        });\r\n        Object.keys(showingNodes).forEach((nodeId: string) => {\r\n            // Make sure a function is updated once\r\n            if (!showingNodes[parseInt(nodeId)].props.setNodeOnFocus.length) {\r\n                const { openDrawer } = this.props;\r\n\r\n                // Set the node functions\r\n                showingNodes[parseInt(nodeId)] = (\r\n                    <Node\r\n                        {...{\r\n                            ...showingNodes[parseInt(nodeId)].props,\r\n                            setNodeOnFocus: this.setNodeOnFocus,\r\n                            toggleNodeSelection: this.toggleNodeSelection,\r\n                            updateNodePosition: this.updateNodePosition,\r\n                            openDrawer: openDrawer,\r\n                            onDragEnd: this.saveNodePosition,\r\n                            createTree: this.createTree,\r\n                        }}\r\n                    />\r\n                );\r\n            }\r\n        });\r\n        this.setState({ showingEdges, showingNodes });\r\n    }\r\n\r\n    /* NODE MENU ACTIONS */\r\n    foldAllDescendants = (): void => {\r\n        const { nodeOnFocus } = this.state;\r\n        const { foldAllDescendants, reRender } = this.props;\r\n\r\n        reRender();\r\n        foldAllDescendants(nodeOnFocus);\r\n        this.setState({ nodesSelected: [] });\r\n    };\r\n\r\n    foldSelectedNodes = (): void => {\r\n        const { nodesSelected } = this.state;\r\n        const { hideNodes, reRender } = this.props;\r\n\r\n        reRender();\r\n        hideNodes(nodesSelected);\r\n        this.setState({ nodesSelected: [] });\r\n    };\r\n\r\n    unfold = (): void => {\r\n        const { nodeOnFocus, proof } = this.state;\r\n        const { unhideNodes, reRender } = this.props;\r\n\r\n        // Get the pi node (to be unfold)\r\n        const obj = proof.find((node) => node.id === nodeOnFocus);\r\n        // Get the hidden nodes and their ids\r\n        const hiddenNodes = obj ? (obj.hiddenNodes ? obj.hiddenNodes : []) : [];\r\n        const hiddenIds = hiddenNodes ? hiddenNodes.map((node) => node.id) : [];\r\n\r\n        reRender();\r\n        unhideNodes({ pi: nodeOnFocus, hiddens: hiddenIds });\r\n\r\n        this.setState({ nodesSelected: [] });\r\n    };\r\n\r\n    changeNodeColor = (color: string): void => {\r\n        const { showingNodes, nodesSelected, nodeOnFocus } = this.state;\r\n        const { setVisualInfo } = this.props;\r\n        let { visualInfo } = this.props;\r\n\r\n        // Save the current position\r\n        nodesSelected.forEach((nodeId) => {\r\n            visualInfo = {\r\n                ...visualInfo,\r\n                [nodeId]: {\r\n                    ...visualInfo[nodeId],\r\n                    color: color,\r\n                    selected: false,\r\n                },\r\n            };\r\n        });\r\n        if (!nodesSelected.length && showingNodes[nodeOnFocus]) {\r\n            visualInfo = {\r\n                ...visualInfo,\r\n                [nodeOnFocus]: { ...visualInfo[nodeOnFocus], color: color, selected: false },\r\n            };\r\n        }\r\n\r\n        setVisualInfo(visualInfo);\r\n        this.setState({ nodesSelected: [] });\r\n    };\r\n\r\n    toggleNodeSelection = (id: number): void => {\r\n        let { nodesSelected } = this.state;\r\n        const { visualInfo, setVisualInfo } = this.props;\r\n\r\n        if (visualInfo[id].selected) {\r\n            nodesSelected = nodesSelected.filter((nodeId) => nodeId !== id);\r\n        } else {\r\n            nodesSelected.push(id);\r\n        }\r\n\r\n        // Save the current position\r\n        setVisualInfo({\r\n            ...visualInfo,\r\n            [id]: {\r\n                ...visualInfo[id],\r\n                selected: !visualInfo[id].selected,\r\n            },\r\n        });\r\n\r\n        this.setState({ nodesSelected });\r\n    };\r\n\r\n    /*TREE*/\r\n    createTree = (id: number): TreeNode[] => {\r\n        return this.props.createTree(this.state.proof, id);\r\n    };\r\n\r\n    /* UTILS */\r\n    setNodeOnFocus = (id: number): void => {\r\n        this.setState({ nodeOnFocus: id });\r\n    };\r\n\r\n    LineProps = (key: string, from: NodeProps, to: NodeProps): LineProps => ({\r\n        key,\r\n        points: [from.x + 150, from.y, to.x + 150, to.y + 105],\r\n    });\r\n\r\n    saveNodePosition = (): void => {\r\n        const { visualInfo, setVisualInfo } = this.props;\r\n        const { showingNodes } = this.state;\r\n\r\n        // Get the current position of the nodes and create a proofState with them included\r\n        setVisualInfo(Canvas.copyNodePosition(visualInfo, showingNodes));\r\n    };\r\n\r\n    updateNodePosition = (key: number, x: number, y: number): void => {\r\n        const { showingNodes, showingEdges } = this.state;\r\n\r\n        showingNodes[key] = <Node {...{ ...showingNodes[key].props, x, y }} />;\r\n\r\n        Object.keys(showingEdges)\r\n            .filter((edgeKey) => edgeKey.indexOf(key.toString()) !== -1)\r\n            .forEach((edge) => {\r\n                const [from, to] = edge.split('->').map((x) => parseInt(x));\r\n                showingEdges[edge] = Line(this.LineProps(edge, showingNodes[from].props, showingNodes[to].props));\r\n            });\r\n        this.setState({ showingNodes, showingEdges });\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        const { canvasSize, stage, showingNodes, showingEdges, nodesSelected, nodeOnFocus, proof } = this.state;\r\n        const color = showingNodes[nodeOnFocus] ? showingNodes[nodeOnFocus].props.color : '';\r\n        const found = proof.find((o) => o.id === nodeOnFocus);\r\n\r\n        return (\r\n            <div>\r\n                <Menu\r\n                    unfold={this.unfold}\r\n                    foldSelectedNodes={this.foldSelectedNodes}\r\n                    foldAllDescendants={this.foldAllDescendants}\r\n                    changeNodeColor={this.changeNodeColor}\r\n                    options={{\r\n                        unfold: showingNodes[nodeOnFocus] ? Boolean(showingNodes[nodeOnFocus].props.nHided) : false,\r\n                        foldSelected: nodesSelected.length && nodesSelected.includes(nodeOnFocus) ? true : false,\r\n                        foldAllDescendants:\r\n                            Boolean(found?.children.length) && !Boolean(found?.hiddenNodes?.length) && found?.id != 0,\r\n                    }}\r\n                    currentColor={color}\r\n                ></Menu>\r\n                <Stage\r\n                    draggable\r\n                    onDragMove={() => null}\r\n                    onDragEnd={() => null}\r\n                    width={canvasSize.width}\r\n                    height={canvasSize.height}\r\n                    onWheel={(e) => this.setState({ stage: handleWheel(e) })}\r\n                    scaleX={stage.stageScale}\r\n                    scaleY={stage.stageScale}\r\n                    x={stage.stageX}\r\n                    y={stage.stageY}\r\n                    onContextMenu={(e) => e.evt.preventDefault()}\r\n                >\r\n                    <Layer>\r\n                        {Object.keys(showingEdges).length > 0 &&\r\n                            Object.keys(showingEdges).map(function (key) {\r\n                                return showingEdges[key];\r\n                            })}\r\n                        {Object.keys(showingNodes).length > 0 &&\r\n                            Object.keys(showingNodes).map(\r\n                                (value: string): JSX.Element => showingNodes[parseInt(value)],\r\n                            )}\r\n                    </Layer>\r\n                </Stage>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: ReduxState, ownProps: CanvasProps) {\r\n    return {\r\n        proof: selectProof(state),\r\n        visualInfo: selectVisualInfo(state),\r\n        nodeFindData: selectFindData(state),\r\n        renderData: selectRenderData(state),\r\n        ...ownProps,\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    hideNodes,\r\n    unhideNodes,\r\n    foldAllDescendants,\r\n    applyView,\r\n    setVisualInfo,\r\n    findNode,\r\n    reRender,\r\n    addRenderCount,\r\n    blockRenderNewFile,\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Canvas);\r\n","export enum drawerHelpersKind {\r\n    RULE,\r\n    ARGS,\r\n    CONC,\r\n    ALL,\r\n}\r\n\r\nexport enum renderLetKind {\r\n    EXPAND,\r\n    REVERT,\r\n}\r\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport React, { useEffect, useReducer, useState } from 'react';\r\n\r\nimport { Classes, Tree, TreeNodeInfo } from '@blueprintjs/core';\r\nimport { TreeProps } from '../../interfaces/interfaces';\r\n\r\nconst VisualizerTree: React.FC<TreeProps> = ({ darkTheme, content, originalNodeInfo, setNodeInfo }: TreeProps) => {\r\n    // STATES:\r\n    const [, forceUpdate] = useReducer((x) => x + 1, 0);\r\n    const [nodes, setNodes] = useState(content);\r\n    const [selected, setSelected] = useState(NaN);\r\n\r\n    // USE EFFECT:\r\n    useEffect(() => setNodes(content), [content]);\r\n\r\n    // UTILS:\r\n    const forEachNode = (nodes: TreeNodeInfo[], callback: (node: TreeNodeInfo) => void) => {\r\n        if (nodes == null) {\r\n            return;\r\n        }\r\n\r\n        for (const node of nodes) {\r\n            callback(node);\r\n            forEachNode(node.childNodes ? node.childNodes : [], callback);\r\n        }\r\n    };\r\n\r\n    const handleNodeClick = (nodeData: any, _nodePath: number[], e: React.MouseEvent<HTMLElement>) => {\r\n        setNodeInfo(\r\n            selected !== nodeData.id\r\n                ? {\r\n                      rule: nodeData.rule ? nodeData.rule : '',\r\n                      args: nodeData.args ? nodeData.args : '',\r\n                      conclusion: nodeData.conclusion ? nodeData.conclusion : '',\r\n                      nHided: nodeData.nHided ? nodeData.nHided : 0,\r\n                      nDescendants: nodeData.descendants,\r\n                      hiddenNodes: nodeData.hiddenNodes,\r\n                      dependencies: nodeData.dependencies,\r\n                  }\r\n                : originalNodeInfo,\r\n        );\r\n        const originallySelected = nodeData.isSelected;\r\n\r\n        // Set all the nodes to be not selected\r\n        if (!e.shiftKey) forEachNode(nodes, (n) => (n.isSelected = false));\r\n\r\n        nodeData.isSelected = originallySelected == null ? true : !originallySelected;\r\n        setSelected(selected === nodeData.id ? NaN : nodeData.id);\r\n    };\r\n\r\n    const handleNodeCollapse = (nodeData: TreeNodeInfo) => {\r\n        nodeData.isExpanded = false;\r\n        forceUpdate();\r\n    };\r\n\r\n    const handleNodeExpand = (nodeData: TreeNodeInfo) => {\r\n        nodeData.isExpanded = true;\r\n        forceUpdate();\r\n    };\r\n\r\n    return (\r\n        <div style={{ backgroundColor: darkTheme ? '#394b59' : 'white' }}>\r\n            <Tree\r\n                contents={nodes}\r\n                onNodeClick={handleNodeClick}\r\n                onNodeCollapse={handleNodeCollapse}\r\n                onNodeExpand={handleNodeExpand}\r\n                className={Classes.ELEVATION_0}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VisualizerTree;\r\n","import React, { useState, useReducer } from 'react';\r\n\r\nimport { Icon, Collapse, Pre } from '@blueprintjs/core';\r\n\r\nimport '../../../scss/VisualizerDirectoryStyle.scss';\r\nimport { useAppSelector } from '../../../store/hooks';\r\nimport { selectTheme } from '../../../store/features/theme/themeSlice';\r\nimport { NodeInfo, DirectoryStyleProps } from '../../../interfaces/interfaces';\r\nimport { drawerHelpersKind } from '../../../interfaces/enum';\r\nimport VisualizerTree from '../../VisualizerTree/VisualizerTree';\r\n\r\nconst VisualizerDirectoryStyle: React.FC<DirectoryStyleProps> = ({\r\n    proofTree,\r\n    ruleHelper,\r\n    indent,\r\n    translate,\r\n}: DirectoryStyleProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const [nodeInfo, setNodeInfo] = useState<NodeInfo>({\r\n        rule: '',\r\n        args: '',\r\n        conclusion: '',\r\n        nHided: 0,\r\n        nDescendants: 0,\r\n        hiddenNodes: [],\r\n        dependencies: [],\r\n    });\r\n    const [[ruleHelperIsOpen, argsHelperIsOpen, concHelperIsOpen], dispatchHelper] = useReducer(\r\n        (state: boolean[], action: { type: drawerHelpersKind; payload: boolean }): boolean[] => {\r\n            const { type, payload } = action;\r\n\r\n            // Act over all the positions\r\n            if (type === drawerHelpersKind.ALL) {\r\n                for (let i = 0; i < state.length; i++) {\r\n                    state[i] = payload;\r\n                }\r\n            }\r\n            // If wanna set a position\r\n            else if (payload) {\r\n                // Reset everything and set the wanted\r\n                for (let i = 0; i < state.length; i++) {\r\n                    state[i] = i === type ? payload : false;\r\n                }\r\n            }\r\n            // If wanna only reset a position\r\n            else state[type] = payload;\r\n\r\n            return [...state];\r\n        },\r\n        // Rule, args, conclusion\r\n        [false, false, false],\r\n    );\r\n\r\n    const nodeInfoTable = () => {\r\n        return (\r\n            <table\r\n                id=\"table-node-info\"\r\n                className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\r\n                style={{ width: '100%' }}\r\n            >\r\n                <thead>\r\n                    <tr>\r\n                        <th>Property</th>\r\n                        <th>Value</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr>\r\n                        <td>\r\n                            <strong>RULE </strong>\r\n                            <Icon\r\n                                id=\"icon\"\r\n                                icon=\"help\"\r\n                                onClick={() => {\r\n                                    dispatchHelper({ type: drawerHelpersKind.RULE, payload: !ruleHelperIsOpen });\r\n                                }}\r\n                            ></Icon>\r\n                        </td>\r\n                        <td>\r\n                            {nodeInfo.rule}\r\n                            <Collapse isOpen={ruleHelperIsOpen}>\r\n                                <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                    {ruleHelper(nodeInfo.rule)}\r\n                                </Pre>\r\n                            </Collapse>\r\n                        </td>\r\n                    </tr>\r\n\r\n                    {nodeInfo.args && (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>ARGS</strong>{' '}\r\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\r\n                                    <Icon\r\n                                        id=\"icon\"\r\n                                        icon=\"translate\"\r\n                                        onClick={() => {\r\n                                            dispatchHelper({\r\n                                                type: drawerHelpersKind.ARGS,\r\n                                                payload: !argsHelperIsOpen,\r\n                                            });\r\n                                        }}\r\n                                    ></Icon>\r\n                                ) : null}\r\n                            </td>\r\n                            <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                                {nodeInfo.args}\r\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\r\n                                    <Collapse isOpen={argsHelperIsOpen}>\r\n                                        <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                            {indent(translate(nodeInfo.args))}\r\n                                        </Pre>\r\n                                    </Collapse>\r\n                                ) : null}\r\n                            </td>\r\n                        </tr>\r\n                    )}\r\n\r\n                    <tr>\r\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                            <strong>CONCLUSION</strong>{' '}\r\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\r\n                                <Icon\r\n                                    id=\"icon\"\r\n                                    icon=\"translate\"\r\n                                    onClick={() => {\r\n                                        dispatchHelper({ type: drawerHelpersKind.CONC, payload: !concHelperIsOpen });\r\n                                    }}\r\n                                ></Icon>\r\n                            ) : null}\r\n                        </td>\r\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                            {nodeInfo.conclusion}\r\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\r\n                                <Collapse isOpen={concHelperIsOpen}>\r\n                                    <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                        {indent(translate(nodeInfo.conclusion))}\r\n                                    </Pre>\r\n                                </Collapse>\r\n                            ) : null}\r\n                        </td>\r\n                    </tr>\r\n\r\n                    {nodeInfo.nDescendants ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>#DESCENDANTS</strong>\r\n                            </td>\r\n                            <td>{nodeInfo.nDescendants}</td>\r\n                        </tr>\r\n                    ) : null}\r\n\r\n                    {nodeInfo.nHided ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>#HIDDEN</strong>\r\n                            </td>\r\n                            <td>{`[${nodeInfo.hiddenNodes.map((node) => ' ' + node)} ]`}</td>\r\n                        </tr>\r\n                    ) : null}\r\n                    {nodeInfo.dependencies.length ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>DEPENDENCIES</strong>\r\n                            </td>\r\n                            <td>{`${nodeInfo.dependencies.map(\r\n                                (dependency) => ` ${dependency.piId}: [${dependency.depsId.map((dep) => ' ' + dep)} ] `,\r\n                            )}`}</td>\r\n                        </tr>\r\n                    ) : null}\r\n                </tbody>\r\n            </table>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className=\"dir-style\"\r\n            style={{\r\n                backgroundColor: darkTheme ? 'rgb(57, 75, 89)' : 'white',\r\n                height:\r\n                    window.innerHeight - (document.getElementsByClassName('bp3-navbar')[0] as HTMLElement).offsetHeight,\r\n            }}\r\n        >\r\n            <div\r\n                style={{\r\n                    width: '50%',\r\n                    height: '100%',\r\n                    float: 'left',\r\n                    clear: 'none',\r\n                    borderRight: '1px solid black',\r\n                    overflow: 'auto',\r\n                }}\r\n            >\r\n                <VisualizerTree\r\n                    darkTheme={darkTheme}\r\n                    content={proofTree}\r\n                    setNodeInfo={setNodeInfo}\r\n                    originalNodeInfo={{\r\n                        rule: '',\r\n                        args: '',\r\n                        conclusion: '',\r\n                        nHided: 0,\r\n                        nDescendants: 0,\r\n                        hiddenNodes: [],\r\n                        dependencies: [],\r\n                    }}\r\n                ></VisualizerTree>\r\n            </div>\r\n            <div\r\n                style={{\r\n                    width: '50%',\r\n                    height: '100%',\r\n                    float: 'left',\r\n                    clear: 'none',\r\n                }}\r\n            >\r\n                {nodeInfoTable()}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VisualizerDirectoryStyle;\r\n","interface Line {\r\n    value: string;\r\n    indentLevel: number;\r\n}\r\n\r\nclass Let {\r\n    name: string;\r\n    value: string;\r\n    lines: Line[];\r\n    biggerID: number;\r\n    isExpanded: boolean;\r\n    externalLets: { [key: string]: { let: Let; idx: number[] } };\r\n\r\n    constructor(name: string, letText: string, letsList: { [key: string]: Let }, indices: { [key: number]: string }) {\r\n        this.name = name;\r\n        this.value = letText;\r\n        this.lines = [{ value: letText, indentLevel: 0 }];\r\n        this.biggerID = 0;\r\n        this.isExpanded = false;\r\n\r\n        this.externalLets = {};\r\n        Object.keys(indices).forEach((key) => {\r\n            const numKey = Number(key);\r\n            const letName = indices[numKey];\r\n            this.externalLets[letName] = {\r\n                let: letsList[letName],\r\n                idx: this.externalLets[letName] ? [...this.externalLets[letName].idx, numKey] : [numKey],\r\n            };\r\n        });\r\n    }\r\n\r\n    getTextWidth = (text: string, font: string): number => {\r\n        const canvas = document.createElement('canvas');\r\n        const context = canvas.getContext('2d');\r\n        let size = 0;\r\n        if (context) {\r\n            context.font = font;\r\n            size = context.measureText(text).width;\r\n        }\r\n        return size;\r\n    };\r\n\r\n    expandValue = (shouldUpdate = false): string => {\r\n        const keyList = Object.keys(this.externalLets).map((key) => this.externalLets[key].let.name);\r\n        let letText = this.value;\r\n\r\n        // Iterate from the last to the first external let\r\n        for (let i = keyList.length - 1; i >= 0; i--) {\r\n            const letName = keyList[i];\r\n\r\n            // For each let, iterate through all the indexes they show up inside the string\r\n            for (let k = this.externalLets[letName].idx.length - 1; k >= 0; k--) {\r\n                const idx = this.externalLets[letName].idx[k];\r\n\r\n                // Expand all the terms\r\n                letText =\r\n                    letText.substring(0, idx) +\r\n                    this.externalLets[letName].let.expandValue() +\r\n                    letText.substring(idx + letName.length, letText.length);\r\n            }\r\n        }\r\n        if (shouldUpdate) {\r\n            this.lines = [{ value: letText, indentLevel: 0 }];\r\n            this.biggerID = 0;\r\n        }\r\n        return letText;\r\n    };\r\n\r\n    expandPartialy = (externalRef: Let, letIdx: number): string => {\r\n        const key = externalRef.name;\r\n        const indentedText = this.printLines();\r\n\r\n        let lastLine = 0,\r\n            count = 0,\r\n            i;\r\n        // Iterates through the first lines until the point we reach the changed line\r\n        for (i = 0; i < this.lines.length; i++) {\r\n            lastLine = this.lines[i].value.length + 4 * this.lines[i].indentLevel + 1;\r\n            count += lastLine;\r\n            if (letIdx < count) break;\r\n        }\r\n        // New index (points to the start of the line content (ignores initial indent white space))\r\n        const newIdx = letIdx - (count - lastLine + 4 * this.lines[i].indentLevel);\r\n\r\n        // Update the new line to the new content\r\n        this.lines[i].value =\r\n            this.lines[i].value.substring(0, newIdx) +\r\n            externalRef.value +\r\n            this.lines[i].value.substring(newIdx + key.length, this.lines[i].value.length);\r\n\r\n        // Returns the indented text with the content to be replaced\r\n        return (\r\n            indentedText.substring(0, letIdx) +\r\n            externalRef.value +\r\n            indentedText.substring(letIdx + key.length, indentedText.length)\r\n        );\r\n    };\r\n\r\n    shrinkValue = (): string => {\r\n        this.lines = [{ value: this.value, indentLevel: 0 }];\r\n        this.biggerID = 0;\r\n        return this.value;\r\n    };\r\n\r\n    fitsTheWindow = (windowSize: number, font: string): boolean => {\r\n        const line = this.lines[this.biggerID];\r\n        const size = this.getTextWidth(`${'    '.repeat(line.indentLevel)}${line.value}`, font);\r\n        return size < windowSize;\r\n    };\r\n\r\n    indent = (windowSize: number, mode: boolean, font: string): string => {\r\n        let someDoesntFit;\r\n        if (mode) someDoesntFit = true;\r\n        else someDoesntFit = this.getTextWidth(this.lines[this.biggerID].value, font) < windowSize ? false : true;\r\n\r\n        // While there are lines that doesn't fit the window size\r\n        while (someDoesntFit) {\r\n            const { lines, biggerID } = this;\r\n            const newLines: Line[] = [];\r\n            const thisLevel = lines[biggerID].indentLevel;\r\n            const thisLine = lines[biggerID].value;\r\n\r\n            let lastSpace = -1,\r\n                lastUsedSpace = -1,\r\n                lastOpenParenthesis = -1,\r\n                indent = lines[biggerID].indentLevel - 1,\r\n                biggestSize = 0,\r\n                newBiggerID = 0;\r\n\r\n            // Iterate through the line and calculate the indentation levels\r\n            for (let i = 0; i < thisLine.length; i++) {\r\n                const c = thisLine[i];\r\n                // Opening parenthesis\r\n                if (c === '(') {\r\n                    indent++;\r\n                    // If it's one of the arguments of the operation\r\n                    if (indent === thisLevel + 1) lastOpenParenthesis = i;\r\n                }\r\n                // Closing parenthesis\r\n                else if (c === ')') {\r\n                    // If it's the end of this line\r\n                    if (indent === thisLevel) {\r\n                        // If the last argument was not inserted\r\n                        if (thisLine[i - 1] !== ')') {\r\n                            newLines.push({\r\n                                value: thisLine.substring(lastSpace + 1, i),\r\n                                indentLevel: indent + 1,\r\n                            });\r\n                        }\r\n                        newLines.push({ value: ')', indentLevel: indent });\r\n                    }\r\n                    // If it's the end of this argument\r\n                    else if (indent === thisLevel + 1) {\r\n                        newLines.push({\r\n                            value: thisLine.substring(lastOpenParenthesis, i + 1),\r\n                            indentLevel: indent,\r\n                        });\r\n                    }\r\n                    indent--;\r\n                }\r\n                // If a new space is detected in the current identation level\r\n                //   and the last argument is not between parenthesis\r\n                else if (c === ' ') {\r\n                    lastSpace = i;\r\n\r\n                    if (indent === thisLevel) {\r\n                        if (thisLine[i - 1] !== ')') {\r\n                            newLines.push({\r\n                                value: thisLine.substring(lastUsedSpace + 1, i),\r\n                                indentLevel: newLines.length ? indent + 1 : indent,\r\n                            });\r\n                        }\r\n                        lastUsedSpace = i;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Insert new lines if happend some indentation\r\n            if (newLines.length > 0) this.lines.splice(biggerID, 1, ...newLines);\r\n\r\n            // Find the new biggest line\r\n            this.lines.forEach((line, id) => {\r\n                // Get the size of this new line\r\n                const thisSize = this.getTextWidth(`${'    '.repeat(line.indentLevel)}${line.value}`, font);\r\n                if (thisSize > biggestSize) {\r\n                    biggestSize = thisSize;\r\n                    newBiggerID = id;\r\n                }\r\n            });\r\n\r\n            this.biggerID = newBiggerID;\r\n\r\n            // If the biggest size fits the window or no new line was found (minimal indentation)\r\n            if (biggestSize < windowSize || newLines.length < 1) someDoesntFit = false;\r\n        }\r\n        return this.printLines();\r\n    };\r\n\r\n    groupUp = (): string => {\r\n        let original = '';\r\n        // Group up all the lines into one single string\r\n        this.lines.forEach((line, id, self) => {\r\n            original += line.value;\r\n            if (id < self.length - 1 && self[id + 1].value !== ')') {\r\n                original += ' ';\r\n            }\r\n        });\r\n        return original;\r\n    };\r\n\r\n    printLines = (): string => {\r\n        return this.lines.reduce((ac, line) => (ac += `${'    '.repeat(line.indentLevel)}${line.value}\\n`), '');\r\n    };\r\n}\r\n\r\nexport default Let;\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { LetRenderProps } from '../../interfaces/interfaces';\r\nimport { renderLetKind } from '../../interfaces/enum';\r\nimport Let from './let';\r\nimport { Pre } from '@blueprintjs/core';\r\n\r\nconst font = '13px monospace';\r\n\r\nconst LetRender: React.FC<LetRenderProps> = ({\r\n    id,\r\n    toRender,\r\n    letMap,\r\n    shouldExpand,\r\n    shouldRevert,\r\n    dispatchExpansion,\r\n}: LetRenderProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const widthRef = useRef(0);\r\n    const [resizeMode, setResizeMode] = useState(0);\r\n    const [letMapS, setLetMapS] = useState(\r\n        (() => {\r\n            const newMap = { ...letMap };\r\n            if (toRender[0] !== '(' && toRender[toRender.length] !== ')') {\r\n                toRender = `(${toRender})`;\r\n            }\r\n            newMap['this'] = toRender;\r\n            return newMap;\r\n        })(),\r\n    );\r\n\r\n    const initializeLet = (key = 'this', lets: { [key: string]: Let } = {}) => {\r\n        const currentLet = letMapS[key];\r\n        const indices: { [key: number]: string } = {};\r\n\r\n        // Finds all occurences of let in the currentLet\r\n        [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n            if (match.index) indices[match.index] = match[0];\r\n        });\r\n\r\n        // Call recursive for all the external lets\r\n        Object.keys(indices).forEach((indice) => {\r\n            initializeLet(indices[Number(indice)], lets);\r\n        });\r\n\r\n        // If this let was not created yet\r\n        if (Object.keys(lets).indexOf(key) === -1) {\r\n            lets[key] = new Let(key, currentLet, lets, indices);\r\n        }\r\n\r\n        return lets;\r\n    };\r\n    const letsRef = useRef<{ [key: string]: Let }>(initializeLet());\r\n\r\n    // ComponentDidMount\r\n    useEffect(() => {\r\n        // Handler to call on window resize and set the value column width\r\n        function handleResize() {\r\n            const width = widthRef.current;\r\n\r\n            const newWidth = document.getElementsByClassName(`let-render-${id}`)[0].clientWidth - 30;\r\n            width === newWidth ? setResizeMode(1) : width > newWidth ? setResizeMode(0) : setResizeMode(2);\r\n\r\n            widthRef.current = newWidth;\r\n        }\r\n\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // Expand\r\n        if (shouldExpand) {\r\n            expandAll('this');\r\n            dispatchExpansion({ type: renderLetKind.EXPAND, payload: false });\r\n        }\r\n        // Revert\r\n        else if (shouldRevert) {\r\n            revertLet('this');\r\n            dispatchExpansion({ type: renderLetKind.REVERT, payload: false });\r\n        }\r\n    }, [shouldExpand, shouldRevert]);\r\n\r\n    const expandLet = (parent: string, key: string, letIdx: number) => {\r\n        const lets = letsRef.current;\r\n\r\n        const externalRef = lets[key];\r\n        lets[parent].isExpanded = true;\r\n        letMapS[parent] = lets[parent].expandPartialy(externalRef, letIdx);\r\n        setLetMapS({ ...letMapS });\r\n    };\r\n\r\n    const expandAll = (key: string) => {\r\n        const lets = letsRef.current;\r\n\r\n        lets[key].isExpanded = true;\r\n        letMapS[key] = lets[key].expandValue(true);\r\n        setLetMapS({ ...letMapS });\r\n    };\r\n\r\n    const revertLet = (key: string) => {\r\n        const lets = letsRef.current;\r\n\r\n        // Only when is expanded\r\n        if (lets[key].isExpanded) {\r\n            lets[key].isExpanded = false;\r\n            letMapS[key] = lets[key].shrinkValue();\r\n            setLetMapS({ ...letMapS });\r\n        }\r\n    };\r\n\r\n    const renderLet = (): JSX.Element => {\r\n        const lets = letsRef.current;\r\n        const width = widthRef.current;\r\n        const key = 'this';\r\n\r\n        // Waits for the width to be updated and the DOM element to be updated\r\n        if (width) {\r\n            let currentLet = letMapS[key];\r\n            let indices: { [key: number]: string } = {};\r\n\r\n            // Finds all occurences of let in the currentLet\r\n            [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                if (match.index !== undefined) indices[match.index] = match[0];\r\n            });\r\n\r\n            // If doesn't fits, then indent\r\n            if (!lets[key].fitsTheWindow(width, font)) {\r\n                currentLet = lets[key].indent(width, true, font);\r\n                letMapS[key] = currentLet;\r\n\r\n                indices = {};\r\n                // Finds all occurences of let in the currentLet after indentation\r\n                [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                    if (match.index) indices[match.index] = match[0];\r\n                });\r\n            }\r\n            // If fits\r\n            else {\r\n                // Only in the momment the page size is growing and the line is broken\r\n                if (resizeMode >= 0 && lets[key].lines.length > 1) {\r\n                    // Reset the line\r\n                    lets[key].lines = [\r\n                        { value: lets[key].isExpanded ? lets[key].groupUp() : lets[key].value, indentLevel: 0 },\r\n                    ];\r\n                    lets[key].biggerID = 0;\r\n\r\n                    // Indent it again\r\n                    currentLet = lets[key].indent(width, false, font);\r\n                    letMapS[key] = currentLet;\r\n\r\n                    indices = {};\r\n                    // Finds all occurences of let in the currentLet after indentation\r\n                    [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                        if (match.index) indices[match.index] = match[0];\r\n                    });\r\n                }\r\n            }\r\n\r\n            const arr: (JSX.Element | string)[] = [];\r\n            let start = 0;\r\n\r\n            // Slice the currentLet into an array with strings and JSX elements\r\n            Object.keys(indices).forEach((index, i, self) => {\r\n                const idx = Number(index);\r\n                const thisLet = indices[idx];\r\n\r\n                // Add the elements to the arr\r\n                arr.push(currentLet.substring(start, idx));\r\n                arr.push(\r\n                    <a\r\n                        className={darkTheme ? 'let-literal-or' : 'let-literal'}\r\n                        onClick={() => {\r\n                            expandLet(key, thisLet, idx);\r\n                        }}\r\n                    >\r\n                        {thisLet}\r\n                    </a>,\r\n                );\r\n                // Defines a new start\r\n                start = idx + thisLet.length;\r\n\r\n                // If it's the last let\r\n                if (i === self.length - 1) {\r\n                    arr.push(currentLet.substring(start, currentLet.length));\r\n                }\r\n            });\r\n\r\n            // If there is a let in this current let\r\n            if (Object.keys(indices).length) {\r\n                return (\r\n                    <span className=\"let-instance\" style={{ overflowWrap: 'break-word' }}>\r\n                        {arr}\r\n                    </span>\r\n                );\r\n            } else {\r\n                return (\r\n                    <span className=\"let-instance\" style={{ overflowWrap: 'break-word' }}>\r\n                        {currentLet}\r\n                    </span>\r\n                );\r\n            }\r\n        }\r\n        return <></>;\r\n    };\r\n\r\n    return (\r\n        <Pre\r\n            className={`let-render-${id}`}\r\n            style={{ maxHeight: '300px', overflow: 'auto', margin: '0', whiteSpace: 'pre-wrap' }}\r\n        >\r\n            {renderLet()}\r\n        </Pre>\r\n    );\r\n};\r\n\r\nexport default LetRender;\r\n","/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport React, { useEffect, useReducer, useState } from 'react';\r\n\r\nimport { Drawer, Position, Classes, Icon, Collapse, Pre, TreeNodeInfo } from '@blueprintjs/core';\r\nimport Canvas from './Canvas/VisualizerCanvas';\r\nimport VisualizerTree from '../VisualizerTree/VisualizerTree';\r\nimport VisualizerDirectoryStyle from './VisualizerDirectoryStyle/VisualizerDirectoryStyle';\r\n\r\nimport '../../scss/VisualizerStage.scss';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport { selectDot, selectFileCount } from '../../store/features/file/fileSlice';\r\nimport { selectStyle, selectLetMap, selectOriginalProof } from '../../store/features/proof/proofSlice';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { NodeInfo, NodeInterface, TreeNode } from '../../interfaces/interfaces';\r\nimport { renderLetKind, drawerHelpersKind } from '../../interfaces/enum';\r\nimport LetRender from '../VisualizerLetDrawer/LetRender';\r\n\r\nfunction ruleHelper(rule: string) {\r\n    switch (rule.split(' ')[0]) {\r\n        case '':\r\n            return 'This node hides some parts of the proof, you can unfold it.';\r\n        case 'ASSUME':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Assumption (a leaf)\\nChildren: none\\nArguments: (F)\\n--------------\\nConclusion: F\\n\\nThis rule has special status, in that an application of assume is an open leaf in a proof that is not (yet) justified. An assume leaf is analogous to a free variable in a term, where we say \"F is a free assumption in proof P\" if it contains an application of F that is not  bound by SCOPE.'\r\n            );\r\n        case 'SCOPE':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Scope (a binder for assumptions)\\nChildren: (P:F)\\nArguments: (F1, ..., Fn)\\n--------------\\nConclusion: (=> (and F1 ... Fn) F) or (not (and F1 ... Fn)) if F is false\\n\\nThis rule has a dual purpose with ASSUME. It is a way to close assumptions in a proof. We require that F1 ... Fn are free assumptions in P and say that F1, ..., Fn are not free in (SCOPE P). In other words, they are bound by this application. For example, the proof node: (SCOPE (ASSUME F) :args F) has the conclusion (=> F F) and has no free assumptions. More generally, a proof with no free assumptions always concludes a valid formula.'\r\n            );\r\n        case 'SUBS':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Substitution\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (t, (ids)?)\\n---------------------------------------------------------------\\nConclusion: (= t t*sigma{ids}(Fn)*...*sigma{ids}(F1))\\nwhere sigma{ids}(Fi) are substitutions, which notice are applied in reverse order. Notice that ids is a MethodId identifier, which determines how to convert the formulas F1, ..., Fn into substitutions.'\r\n            );\r\n        case 'REWRITE':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Rewrite\\nChildren: none\\nArguments: (t, (idr)?)\\n----------------------------------------\\nConclusion: (= t Rewriter{idr}(t))\\nwhere idr is a MethodId identifier, which determines the kind of rewriter to apply, e.g. Rewriter::rewrite.'\r\n            );\r\n        case 'EVALUATE':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Evaluate\\nChildren: none\\n\\nArguments: (t)\\n----------------------------------------\\nConclusion: (= t Evaluator::evaluate(t))\\nNote this is equivalent to: (REWRITE t MethodId::RW_EVALUATE)'\r\n            );\r\n        case 'MACRO_SR_EQ_INTRO':\r\n            return (\r\n                rule +\r\n                \"\\n\\nIn this rule, we provide a term t and conclude that it is equal to its rewritten form under a (proven) substitution.\\n\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (t, (ids (ida (idr)?)?)?)\\n---------------------------------------------------------------\\nConclusion: (= t t')\\nwhere t' is Rewriter{idr}(t*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1))\\n\\nIn other words, from the point of view of Skolem forms, this rule transforms t to t' by standard substitution + rewriting.\\n\\nThe arguments ids, ida and idr are optional and specify the identifier of the substitution, the substitution application and rewriter respectively to be used.\"\r\n            );\r\n        case 'MACRO_SR_PRED_INTRO':\r\n            return (\r\n                rule +\r\n                \"\\n\\nIn this rule, we provide a formula F and conclude it, under the condition that it rewrites to true under a proven substitution.\\n\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (F, (ids (ida (idr)?)?)?)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)) == true where ids and idr are method identifiers.\\n\\nMore generally, this rule also holds when: Rewriter::rewrite(toOriginal(F')) == true where F' is the result of the left hand side of the equality above. Here, notice that we apply rewriting on the original form of F', meaning that this rule may conclude an F whose Skolem form is justified by the definition of its (fresh) Skolem variables. For example, this rule may justify the conclusion (= k t) where k is the purification Skolem for t, e.g. where the original form of k is t.\\n\\nFurthermore, notice that the rewriting and substitution is applied only within the side condition, meaning the rewritten form of the original form of F does not escape this rule.\"\r\n            );\r\n        case 'MACRO_SR_PRED_ELIM':\r\n            return (\r\n                rule +\r\n                \"\\n\\nIn this rule, if we have proven a formula F, then we may conclude its rewritten form under a proven substitution.\\n\\nChildren: (P1:F, P2:F1, ..., P_{n+1}:Fn)\\nArguments: ((ids (ida (idr)?)?)?)\\n----------------------------------------\\nConclusion: F'\\nwhere F' is Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)). where ids and idr are method identifiers.\\n\\nWe rewrite only on the Skolem form of F, similar to MACRO_SR_EQ_INTRO.\"\r\n            );\r\n        case 'MACRO_SR_PRED_TRANSFORM':\r\n            return (\r\n                rule +\r\n                \"\\n\\nIn this rule, if we have proven a formula F, then we may provide a formula G and conclude it if F and G are equivalent after rewriting under a proven substitution.\\n\\nChildren: (P1:F, P2:F1, ..., P_{n+1}:Fn)\\nArguments: (G, (ids (ida (idr)?)?)?)\\n----------------------------------------\\nConclusion: G\\nwhere Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)) == Rewriter{idr}(G*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1))\\n\\nMore generally, this rule also holds when:\\n  Rewriter::rewrite(toOriginal(F')) == Rewriter::rewrite(toOriginal(G'))\\nwhere F' and G' are the result of each side of the equation above. Here, original forms are used in a similar manner to MACRO_SR_PRED_INTRO above.\"\r\n            );\r\n        case 'REMOVE_TERM_FORMULA_AXIOM':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Remove Term Formulas Axiom\\nChildren: none\\nArguments: (t)\\n---------------------------------------------------------------\\nConclusion: RemoveTermFormulas::getAxiomFor(t).'\r\n            );\r\n        case 'THEORY_LEMMA':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Theory lemma\\nChildren: none\\nArguments: (F, tid)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is a (T-valid) theory lemma generated by theory with TheoryId tid. This is a \"coarse-grained\" rule that is used as a placeholder if a theory did not provide a proof for a lemma or conflict.'\r\n            );\r\n        case 'THEORY_REWRITE':\r\n            return (\r\n                rule +\r\n                \"\\n\\n======== Theory Rewrite\\nChildren: none\\nArguments: (F, tid, rid)\\n----------------------------------------\\nConclusion: F\\nwhere F is an equality of the form (= t t') where t' is obtained by applying the kind of rewriting given by the method identifier rid, which is one of: { RW_REWRITE_THEORY_PRE, RW_REWRITE_THEORY_POST, RW_REWRITE_EQ_EXT } Notice that the checker for this rule does not replay the rewrite to ensure correctness, since theory rewriter methods are not static. For example, the quantifiers rewriter involves constructing new bound variables that are not guaranteed to be consistent on each call.\"\r\n            );\r\n        case 'PREPROCESS':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = t' where t was replaced by t' based on some preprocessing pass, or otherwise F was added as a new assertion by some preprocessing pass.\"\r\n            );\r\n        case 'PREPROCESS_LEMMA':\r\n            return (\r\n                rule +\r\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F was added as a new assertion by some preprocessing pass.'\r\n            );\r\n        case 'THEORY_PREPROCESS':\r\n            return (\r\n                rule +\r\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = Theory::ppRewrite(t) for some theory. Notice this is a \"trusted\" rule.'\r\n            );\r\n        case 'THEORY_PREPROCESS_LEMMA':\r\n            return (\r\n                rule +\r\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F was added as a new assertion by theory preprocessing.'\r\n            );\r\n        case 'THEORY_EXPAND_DEF':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = t' where t was replaced by t' based on theory expand definitions.\"\r\n            );\r\n        case 'WITNESS_AXIOM':\r\n            return (\r\n                rule +\r\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an existential (exists ((x T)) (P x)) used for introducing a witness term (witness ((x T)) (P x)).'\r\n            );\r\n        case 'TRUST_REWRITE':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of rewriting that could not be replayed during proof postprocessing.\"\r\n            );\r\n        case 'TRUST_SUBS':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of substitution that could not be replayed during proof postprocessing.\"\r\n            );\r\n        case 'TRUST_SUBS_MAP':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of substitution that could not be determined by the TrustSubstitutionMap. This inference may contain possibly multiple children corresponding to the formulas used to derive the substitution.\"\r\n            );\r\n        case 'TRUST_SUBS_EQ':\r\n            return (\r\n                rule +\r\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is a solved equality of the form (= x t) derived as the solved form of F', where F' is given as a child.\"\r\n            );\r\n        case 'SAT_REFUTATION':\r\n            return (\r\n                rule +\r\n                '\\n\\n========= SAT Refutation for assumption-based unsat cores\\nChildren: (P1, ..., Pn)\\nArguments: none\\n---------------------\\nConclusion: false\\nNote: P1, ..., Pn correspond to the unsat core determined by the SAT solver.'\r\n            );\r\n        case 'RESOLUTION':\r\n            return (\r\n                rule +\r\n                \"\\n\\n======== Resolution\\nChildren:\\n(P1:C1, P2:C2)\\nArguments: (pol, L)\\n---------------------\\nConclusion: C\\nwhere\\n- C1 and C2 are nodes viewed as clauses, i.e., either an OR node with each children viewed as a literal or a node viewed as a literal. Note that an OR node could also be a literal.\\n- pol is either true or false, representing the polarity of the pivot on the first clause\\n- L is the pivot of the resolution, which occurs as is (resp. under a NOT) in C1 and negatively (as is) in C2 if pol = true (pol = false).\\nC is a clause resulting from collecting all the literals in C1, minus the first occurrence of the pivot or its negation, and C2, minus the first occurrence of the pivot or its negation, according to the policy above. If the resulting clause has a single literal, that literal itself is the result; if it has no literals, then the result is false; otherwise it's an OR node of the resulting literals.\\n\\nNote that it may be the case that the pivot does not occur in the clauses. In this case the rule is not unsound, but it does not correspond to resolution but rather to a weakening of the clause that did not have a literal eliminated.\"\r\n            );\r\n        case 'CHAIN_RESOLUTION':\r\n            return (\r\n                rule +\r\n                \"\\n\\n======== N-ary Resolution\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined above\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined above\\n- let C_1' = C_1 (from P1),\\n- for each i > 1, let C_i' = C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C = C_n'\"\r\n            );\r\n        case 'FACTORING':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Factoring\\nChildren: (P:C1)\\nArguments: ()\\n---------------------\\nConclusion: C2\\nwhere Set representations of C1 and C2 is the same and the number of literals in C2 is smaller than that of C1'\r\n            );\r\n        case 'REORDERING':\r\n            return (\r\n                rule +\r\n                '\\n\\n======== Reordering\\nChildren: (P:C1)\\nArguments: (C2)\\n---------------------\\nConclusion: C2\\nwhere Set representations of C1 and C2 are the same and the number of literals in C2 is the same of that of C1'\r\n            );\r\n        case 'MACRO_RESOLUTION':\r\n            return (\r\n                rule +\r\n                \"\\n\\n======== N-ary Resolution + Factoring + Reordering\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (C, pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined in RESOLUTION\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined in RESOLUTION\\n- let C_1' be equal, in its set representation, to C_1 (from P1),\\n- for each i > 1, let C_i' be equal, it its set representation, to C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C, which is equal, in its set representation, to C_n'\"\r\n            );\r\n        case 'MACRO_RESOLUTION_TRUST':\r\n            return (\r\n                rule +\r\n                \"\\n\\nAs MACRO_RESOLUTION but not checked\\n\\nMACRO_RESOLUTION definition:\\n======== N-ary Resolution + Factoring + Reordering\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (C, pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined in RESOLUTION\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined in RESOLUTION\\n- let C_1' be equal, in its set representation, to C_1 (from P1),\\n- for each i > 1, let C_i' be equal, it its set representation, to C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C, which is equal, in its set representation, to C_n'\"\r\n            );\r\n        default:\r\n            return rule;\r\n    }\r\n}\r\n\r\nfunction castProofNodeToTreeNode(node: NodeInterface): TreeNode {\r\n    const label = node.hiddenNodes?.length\r\n        ? // Pi node\r\n          `${node.id} :   ${node.conclusion}`\r\n        : node.dependencies.length\r\n        ? // Node with dependencies\r\n          `${node.id} :   ${node.conclusion}`\r\n        : //Normal node\r\n          `${node.id} : ${node.conclusion}`;\r\n\r\n    // Create the node tree\r\n    return {\r\n        id: node.id,\r\n        icon: 'graph',\r\n        label: label,\r\n        secondaryLabel: `${node.rule}`,\r\n        rule: node.rule,\r\n        args: node.args,\r\n        conclusion: node.conclusion,\r\n        parentId: node.parents[0],\r\n        descendants: node.descendants - 1,\r\n        nHided: node.hiddenNodes ? node.hiddenNodes.length : 0,\r\n        hiddenNodes: node.hiddenNodes ? node.hiddenNodes.map((n) => n.id) : [],\r\n        childNodes: [],\r\n        dependencies: node.dependencies,\r\n        parentsId: node.parents,\r\n        hasCaret: Boolean(node.descendants - 1),\r\n    };\r\n}\r\n\r\nfunction createTree(proof: NodeInterface[], id: number): TreeNode[] {\r\n    const rootNode = proof.find((o) => o.id === id);\r\n    const tree: TreeNode[] = [],\r\n        roots: TreeNode[] = [];\r\n\r\n    // Make sure found the root node\r\n    if (rootNode) {\r\n        const stack: number[] = [rootNode.id];\r\n        const childrenStack = [-1];\r\n        const insertedStack: number[] = [];\r\n\r\n        let currentNode: any;\r\n        tree.push(castProofNodeToTreeNode(rootNode));\r\n        insertedStack.push(rootNode.id);\r\n\r\n        //While stack isn't empty\r\n        while (stack.length) {\r\n            const lastNode = stack[stack.length - 1];\r\n            let lastChild = childrenStack[childrenStack.length - 1];\r\n            currentNode = proof.find((o) => o.id === lastNode);\r\n\r\n            // If still has children\r\n            if (lastChild < currentNode.children.length - 1) {\r\n                lastChild++;\r\n                stack.push(currentNode.children[lastChild]);\r\n                childrenStack.push(-1);\r\n                // Add the node to the tree\r\n                const nextNode: any = proof.find((o) => o.id === currentNode.children[lastChild]);\r\n\r\n                // Avoid duplicate nodes\r\n                if (insertedStack.indexOf(nextNode.id) === -1) {\r\n                    tree.push(castProofNodeToTreeNode(nextNode));\r\n                    insertedStack.push(nextNode.id);\r\n                }\r\n            }\r\n            // Hasn't children\r\n            else {\r\n                stack.pop();\r\n                childrenStack.pop();\r\n                childrenStack[childrenStack.length - 1]++;\r\n            }\r\n        }\r\n\r\n        // Make the id's list\r\n        const map: any = {};\r\n        let node: TreeNode, i: number;\r\n\r\n        // Map the { [node id]: list array id }\r\n        for (i = 0; i < tree.length; i++) {\r\n            map[tree[i].id] = i;\r\n        }\r\n\r\n        for (i = 0; i < tree.length; i += 1) {\r\n            node = tree[i];\r\n            // For all the parents\r\n            node.parentsId.forEach((parentId) => {\r\n                // If this parent was mapped or it's the root node\r\n                if (!isNaN(map[parentId]) || !i) {\r\n                    // If the parent is valid and exist in the list\r\n                    if (!isNaN(parentId) && tree[map[parentId]]) {\r\n                        tree[map[parentId]].childNodes.push(node);\r\n                    }\r\n                    // If root node was already inserted\r\n                    else if (!roots.length) {\r\n                        roots.push(node);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n    return roots;\r\n}\r\n\r\nconst VisualizerStage: React.FC = () => {\r\n    // Proof data\r\n    const letMap = useAppSelector(selectLetMap);\r\n    const proof = useAppSelector(selectOriginalProof);\r\n    const dot = useAppSelector(selectDot);\r\n    const fileID = useAppSelector(selectFileCount);\r\n    const style = useAppSelector(selectStyle);\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    // Data structures\r\n    const [proofTree, setProofTree] = useState<TreeNodeInfo[]>([]);\r\n    const [nodeInfo, setNodeInfo] = useState<NodeInfo>({\r\n        rule: '',\r\n        args: '',\r\n        conclusion: '',\r\n        nHided: 0,\r\n        nDescendants: 0,\r\n        hiddenNodes: [],\r\n        dependencies: [],\r\n    });\r\n    const [originalNodeInfo, setOriginalNodeInfo] = useState<NodeInfo>({\r\n        rule: '',\r\n        args: '',\r\n        conclusion: '',\r\n        nHided: 0,\r\n        nDescendants: 0,\r\n        hiddenNodes: [],\r\n        dependencies: [],\r\n    });\r\n    // Drawer\r\n    const [[ruleHelperIsOpen, argsHelperIsOpen, concHelperIsOpen], dispatchHelper] = useReducer(\r\n        (state: boolean[], action: { type: drawerHelpersKind; payload: boolean }): boolean[] => {\r\n            const { type, payload } = action;\r\n\r\n            // Act over all the positions\r\n            if (type === drawerHelpersKind.ALL) {\r\n                for (let i = 0; i < state.length; i++) {\r\n                    state[i] = payload;\r\n                }\r\n            }\r\n            // If wanna set a position\r\n            else if (payload) {\r\n                // Reset everything and set the wanted\r\n                for (let i = 0; i < state.length; i++) {\r\n                    state[i] = i === type ? payload : false;\r\n                }\r\n            }\r\n            // If wanna only reset a position\r\n            else state[type] = payload;\r\n\r\n            return [...state];\r\n        },\r\n        // Rule, args, conclusion\r\n        [false, false, false],\r\n    );\r\n    const [[expandAll, revertAll], dispatchLetExpansion] = useReducer(\r\n        (state: boolean[], action: { type: renderLetKind; payload: boolean }): boolean[] => {\r\n            const { type, payload } = action;\r\n\r\n            for (let i = 0; i < state.length; i++) {\r\n                state[i] = i === type ? payload : false;\r\n            }\r\n\r\n            return [...state];\r\n        },\r\n        // Expand, revert\r\n        [false, false],\r\n    );\r\n    const [drawerIsOpen, setDrawerIsOpen] = useState(false);\r\n    const [tree, setTree] = useState<TreeNodeInfo[]>([]);\r\n\r\n    // Make sure that a new tree is created only when a new dot is used\r\n    useEffect(() => setProofTree(createTree(proof, 0)), [dot]);\r\n\r\n    const openDrawer = (nodeInfo: NodeInfo, tree?: TreeNodeInfo[]) => {\r\n        setNodeInfo(nodeInfo);\r\n        setTree(tree ? tree : []);\r\n        setOriginalNodeInfo(nodeInfo);\r\n        setDrawerIsOpen(true);\r\n    };\r\n\r\n    const nodeInfoTable = (): JSX.Element => {\r\n        return (\r\n            <table\r\n                id=\"table-node-info\"\r\n                className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\r\n                style={{ width: '100%' }}\r\n            >\r\n                <thead>\r\n                    <tr>\r\n                        <th>Property</th>\r\n                        <th>Value</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr>\r\n                        <td>\r\n                            <strong>RULE </strong>\r\n                            <Icon\r\n                                id=\"icon\"\r\n                                icon=\"help\"\r\n                                onClick={() => {\r\n                                    dispatchHelper({ type: drawerHelpersKind.RULE, payload: !ruleHelperIsOpen });\r\n                                }}\r\n                            ></Icon>\r\n                        </td>\r\n                        <td>\r\n                            {nodeInfo.rule}\r\n                            <Collapse isOpen={ruleHelperIsOpen}>\r\n                                <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                    {ruleHelper(nodeInfo.rule)}\r\n                                </Pre>\r\n                            </Collapse>\r\n                        </td>\r\n                    </tr>\r\n\r\n                    {nodeInfo.args && (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>ARGS</strong>{' '}\r\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\r\n                                    <Icon\r\n                                        id=\"icon\"\r\n                                        icon=\"translate\"\r\n                                        onClick={() => {\r\n                                            dispatchHelper({\r\n                                                type: drawerHelpersKind.ARGS,\r\n                                                payload: !argsHelperIsOpen,\r\n                                            });\r\n                                        }}\r\n                                    ></Icon>\r\n                                ) : null}\r\n                            </td>\r\n                            <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                                {nodeInfo.args}\r\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\r\n                                    <Collapse isOpen={argsHelperIsOpen}>\r\n                                        <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\r\n                                            {nodeInfo.args}\r\n                                        </Pre>\r\n                                    </Collapse>\r\n                                ) : null}\r\n                            </td>\r\n                        </tr>\r\n                    )}\r\n\r\n                    <tr>\r\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                            <strong>CONCLUSION</strong>{' '}\r\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\r\n                                <>\r\n                                    <Icon\r\n                                        id=\"icon\"\r\n                                        icon=\"translate\"\r\n                                        onClick={() => {\r\n                                            dispatchHelper({\r\n                                                type: drawerHelpersKind.CONC,\r\n                                                payload: !concHelperIsOpen,\r\n                                            });\r\n                                            dispatchLetExpansion({\r\n                                                type: renderLetKind.EXPAND,\r\n                                                payload: true,\r\n                                            });\r\n                                        }}\r\n                                    ></Icon>\r\n                                    <Icon\r\n                                        id=\"icon\"\r\n                                        icon=\"undo\"\r\n                                        onClick={() => {\r\n                                            dispatchHelper({\r\n                                                type: drawerHelpersKind.CONC,\r\n                                                payload: false,\r\n                                            });\r\n                                            dispatchLetExpansion({\r\n                                                type: renderLetKind.REVERT,\r\n                                                payload: true,\r\n                                            });\r\n                                        }}\r\n                                    ></Icon>\r\n                                </>\r\n                            ) : null}\r\n                        </td>\r\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\r\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\r\n                                <LetRender\r\n                                    id={0}\r\n                                    toRender={nodeInfo.conclusion}\r\n                                    letMap={letMap}\r\n                                    shouldExpand={expandAll}\r\n                                    shouldRevert={revertAll}\r\n                                    dispatchExpansion={dispatchLetExpansion}\r\n                                />\r\n                            ) : null}\r\n                        </td>\r\n                    </tr>\r\n\r\n                    {nodeInfo.nDescendants ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>#DESCENDANTS</strong>\r\n                            </td>\r\n                            <td>{nodeInfo.nDescendants}</td>\r\n                        </tr>\r\n                    ) : null}\r\n\r\n                    {nodeInfo.nHided ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>#HIDDEN</strong>\r\n                            </td>\r\n                            <td>{`[${nodeInfo.hiddenNodes.map((node) => ' ' + node)} ]`}</td>\r\n                        </tr>\r\n                    ) : null}\r\n                    {nodeInfo.dependencies.length ? (\r\n                        <tr>\r\n                            <td>\r\n                                <strong>DEPENDENCIES</strong>\r\n                            </td>\r\n                            <td>{`${nodeInfo.dependencies.map(\r\n                                (dependency) => ` ${dependency.piId}: [${dependency.depsId.map((dep) => ' ' + dep)} ] `,\r\n                            )}`}</td>\r\n                        </tr>\r\n                    ) : null}\r\n                </tbody>\r\n            </table>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div onContextMenu={(e) => e.preventDefault()}>\r\n            {proof.length > 1 ? (\r\n                style === 'graph' ? (\r\n                    <Canvas key={fileID} openDrawer={openDrawer} createTree={createTree}></Canvas>\r\n                ) : (\r\n                    <VisualizerDirectoryStyle\r\n                        proofTree={proofTree}\r\n                        ruleHelper={ruleHelper}\r\n                        indent={() => ''}\r\n                        translate={() => ''}\r\n                    />\r\n                )\r\n            ) : null}\r\n            <Drawer\r\n                className={darkTheme ? 'bp3-dark' : ''}\r\n                autoFocus={true}\r\n                canEscapeKeyClose={true}\r\n                canOutsideClickClose={true}\r\n                enforceFocus={true}\r\n                hasBackdrop={false}\r\n                isOpen={drawerIsOpen}\r\n                position={Position.BOTTOM}\r\n                usePortal={true}\r\n                onClose={(e) => {\r\n                    e.preventDefault();\r\n                    setDrawerIsOpen(false);\r\n                    dispatchHelper({ type: drawerHelpersKind.ALL, payload: false });\r\n                }}\r\n                icon=\"info-sign\"\r\n                title=\"Node info\"\r\n            >\r\n                <div className={Classes.DRAWER_BODY}>\r\n                    <VisualizerTree\r\n                        darkTheme={darkTheme}\r\n                        content={tree}\r\n                        setNodeInfo={setNodeInfo}\r\n                        originalNodeInfo={originalNodeInfo}\r\n                    ></VisualizerTree>\r\n                    <div className={Classes.DIALOG_BODY}>{nodeInfoTable()}</div>\r\n                </div>\r\n            </Drawer>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VisualizerStage;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Button, Drawer, Classes, Position } from '@blueprintjs/core';\r\n\r\nimport Let from './let';\r\nimport '../../scss/Let.scss';\r\nimport { letDrawerProps } from '../../interfaces/interfaces';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\nimport { selectLetMap } from '../../store/features/proof/proofSlice';\r\n\r\nconst font =\r\n    '14px / 18px -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Open Sans\", \"Helvetica Neue\", Icons16, sans-serif';\r\n\r\nconst VisualizerLetDrawer: React.FC<letDrawerProps> = ({ drawerIsOpen, setDrawerIsOpen }: letDrawerProps) => {\r\n    const darkTheme = useAppSelector(selectTheme);\r\n    const letMap = useAppSelector(selectLetMap);\r\n    const widthRef = useRef(0);\r\n\r\n    const [letMapS, setLetMapS] = useState({ ...letMap });\r\n    const [resizeMode, setResizeMode] = useState(0);\r\n    const letsRef = useRef<{ [key: string]: Let }>({});\r\n\r\n    // ComponentDidMount\r\n    useEffect(() => {\r\n        // Handler to call on window resize and set the value column width\r\n        function handleResize() {\r\n            const width = widthRef.current;\r\n\r\n            // -22 from the fixed padding size\r\n            const newWidth = document.getElementsByClassName('letMap-value-column')[0].clientWidth - 24;\r\n            width === newWidth ? setResizeMode(1) : width > newWidth ? setResizeMode(0) : setResizeMode(2);\r\n\r\n            widthRef.current = newWidth;\r\n        }\r\n\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    const expandLet = (parent: string, key: string, letIdx: number) => {\r\n        const lets = letsRef.current;\r\n\r\n        const externalRef = lets[key];\r\n        lets[parent].isExpanded = true;\r\n        letMapS[parent] = lets[parent].expandPartialy(externalRef, letIdx);\r\n        setLetMapS({ ...letMapS });\r\n    };\r\n\r\n    const expandAll = (key: string) => {\r\n        const lets = letsRef.current;\r\n\r\n        lets[key].isExpanded = true;\r\n        letMapS[key] = lets[key].expandValue(true);\r\n        setLetMapS({ ...letMapS });\r\n    };\r\n\r\n    const revertLet = (key: string) => {\r\n        const lets = letsRef.current;\r\n\r\n        // Only when is expanded\r\n        if (lets[key].isExpanded) {\r\n            lets[key].isExpanded = false;\r\n            letMapS[key] = lets[key].shrinkValue();\r\n            setLetMapS({ ...letMapS });\r\n        }\r\n    };\r\n\r\n    const renderLet = (key: string): JSX.Element => {\r\n        const lets = letsRef.current;\r\n        const width = widthRef.current;\r\n\r\n        // Waits for the width to be updated and the DOM element to be updated\r\n        if (width) {\r\n            let currentLet = letMapS[key];\r\n\r\n            let indices: { [key: number]: string } = {};\r\n            // Finds all occurences of let in the currentLet\r\n            [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                if (match.index) indices[match.index] = match[0];\r\n            });\r\n\r\n            // If it's the first render (make sure that the lets obj is not calculated every time)\r\n            if (Object.keys(lets).length !== Object.keys(letMapS).length) {\r\n                lets[key] = new Let(key, currentLet, lets, indices);\r\n            }\r\n\r\n            // If doesn't fits, then indent\r\n            if (!lets[key].fitsTheWindow(width, font)) {\r\n                currentLet = lets[key].indent(width, true, font);\r\n                letMapS[key] = currentLet;\r\n\r\n                indices = {};\r\n                // Finds all occurences of let in the currentLet after indentation\r\n                [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                    if (match.index) indices[match.index] = match[0];\r\n                });\r\n            }\r\n            // If fits\r\n            else {\r\n                // Only in the momment the page size is growing and the line is broken\r\n                if (resizeMode >= 0 && lets[key].lines.length > 1) {\r\n                    // Reset the line\r\n                    lets[key].lines = [\r\n                        { value: lets[key].isExpanded ? lets[key].groupUp() : lets[key].value, indentLevel: 0 },\r\n                    ];\r\n                    lets[key].biggerID = 0;\r\n\r\n                    // Indent it again\r\n                    currentLet = lets[key].indent(width, false, font);\r\n                    letMapS[key] = currentLet;\r\n\r\n                    indices = {};\r\n                    // Finds all occurences of let in the currentLet after indentation\r\n                    [...currentLet.matchAll(/let\\d+/g)].forEach((match) => {\r\n                        if (match.index) indices[match.index] = match[0];\r\n                    });\r\n                }\r\n            }\r\n\r\n            const arr: (JSX.Element | string)[] = [];\r\n            let start = 0;\r\n            // Slice the currentLet into an array with strings and JSX elements\r\n            Object.keys(indices).forEach((index, i, self) => {\r\n                const idx = Number(index);\r\n                const thisLet = indices[idx];\r\n\r\n                // Add the elements to the arr\r\n                arr.push(currentLet.substring(start, idx));\r\n                arr.push(\r\n                    <a\r\n                        className={darkTheme ? 'let-literal-or' : 'let-literal'}\r\n                        onClick={() => {\r\n                            expandLet(key, thisLet, idx);\r\n                        }}\r\n                    >\r\n                        {thisLet}\r\n                    </a>,\r\n                );\r\n                // Defines a new start\r\n                start = idx + thisLet.length;\r\n\r\n                // If it's the last let\r\n                if (i === self.length - 1) {\r\n                    arr.push(currentLet.substring(start, currentLet.length));\r\n                }\r\n            });\r\n\r\n            // If there is a let in this current let\r\n            if (Object.keys(indices).length) {\r\n                return <span className=\"let-instance\">{arr}</span>;\r\n            } else {\r\n                return <span className=\"let-instance\">{currentLet}</span>;\r\n            }\r\n        }\r\n        return <></>;\r\n    };\r\n\r\n    return (\r\n        <Drawer\r\n            className={darkTheme ? 'bp3-dark' : ''}\r\n            style={{ maxHeight: '65%', width: '35%' }}\r\n            autoFocus={true}\r\n            canEscapeKeyClose={true}\r\n            canOutsideClickClose={false}\r\n            enforceFocus={true}\r\n            hasBackdrop={false}\r\n            isOpen={drawerIsOpen}\r\n            position={Position.RIGHT}\r\n            usePortal={false}\r\n            onClose={(e) => {\r\n                e.preventDefault();\r\n                setDrawerIsOpen(false);\r\n            }}\r\n            icon=\"translate\"\r\n            title=\"Let Map\"\r\n        >\r\n            <div className={Classes.DRAWER_BODY}>\r\n                <div className={Classes.DIALOG_BODY}>\r\n                    <table\r\n                        id=\"table-node-info\"\r\n                        className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\r\n                        style={{ width: '100%' }}\r\n                    >\r\n                        <thead>\r\n                            <tr>\r\n                                <th style={{ width: '100px' }}>Property</th>\r\n                                <th className=\"letMap-value-column\">Value</th>\r\n                                <th style={{ width: '250px' }}>Action</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {Object.keys(letMapS).map((key) => {\r\n                                return (\r\n                                    <tr key={key}>\r\n                                        <td>\r\n                                            <strong>{key}</strong>\r\n                                        </td>\r\n                                        <td style={{ width: '100%', whiteSpace: 'pre-wrap' }}>{renderLet(key)}</td>\r\n                                        <td style={{ width: '150px', height: '100%' }}>\r\n                                            <Button\r\n                                                onClick={() => expandAll(key)}\r\n                                                className=\"bp3-minimal\"\r\n                                                icon=\"translate\"\r\n                                                text=\"Expand\"\r\n                                            />\r\n                                            <Button\r\n                                                onClick={() => revertLet(key)}\r\n                                                className=\"bp3-minimal\"\r\n                                                icon=\"undo\"\r\n                                                text=\"Revert\"\r\n                                            />\r\n                                        </td>\r\n                                    </tr>\r\n                                );\r\n                            })}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </Drawer>\r\n    );\r\n};\r\n\r\nexport default VisualizerLetDrawer;\r\n","import React, { useEffect, useReducer, useState } from 'react';\r\n\r\nimport { Intent, Position, Toaster } from '@blueprintjs/core';\r\n\r\nimport VisualizerNavbar from '../VisualizerNavbar/VisualizerNavbar';\r\nimport VisualizerDialog from '../VisualizerDialog/VisualizerDialog';\r\nimport VisualizerStage from '../VisualizerStage/VisualizerStage';\r\nimport VisualizerLetDrawer from '../VisualizerLetDrawer/VisualizerLetDrawer';\r\n\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport { selectTheme } from '../../store/features/theme/themeSlice';\r\n\r\nconst App: React.FC = () => {\r\n    const [dialogIsOpen, setDialogIsOpen] = useState(true);\r\n    const [dialogContent, setDialogContent] = useState('upload-proof');\r\n    const [drawerIsOpen, setDrawerOpenState] = useReducer((isOpen) => !isOpen, false);\r\n    const darkTheme = useAppSelector(selectTheme);\r\n\r\n    // Toaster\r\n    let toaster: Toaster;\r\n    const refHandlers = {\r\n        toaster: (ref: Toaster) => (toaster = ref),\r\n    };\r\n\r\n    const addErrorToast = (err: string) => {\r\n        toaster.show({ icon: 'warning-sign', intent: Intent.DANGER, message: err });\r\n    };\r\n\r\n    useEffect(() => {\r\n        document.getElementsByClassName('bp3-overlay')[0]\r\n            ? (document.getElementsByClassName('bp3-overlay')[0].className = '')\r\n            : null;\r\n    }, [drawerIsOpen]);\r\n\r\n    return (\r\n        <div className={darkTheme ? ' bp3-dark' : ''}>\r\n            <Toaster position={Position.TOP} ref={refHandlers.toaster} />\r\n            <VisualizerNavbar\r\n                setDialogIsOpen={setDialogIsOpen}\r\n                setDialogContent={setDialogContent}\r\n                setDrawerIsOpen={setDrawerOpenState}\r\n                addErrorToast={addErrorToast}\r\n            ></VisualizerNavbar>\r\n            <VisualizerDialog\r\n                dialogIsOpen={dialogIsOpen}\r\n                setDialogIsOpen={setDialogIsOpen}\r\n                dialogContent={dialogContent}\r\n                setDialogContent={setDialogContent}\r\n                addErrorToast={addErrorToast}\r\n            ></VisualizerDialog>\r\n            <VisualizerStage></VisualizerStage>\r\n            {drawerIsOpen ? (\r\n                <VisualizerLetDrawer drawerIsOpen={drawerIsOpen} setDrawerIsOpen={setDrawerOpenState} />\r\n            ) : null}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default App;\r\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\r\nimport externalCmdReducer from './features/externalCmd/externalCmd';\r\nimport fileReducer from './features/file/fileSlice';\r\nimport proofReducer from './features/proof/proofSlice';\r\nimport themeReducer from './features/theme/themeSlice';\r\n\r\nexport const store = configureStore({\r\n    reducer: {\r\n        file: fileReducer,\r\n        proof: proofReducer,\r\n        theme: themeReducer,\r\n        externalCmd: externalCmdReducer,\r\n    },\r\n});\r\n\r\nexport type AppDispatch = typeof store.dispatch;\r\nexport type RootState = ReturnType<typeof store.getState>;\r\nexport type AppThunk<ReturnType = void> = ThunkAction<ReturnType, RootState, unknown, Action<string>>;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler): void => {\r\n    if (onPerfEntry && onPerfEntry instanceof Function) {\r\n        import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n            getCLS(onPerfEntry);\r\n            getFID(onPerfEntry);\r\n            getFCP(onPerfEntry);\r\n            getLCP(onPerfEntry);\r\n            getTTFB(onPerfEntry);\r\n        });\r\n    }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './components/App/App';\r\nimport { store } from './store/store';\r\nimport { Provider } from 'react-redux';\r\n\r\nimport './scss/index.scss';\r\n\r\nimport reportWebVitals from './ReactUtils/reportWebVitals';\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <Provider store={store}>\r\n            <App />\r\n        </Provider>\r\n    </React.StrictMode>,\r\n    document.getElementById('root'),\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}